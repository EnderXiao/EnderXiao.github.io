<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Ender</title>
  
  <subtitle>coding never stop</subtitle>
  <link href="http://enderxiao.top/atom.xml" rel="self"/>
  
  <link href="http://enderxiao.top/"/>
  <updated>2021-08-07T01:47:49.861Z</updated>
  <id>http://enderxiao.top/</id>
  
  <author>
    <name>EnderXiao</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MDA破晓</title>
    <link href="http://enderxiao.top/%E9%94%AE%E7%9B%98/%E5%AE%A2%E5%88%B6%E5%8C%96/mda%E7%A0%B4%E6%99%93/"/>
    <id>http://enderxiao.top/%E9%94%AE%E7%9B%98/%E5%AE%A2%E5%88%B6%E5%8C%96/mda%E7%A0%B4%E6%99%93/</id>
    <published>2021-08-07T01:16:09.000Z</published>
    <updated>2021-08-07T01:47:49.861Z</updated>
    
    <content type="html"><![CDATA[<p>等了一年的键帽他也来了</p><a id="more"></a><h2 id="写在开头"><a href="#写在开头" class="headerlink" title="写在开头"></a>写在开头</h2><p>很久之前，入了一款由MelGeek设计的木镶铜套件，当时就是想尝试以下木壳，但是搭配键帽成了一个很大的问题。</p><p>本来想搭配MG尤达，被它的个性吸引了，但是当时手头没啥钱，于是错过了。</p><p>MG微光和破晓也是不错的选择，但也错过了。</p><p>这次MelGeek复刻MDA版本的微光，且可以按配列购买，实属人性化啊，说什么也不能错过。</p><p><del>众所周知，没有人会记住按时发货的伞兵</del>，这款等了将近一年的键帽也终于到我手上了。</p><div class="gallery center" col='1'>              <p><img src="https://z3.ax1x.com/2021/08/07/fKSvrT.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/07/fKSvrT.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="MDA微光的包装"></p>            </div><h2 id="原来的样子"><a href="#原来的样子" class="headerlink" title="原来的样子"></a>原来的样子</h2><div class="gallery center" col='1'>              <p><img src="https://z3.ax1x.com/2021/08/07/fKSOx0.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/07/fKSOx0.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="原键盘"></p>            </div><p>本来使用的是由阿尔伯特外设设计的原厂高度的十样锦，当时急着用，于是没有购买JDA高度的。这套原厂高度的实属一般。</p><p>之后购入了MDA塑料，觉得MDA高度的键帽无论是高度还是手感都非常帮，键帽表面比较细腻，有种少女肌肤的感觉(/▽＼)</p><h2 id="上机"><a href="#上机" class="headerlink" title="上机"></a>上机</h2><p>这把键盘的内胆是我入坑第一把键盘的内胆，如今已是伊拉克呈色，黄铜定位板加耳朵橘v2+Z紫+怒猫cyberpunk轴+box Jade的混轴</p><p>满满的沧桑</p><div class="gallery center" col='1'>              <p><img src="https://z3.ax1x.com/2021/08/07/fKpSZF.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/07/fKpSZF.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="露轴"></p>            </div><p>装上破晓</p><div class="gallery center" col='1'>              <p><img src="https://z3.ax1x.com/2021/08/07/fKSxqU.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/07/fKSxqU.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="破晓上机"></p>            </div><p>换上MDA后原本套件存在的<kbd>BackSpace</kbd>键卡外壳的问题得到了一定的改善。由于MDA高度的键帽比我原来的键帽更厚实，因此声音也得到了一定的改善。</p><p>重点是，这个触感，awsl(❤´艸｀❤)</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;等了一年的键帽他也来了&lt;/p&gt;</summary>
    
    
    
    <category term="键盘" scheme="http://enderxiao.top/categories/%E9%94%AE%E7%9B%98/"/>
    
    <category term="客制化" scheme="http://enderxiao.top/categories/%E9%94%AE%E7%9B%98/%E5%AE%A2%E5%88%B6%E5%8C%96/"/>
    
    
    <category term="客制化" scheme="http://enderxiao.top/tags/%E5%AE%A2%E5%88%B6%E5%8C%96/"/>
    
    <category term="机械键盘" scheme="http://enderxiao.top/tags/%E6%9C%BA%E6%A2%B0%E9%94%AE%E7%9B%98/"/>
    
    <category term="键帽" scheme="http://enderxiao.top/tags/%E9%94%AE%E5%B8%BD/"/>
    
    <category term="MDA破晓" scheme="http://enderxiao.top/tags/MDA%E7%A0%B4%E6%99%93/"/>
    
  </entry>
  
  <entry>
    <title>python基础-调试与测试</title>
    <link href="http://enderxiao.top/Python/python%E5%9F%BA%E7%A1%80-%E8%B0%83%E8%AF%95%E4%B8%8E%E6%B5%8B%E8%AF%95/"/>
    <id>http://enderxiao.top/Python/python%E5%9F%BA%E7%A1%80-%E8%B0%83%E8%AF%95%E4%B8%8E%E6%B5%8B%E8%AF%95/</id>
    <published>2021-08-06T03:39:13.000Z</published>
    <updated>2021-08-06T10:18:51.872Z</updated>
    
    <content type="html"><![CDATA[<p>python学习笔记，调试与测试</p><a id="more"></a><h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><p>许多高级语言中都内置了一套<code>try...exceot...finally...</code>的错误处理机制，比如java中的<code>try...catch</code>，python中也包含一套用于错误处理的代码。</p><h3 id="try"><a href="#try" class="headerlink" title="try"></a>try</h3><p>和java中的一样，解释器会先执行<code>try</code>关键字中的代码，如果在某处出错，则会立即停止继续执行<code>try</code>中的代码段落，而转去执行对应<code>except</code>中的代码段，执行完后，将跳过<code>else</code>，如果有<code>finally</code>，则会执行<code>finally</code>中的代码。</p><p>如果没有发生错误。则解释器会执行完<code>try</code>、<code>else</code>和<code>finally</code>中的所有内容</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    print(<span class="string">&#x27;try...&#x27;</span>)</span><br><span class="line">    f = <span class="number">10</span>/<span class="built_in">int</span>(x)</span><br><span class="line">    print(<span class="string">&#x27;result:&#x27;</span>, r)</span><br><span class="line"><span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">    print(<span class="string">&#x27;ValueError:&#x27;</span>, e)</span><br><span class="line"><span class="keyword">except</span> ZeroDivisionError <span class="keyword">as</span> e:</span><br><span class="line">    print(<span class="string">&#x27;ZeroDivisionError:&#x27;</span>, e)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;no error!&#x27;</span>)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    print(<span class="string">&#x27;finally...&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;END&#x27;</span>)</span><br></pre></td></tr></table></figure><p>当<code>x</code>输入0时，语句<code>f = 10/int(x)</code>会出现除0错误，此时直接跳转到第7行继续执行，因此最终结果为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>...</span><br><span class="line">ZeroDivisionError: division by zero</span><br><span class="line"><span class="keyword">finally</span>...</span><br><span class="line">END</span><br></pre></td></tr></table></figure><p>当<code>x</code>输入a，或者其他不能转化为数字的字符时，<code>int(x)</code>就会出现参数错误，此时直接跳转到第5行执行，因此最终结果为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>...</span><br><span class="line">ValueError: invalid literal <span class="keyword">for</span> <span class="built_in">int</span>() <span class="keyword">with</span> base <span class="number">10</span>: x</span><br><span class="line"><span class="keyword">finally</span>...</span><br><span class="line">END</span><br></pre></td></tr></table></figure><p>但当我们输入正确值时，比如输入2，则不会发生异常，从而得到以下结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>...</span><br><span class="line">result: <span class="number">5</span></span><br><span class="line">no error!</span><br><span class="line"><span class="keyword">finally</span>...</span><br><span class="line">END</span><br></pre></td></tr></table></figure><p>与java一样，python中的异常也是类，并且有继承关系，所有异常均继承自<code>BaseException</code>，这一特性导致当我们用某一类型去捕获一个异常时，如果遇到该类型异常的子类异常，也会将其捕获：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    foo()</span><br><span class="line"><span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">    print(<span class="string">&#x27;ValueError&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> UnicodeError <span class="keyword">as</span> e:</span><br><span class="line">    print(<span class="string">&#x27;UnicodeError&#x27;</span>)</span><br></pre></td></tr></table></figure><p>由于<code>UnicodeError</code>是<code>ValueError</code>类型异常的子类异常，因此第5行之后的代码将永远无法出发，发生<code>UnicodeError</code>异常时，它将优先被写在前面且可以捕获该异常的第三行<code>except</code>捕获。</p><p>常见异常继承关系可参考python3官方文档：</p><div class="tag link"><a class="link-card" title="" href="python3异常继承关系"><div class="left"><img src="https://docs.python.org/3/library/exceptions.html#exception-hierarchy" class="lazyload placeholder" data-srcset="https://docs.python.org/3/library/exceptions.html#exception-hierarchy" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text"></p><p class="url">python3异常继承关系</p></div></a></div><details yellow><summary> 点击查看异常继承关系 </summary>              <div class='content'>              <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">BaseException</span><br><span class="line"> +-- SystemExit</span><br><span class="line"> +-- KeyboardInterrupt</span><br><span class="line"> +-- GeneratorExit</span><br><span class="line"> +-- Exception</span><br><span class="line">      +-- StopIteration</span><br><span class="line">      +-- StopAsyncIteration</span><br><span class="line">      +-- ArithmeticError</span><br><span class="line">      |    +-- FloatingPointError</span><br><span class="line">      |    +-- OverflowError</span><br><span class="line">      |    +-- ZeroDivisionError</span><br><span class="line">      +-- AssertionError</span><br><span class="line">      +-- AttributeError</span><br><span class="line">      +-- BufferError</span><br><span class="line">      +-- EOFError</span><br><span class="line">      +-- ImportError</span><br><span class="line">      |    +-- ModuleNotFoundError</span><br><span class="line">      +-- LookupError</span><br><span class="line">      |    +-- IndexError</span><br><span class="line">      |    +-- KeyError</span><br><span class="line">      +-- MemoryError</span><br><span class="line">      +-- NameError</span><br><span class="line">      |    +-- UnboundLocalError</span><br><span class="line">      +-- OSError</span><br><span class="line">      |    +-- BlockingIOError</span><br><span class="line">      |    +-- ChildProcessError</span><br><span class="line">      |    +-- ConnectionError</span><br><span class="line">      |    |    +-- BrokenPipeError</span><br><span class="line">      |    |    +-- ConnectionAbortedError</span><br><span class="line">      |    |    +-- ConnectionRefusedError</span><br><span class="line">      |    |    +-- ConnectionResetError</span><br><span class="line">      |    +-- FileExistsError</span><br><span class="line">      |    +-- FileNotFoundError</span><br><span class="line">      |    +-- InterruptedError</span><br><span class="line">      |    +-- IsADirectoryError</span><br><span class="line">      |    +-- NotADirectoryError</span><br><span class="line">      |    +-- PermissionError</span><br><span class="line">      |    +-- ProcessLookupError</span><br><span class="line">      |    +-- TimeoutError</span><br><span class="line">      +-- ReferenceError</span><br><span class="line">      +-- RuntimeError</span><br><span class="line">      |    +-- NotImplementedError</span><br><span class="line">      |    +-- RecursionError</span><br><span class="line">      +-- SyntaxError</span><br><span class="line">      |    +-- IndentationError</span><br><span class="line">      |         +-- TabError</span><br><span class="line">      +-- SystemError</span><br><span class="line">      +-- TypeError</span><br><span class="line">      +-- ValueError</span><br><span class="line">      |    +-- UnicodeError</span><br><span class="line">      |         +-- UnicodeDecodeError</span><br><span class="line">      |         +-- UnicodeEncodeError</span><br><span class="line">      |         +-- UnicodeTranslateError</span><br><span class="line">      +-- Warning</span><br><span class="line">           +-- DeprecationWarning</span><br><span class="line">           +-- PendingDeprecationWarning</span><br><span class="line">           +-- RuntimeWarning</span><br><span class="line">           +-- SyntaxWarning</span><br><span class="line">           +-- UserWarning</span><br><span class="line">           +-- FutureWarning</span><br><span class="line">           +-- ImportWarning</span><br><span class="line">           +-- UnicodeWarning</span><br><span class="line">           +-- BytesWarning</span><br><span class="line">           +-- ResourceWarning</span><br></pre></td></tr></table></figure>              </div>            </details><p>此外，和java一样，python中的异常处理机制也支持多层调用：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span> / <span class="built_in">int</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bar</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> foo(s) * <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        bar(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">&#x27;Error:&#x27;</span>, e)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        print(<span class="string">&#x27;finally...&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>foo()</code>函数如果发生异常，在<code>main</code>函数中就能被捕捉到，不需要每层到写<code>try...except</code></p><p>因此在查找错误的源头时，调用栈非常重要。</p><p>例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># err.py:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span> / <span class="built_in">int</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bar</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> foo(s) * <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    bar(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><p>执行，结果如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>python3 err.py</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;err.py&quot;</span>, line <span class="number">11</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    main()</span><br><span class="line">  File <span class="string">&quot;err.py&quot;</span>, line <span class="number">9</span>, <span class="keyword">in</span> main</span><br><span class="line">    bar(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">  File <span class="string">&quot;err.py&quot;</span>, line <span class="number">6</span>, <span class="keyword">in</span> bar</span><br><span class="line">    <span class="keyword">return</span> foo(s) * <span class="number">2</span></span><br><span class="line">  File <span class="string">&quot;err.py&quot;</span>, line <span class="number">3</span>, <span class="keyword">in</span> foo</span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span> / <span class="built_in">int</span>(s)</span><br><span class="line">ZeroDivisionError: division by zero</span><br></pre></td></tr></table></figure><p>出错并不可怕，可怕的是不知道哪里出错了。解读错误信息是定位错误的关键。我们从上往下可以看到整个错误的调用函数链：</p><p>错误信息第1行：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br></pre></td></tr></table></figure><p>告诉我们这是错误的跟踪信息。</p><p>第2~3行：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">File <span class="string">&quot;err.py&quot;</span>, line <span class="number">11</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  main()</span><br></pre></td></tr></table></figure><p>调用<code>main()</code>出错了，在代码文件<code>err.py</code>的第11行代码，但原因是第9行：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">File <span class="string">&quot;err.py&quot;</span>, line <span class="number">9</span>, <span class="keyword">in</span> main</span><br><span class="line">  bar(<span class="string">&#x27;0&#x27;</span>)</span><br></pre></td></tr></table></figure><p>调用<code>bar(&#39;0&#39;)</code>出错了，在代码文件<code>err.py</code>的第9行代码，但原因是第6行：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">File <span class="string">&quot;err.py&quot;</span>, line <span class="number">6</span>, <span class="keyword">in</span> bar</span><br><span class="line">  <span class="keyword">return</span> foo(s) * <span class="number">2</span></span><br></pre></td></tr></table></figure><p>原因是<code>return foo(s) * 2</code>这个语句出错了，但这还不是最终原因，继续往下看：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">File <span class="string">&quot;err.py&quot;</span>, line <span class="number">3</span>, <span class="keyword">in</span> foo</span><br><span class="line">  <span class="keyword">return</span> <span class="number">10</span> / <span class="built_in">int</span>(s)</span><br></pre></td></tr></table></figure><p>原因是<code>return 10 / int(s)</code>这个语句出错了，这是错误产生的源头，因为下面打印了：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZeroDivisionError: integer division <span class="keyword">or</span> modulo by zero</span><br></pre></td></tr></table></figure><p>根据错误类型<code>ZeroDivisionError</code>，我们判断，<code>int(s)</code>本身并没有出错，但是<code>int(s)</code>返回<code>0</code>，在计算<code>10 / 0</code>时出错，至此，找到错误源头。</p><div class="note danger"><p>出错的时候，一定要分析错误的调用栈信息，才能定位错误的位置。</p></div><h3 id="错误记录"><a href="#错误记录" class="headerlink" title="错误记录"></a>错误记录</h3><p>如果我们既想要记录错误，有希望代码能够继续允许，可以使用python为我们提供的<code>logging</code>库</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># err_logging.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span> / <span class="built_in">int</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bar</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> foo(s) * <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        bar(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        logging.exception(e)</span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line">print(<span class="string">&#x27;END&#x27;</span>)</span><br></pre></td></tr></table></figure><p>程序打印完异常信息后会继续执行，并正常退出：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>python3 err_logging.py</span><br><span class="line">ERROR:root:division by zero</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;err_logging.py&quot;</span>, line <span class="number">13</span>, <span class="keyword">in</span> main</span><br><span class="line">    bar(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">  File <span class="string">&quot;err_logging.py&quot;</span>, line <span class="number">9</span>, <span class="keyword">in</span> bar</span><br><span class="line">    <span class="keyword">return</span> foo(s) * <span class="number">2</span></span><br><span class="line">  File <span class="string">&quot;err_logging.py&quot;</span>, line <span class="number">6</span>, <span class="keyword">in</span> foo</span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span> / <span class="built_in">int</span>(s)</span><br><span class="line">ZeroDivisionError: division by zero</span><br><span class="line">END</span><br></pre></td></tr></table></figure><p>通过配置，<code>logging</code>还可以把错误记录到日志文件里，方便事后排查。</p><h3 id="抛出错误"><a href="#抛出错误" class="headerlink" title="抛出错误"></a>抛出错误</h3><p>既然错误时类，这就意味着我们可以定义自己的异常，并在适当的时候抛出：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># err_raise.py</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FooError</span>(<span class="params">ValueError</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>(<span class="params">s</span>):</span></span><br><span class="line">    n = <span class="built_in">int</span>(s)</span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> FooError(<span class="string">&#x27;invalid value: %s&#x27;</span> % s)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span> / n</span><br><span class="line"></span><br><span class="line">foo(<span class="string">&#x27;0&#x27;</span>)</span><br></pre></td></tr></table></figure><p>执行该文件得到结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>python3 err_raise.py </span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;err_throw.py&quot;</span>, line <span class="number">11</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    foo(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">  File <span class="string">&quot;err_throw.py&quot;</span>, line <span class="number">8</span>, <span class="keyword">in</span> foo</span><br><span class="line">    <span class="keyword">raise</span> FooError(<span class="string">&#x27;invalid value: %s&#x27;</span> % s)</span><br><span class="line">__main__.FooError: invalid value: <span class="number">0</span></span><br></pre></td></tr></table></figure><p>但除非必须，否则还是推荐使用python内置的错误类型。</p><p>此外，有时我们使代码高内聚松耦合，不会在出错的地方就地处理异常，而是将其抛出，让更高层级去处理，所以有时我们会这么写：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># err_reraise.py</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>(<span class="params">s</span>):</span></span><br><span class="line">    n = <span class="built_in">int</span>(s)</span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&#x27;invalid value: %s&#x27;</span> % s)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span> / n</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bar</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        foo(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">&#x27;ValueError!&#x27;</span>)</span><br><span class="line">        <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line">bar()</span><br></pre></td></tr></table></figure><p><code>raise</code>语句如果不带参数，就会把当前错误原样抛出。</p><p>在<code>except</code>中<code>raise</code>一个Error，还可以用来把一种类型的错误转化成另一种类型：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="number">10</span> / <span class="number">0</span></span><br><span class="line"><span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&#x27;input error!&#x27;</span>)</span><br></pre></td></tr></table></figure><p>注意不要将一个错误转换为好不相关的错误，比如<code>IOError</code>转换成<code>ValueError</code>。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;python学习笔记，调试与测试&lt;/p&gt;</summary>
    
    
    
    <category term="机器学习" scheme="http://enderxiao.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="计算机语言" scheme="http://enderxiao.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AF%AD%E8%A8%80/"/>
    
    <category term="研究生课程基础" scheme="http://enderxiao.top/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E8%AF%BE%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    <category term="Python" scheme="http://enderxiao.top/categories/Python/"/>
    
    
    <category term="机器学习" scheme="http://enderxiao.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="python" scheme="http://enderxiao.top/tags/python/"/>
    
    <category term="基础" scheme="http://enderxiao.top/tags/%E5%9F%BA%E7%A1%80/"/>
    
    <category term="异常处理" scheme="http://enderxiao.top/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/"/>
    
    <category term="调试" scheme="http://enderxiao.top/tags/%E8%B0%83%E8%AF%95/"/>
    
    <category term="测试" scheme="http://enderxiao.top/tags/%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>BBOX-60-CyberSpace Edition</title>
    <link href="http://enderxiao.top/%E9%94%AE%E7%9B%98/%E5%AE%A2%E5%88%B6%E5%8C%96/bbox-60-cyberspace-edition/"/>
    <id>http://enderxiao.top/%E9%94%AE%E7%9B%98/%E5%AE%A2%E5%88%B6%E5%8C%96/bbox-60-cyberspace-edition/</id>
    <published>2021-08-05T07:46:47.000Z</published>
    <updated>2021-08-05T23:40:27.010Z</updated>
    
    <content type="html"><![CDATA[<p>等了一年的外壳它终于发货了</p><a id="more"></a><h2 id="CyberSpace"><a href="#CyberSpace" class="headerlink" title="CyberSpace!"></a>CyberSpace!</h2><p>2020年8月1日，由Ulliam 与 buger.work联名设计，JTK生产的Box60 CyberSpace特别版开启团购。</p><div class="gallery center" col='1'>              <p><img src="https://z3.ax1x.com/2021/08/05/fecQFP.png" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fecQFP.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="Box60-CyberSpaceEdition01"><br><img src="https://z3.ax1x.com/2021/08/05/fec8SS.md.png" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fec8SS.md.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="Box60-CyberSpaceEdition02"><br><img src="https://z3.ax1x.com/2021/08/05/fecGQg.md.png" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fecGQg.md.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="Box60-CyberSpaceEdition03"></p>            </div><p>入坑以来，一直想要一款磨砂透明的外壳，无奈一次又一次错过，例如之前的富贵家的<code>Canoe PC</code>，<code>Think6.5 V2</code>等等一些列非常优秀的设计。之后一个偶然的机会看到这款紫透的壳子，突然就被戳中了，我自己是个非常喜欢紫色的人，所以看到这个款的瞬间就决定下单然而。。。</p><p>本来预计的发货时间是2021年2月，但到我手上已经是2021年的8月1号了。</p><p>实际上6月份左右同款造型的Box60-KONMOMO</p><div class="gallery center " col='1'>              <p><img src="https://z3.ax1x.com/2021/08/05/fec9d1.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fec9d1.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="Box60-KONMOMO"></p>            </div><p>已经到达了各位玩家的手上，但由于色差的问题，被各位玩家吐槽。于是我开始担心起我购买的版本了。如果不是因为这个，我可能都忘了我买了这个套件。</p><p>但是拿到实物之后我还是非常满意的，虽然颜色跟渲染图上多少有些出入吧，但是是我喜欢的颜色。</p><div class="gallery center " col='1'>              <p><img src="https://z3.ax1x.com/2021/08/05/fecVQe.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fecVQe.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="实物01"></p>            </div><p>紫色的饱和度实际上是比渲染图要高一些的。</p><p>既然是梦寐以求的PC键盘，那我怎么也得用上毕生所学，让他尽量完美。</p><h3 id="PCB"><a href="#PCB" class="headerlink" title="PCB"></a>PCB</h3><p>其实在这把键盘之前我组过一把由韩国TX keyboard工作室设计的eo87，这款套件是TOP结构，手感一致性较好，为了发挥它的优势，我当时买的是焊接的版本，但那其实是我第一次焊接。</p><p>然后悲剧发生了，S键位焊接了一颗无法触发的轴上去，在解焊的过程中由于接触焊枪的时间过长，导致焊盘脱落，然后就不敢再动了/(ㄒoㄒ)/~~</p><p>因此呢，这次为了保证不会出现上次的悲剧，还是选择了热插拔的PCB，哎嘿(╹ڡ╹ )</p><p>是一块由mokey设计生产的64PCB</p><div class="gallery center" col='1'>              <p><img src="https://z3.ax1x.com/2021/08/05/fecii6.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fecii6.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="Mokey-64PCB"></p>            </div><p>在透过深色的透明外壳观测时，白色PCB会比黑色PCB更加的显眼，能够更好地展现透壳的性感之处。</p><p>支持VIA改键，不用和以前的qmk方案一样等半天还要刷进去，插上就能改，着实方便</p><h3 id="定位板"><a href="#定位板" class="headerlink" title="定位板"></a>定位板</h3><p>其实早就想试试PC定位板了，之前用过铝定，Fr4定位板，和铜定位板，各有各的优势吧，铝定大概是我比较不喜欢的i(*￣;(￣ *)</p><p>PC定位板声音柔和，且没有金属定位板的震手感。B站大佬用PC定敲出的雨滴声真是太戳我了。</p><p>Box-60被说过很多次空腔音很大，看ZF里大佬的修改，以及实验，最终发现，应该是因为Box-60为了丰富趣味性，采用了拼装的设计，这确实让我在收到套件以后的组装过程中有一种装高达的错觉，但是也导致了内部比较多的空隙。这些大块的空隙可能是导致空腔音的原因。B站上也有使用树脂填满空隙优化声音的教程，但是谁让我懒呢(*￣3￣)╭</p><p>于是，盲目分析一波，敲击键盘时，声音首先会在定位板和PCB之间反射，接着才会传到pcb下以及两侧的空腔处，那么，在pcb和定位板之间增加垫片，也许能够解决大部分问题，真是大聪明(￣﹃￣)</p><p>但公模的PCB要找到很完美的垫子实属困难，为了支持多变的配列，量产的垫子不是空格处有缺口就是方向键有缺口。</p><p>如果定位板厚到能塞满这一区域的话，那也不用操心垫子的问题，于是，几番寻找下来，终于找到了这款狗蛋家的5mmPC定！</p><div class="gallery center" col='1'>              <p><img src="https://z3.ax1x.com/2021/08/05/fecneA.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fecneA.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="5mm着实挺扎实"></p>            </div><p>嗯~ o(*￣▽￣*)o这个冬瓜白<del>着实冬瓜</del>着实美丽</p><h3 id="轴体"><a href="#轴体" class="headerlink" title="轴体"></a>轴体</h3><p>这次用被吹爆的青龙轴，由燥极设计，佳达隆代工，一款无论是外观还是手感都非常棒的轴体，3元/颗也不算贵，其实最开始还是被颜值吸引的，毕竟紫色控哎嘿(╹ڡ╹ )</p><div class="gallery center" col='1'>              <p><img src="https://z3.ax1x.com/2021/08/05/fecCIx.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fecCIx.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="青龙轴01"></p><p><img src="https://z3.ax1x.com/2021/08/05/feckRO.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/feckRO.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="青龙轴02"></p>            </div><p>到手发现手感和声音着实不错，这款轴有两个版本，主要是润滑上的区别，一个是只润滑小脚和弹簧，一个是CAP润滑，本来是想买CAP润滑的版本但是到手发现自己买错了23333，就用着吧，主要是不知道CAP润滑是个啥东西，想尝尝鲜。</p><h3 id="卫星轴"><a href="#卫星轴" class="headerlink" title="卫星轴"></a>卫星轴</h3><p>下面有请耳朵选手登场！</p><div class="gallery center" col='1'>              <p><img src="https://z3.ax1x.com/2021/08/05/fecFJK.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fecFJK.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="耳朵卫星轴V3"></p>            </div><p>这次选择的是新的耳朵卫星轴v3，在v2的基础上重新开模，增加钢丝垫片，假轴垫片，卫星轴垫片做了假轴与外壳的分离，可玩性和手感又上了一个档次，好用是真的好用，贵也是真的贵/(ㄒoㄒ)/~~</p><h3 id="键帽"><a href="#键帽" class="headerlink" title="键帽"></a>键帽</h3><p>akko这几年疯狂出复刻，可谓皆大欢喜。键帽质量不错，价格便宜，配色还都是G*K的高热度配色，杀疯了。</p><p>这套就是akko出的霓虹键帽，懂得都懂</p><div class="gallery center" col='1'>              <p><img src="https://z3.ax1x.com/2021/08/05/fecAzD.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fecAzD.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="耳朵卫星轴V3"></p>            </div><p>虽说是大全套，但是其实支持的配列着实有限，特别是，它没有2U的<code>shift</code></p><p>另外，F和J两个盲打按键的弧度要比其他字母区更大，且没有常规按键替换。</p><h3 id="组装"><a href="#组装" class="headerlink" title="组装"></a>组装</h3><p>由于这次购买的是热插拔键帽，而且轴体都是已经润滑过的，节省了不少时间，本次组装最花时间的大概就是组装外壳和调教卫星轴了吧，新版的耳朵卫星轴垫子着实多，泰阳22058润滑钢丝，杜邦105+205调配由润滑假轴。</p><p>下面是组装过程：</p><div class="gallery center" col='1'>              <p><img src="https://z3.ax1x.com/2021/08/05/fecZsH.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fecZsH.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="组装01"><br><img src="https://z3.ax1x.com/2021/08/05/feceLd.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/feceLd.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="组装02"><br><img src="https://z3.ax1x.com/2021/08/05/fecKot.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fecKot.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="组装03"></p>            </div><h3 id="成品"><a href="#成品" class="headerlink" title="成品"></a>成品</h3><p>组好了当然要臭美一下O(∩_∩)O</p><p>定位板的均光效果也非常不错</p><div class="gallery center" col='1'>              <p><img src="https://z3.ax1x.com/2021/08/05/fecudI.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fecudI.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="成品01"><br><img src="https://z3.ax1x.com/2021/08/05/fec1W8.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/fec1W8.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="成品02"><br><img src="https://z3.ax1x.com/2021/08/05/feclJf.md.jpg" class="lazyload placeholder" data-srcset="https://z3.ax1x.com/2021/08/05/feclJf.md.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="成品03"></p>            </div><h3 id="打字音"><a href="#打字音" class="headerlink" title="打字音"></a>打字音</h3><p>这次打字音着实令人满意，有雨滴内味了(/ω＼*)……… (/ω•＼*)</p><div  style="position:relative; padding-bottom:75%; width:100%; height:0"><iframe src="//player.bilibili.com/player.html?aid=589621423&bvid=BV1Dq4y1D7WE&cid=382508158&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 100%; width: 100%;"> </iframe></div><p>至此本次组装结束，自己还是比较满意的hhh，期待下次！</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;等了一年的外壳它终于发货了&lt;/p&gt;</summary>
    
    
    
    <category term="键盘" scheme="http://enderxiao.top/categories/%E9%94%AE%E7%9B%98/"/>
    
    <category term="客制化" scheme="http://enderxiao.top/categories/%E9%94%AE%E7%9B%98/%E5%AE%A2%E5%88%B6%E5%8C%96/"/>
    
    
    <category term="客制化" scheme="http://enderxiao.top/tags/%E5%AE%A2%E5%88%B6%E5%8C%96/"/>
    
    <category term="BBOX60" scheme="http://enderxiao.top/tags/BBOX60/"/>
    
    <category term="机械键盘" scheme="http://enderxiao.top/tags/%E6%9C%BA%E6%A2%B0%E9%94%AE%E7%9B%98/"/>
    
  </entry>
  
  <entry>
    <title>python进阶—函数式编程</title>
    <link href="http://enderxiao.top/Python/python%E8%BF%9B%E9%98%B6%E2%80%94%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"/>
    <id>http://enderxiao.top/Python/python%E8%BF%9B%E9%98%B6%E2%80%94%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/</id>
    <published>2021-07-25T16:00:00.000Z</published>
    <updated>2021-08-05T23:38:12.332Z</updated>
    
    <content type="html"><![CDATA[<p>python学习笔记函数式编程部分</p><a id="more"></a><h2 id="函数式"><a href="#函数式" class="headerlink" title="函数式"></a>函数式</h2><div class="note quote"><p>函数式编程是一种抽象程度很高的编程范式，纯粹的函数式编程语言编写的函数是没有变量的，因此，任意一个函数，只要输入确定，输出就是确定的。这种纯函数我们称为没有副作用</p></div><p>为什么说纯函数只要输入确定，输出就能确定呢，因为允许变量的程序设计语言，由于函数内部的变量状态不确定，同样的输入可能得到不同的输出，因此这种函数是有副作用的。</p><p>函数式编程的一个特点：</p><div class="note info"><p>允许函数本身作为参数传入另一个函数，且还允许返回一个函数</p></div><p>需要注意的是，python允许使用变量，因此python不是纯函数式编程语言</p><h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><hr><p>python中函数名可以理解为指向函数体的变量，因此，可以将函数名赋值给变量，也可以对函数名重新赋值，例如：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; abs</span><br><span class="line">&lt;build<span class="operator">-in</span> <span class="function"><span class="keyword">function</span> <span class="title">abs</span>&gt;</span></span><br><span class="line">&gt;&gt;&gt; f = abs</span><br><span class="line">&gt;&gt;&gt; f</span><br><span class="line">&lt;build<span class="operator">-in</span> <span class="function"><span class="keyword">function</span> <span class="title">abs</span>&gt;</span></span><br><span class="line">&gt;&gt;&gt; abs = <span class="number">10</span></span><br><span class="line">&gt;&gt;&gt; abs</span><br><span class="line"><span class="number">10</span></span><br><span class="line">&gt;&gt;&gt; abs(<span class="literal">-10</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">TypeError: <span class="string">&#x27;int&#x27;</span> object is not callable</span><br></pre></td></tr></table></figure><p>可见将由于<code>abs = 10</code>这条语句，导致<code>abs(-10)</code>不再具有绝对值的功能，此时必须重启python交互环境，<code>abs</code>才能恢复原有指向。</p><p>由此引入高阶函数的概念：</p><div class="note quote"><p>可以接受另一个函数作为参数的函数称为高阶函数</p></div><p>一个简单的高阶函数如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">x, y, f</span>):</span></span><br><span class="line">    <span class="keyword">return</span> f(x) + f(y)</span><br><span class="line"></span><br><span class="line">print(add(-<span class="number">5</span>, <span class="number">6</span>, <span class="built_in">abs</span>))</span><br><span class="line"><span class="comment"># 输出 11</span></span><br></pre></td></tr></table></figure><h3 id="map-reduce"><a href="#map-reduce" class="headerlink" title="map/reduce"></a>map/reduce</h3><hr><h4 id="map"><a href="#map" class="headerlink" title="map"></a>map</h4><hr><div class="note quote"><p><code>map()</code>函数接收两个参数，一个是函数，一个是<code>Iterable</code>，<code>map</code>将传入的函数依次作用到序列的每个元素，并把结果作为新的<code>Iterator</code>返回。</p></div><p>例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x</span>):</span></span><br><span class="line"><span class="keyword">return</span> x*x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = <span class="built_in">map</span>(f,[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line">print(<span class="built_in">list</span>(r))</span><br><span class="line"><span class="comment"># [1, 4, 9, 16, 25, 36, 49, 64, 81]</span></span><br></pre></td></tr></table></figure><p>由于map函数将返回惰性加载的<code>Interator</code>，因此此处使用<code>list()</code>将其转化为list</p><p>虽然如上简单操作看起来并没有什么意义，但我们还能使用map完成如下有实际意义的操作：</p><p>利用<code>map()</code>函数，把用户输入的不规范的英文名字，变为首字母大写，其他小写的规范名字。输入：<code>[&#39;adam&#39;, &#39;LISA&#39;, &#39;barT&#39;]</code>，输出：<code>[&#39;Adam&#39;, &#39;Lisa&#39;, &#39;Bart&#39;]</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">normalize</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="keyword">return</span> name[:<span class="number">1</span>].upper() + name[<span class="number">1</span>:].lower()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">L1 = [<span class="string">&#x27;adam&#x27;</span>, <span class="string">&#x27;LISA&#x27;</span>, <span class="string">&#x27;barT&#x27;</span>]</span><br><span class="line">L2 = <span class="built_in">list</span>(<span class="built_in">map</span>(normalize, L1))</span><br><span class="line">print(L2)</span><br><span class="line"><span class="comment"># [&#x27;Adam&#x27;, &#x27;Lisa&#x27;, &#x27;Bart&#x27;]</span></span><br></pre></td></tr></table></figure><h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h4><hr><div class="note quote"><p><code>reduce</code>把一个函数作用在一个序列`[x1</p></div><p>效果类似：</p><div class="note info"><p>reduce(f</p></div><p>使用reduce弄够完成如下事件：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">prod</span>(<span class="params">L</span>):</span></span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x,y: x * y,L)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;3 * 5 * 7 * 9 =&#x27;</span>, prod([<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]))</span><br><span class="line"><span class="comment"># 3 * 5 * 7 * 9 = 945</span></span><br></pre></td></tr></table></figure><p>使用map与reduce的组合，可以完成如下复杂的操作：</p><p>利用<code>map</code>和<code>reduce</code>编写一个<code>str2float</code>函数，把字符串<code>&#39;123.456&#39;</code>转换成浮点数<code>123.456</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2float</span>(<span class="params">s</span>):</span></span><br><span class="line">a,b = s.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x,y: x*<span class="number">10</span>+y, <span class="built_in">map</span>(<span class="built_in">int</span>,a)) + reduce(<span class="keyword">lambda</span> x,y: x * <span class="number">0.1</span> + y ,<span class="built_in">map</span>(<span class="built_in">int</span>,b[::-<span class="number">1</span>])) * <span class="number">0.1</span></span><br><span class="line">    </span><br><span class="line">print(<span class="string">&#x27;str2float(\&#x27;123.456\&#x27;) =&#x27;</span>, str2float(<span class="string">&#x27;123.456&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h3><hr><p><code>filter</code>机制与<code>map</code>有些相似，都是将将传入的函数作用在传入可便利对象中的每个元素上，区别在于，<code>fliter</code>是根据再用在该元素上的函数返回值是<code>true</code>还是<code>false</code>，从而决定该函数是否保留，最后返回所有被保留的元素组成的<code>list</code></p><p>例如一个筛出奇数的选择器：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_odd</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> n % <span class="number">2</span> == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">list</span>(<span class="built_in">filter</span>(is_odd, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">15</span>]))</span><br><span class="line"><span class="comment"># 结果: [1, 5, 9, 15]</span></span><br></pre></td></tr></table></figure><p><code>filter</code>与<code>map</code>一样，但会的是一个惰性加载的<code>Iterator</code>，需要使用<code>list()</code></p><h4 id="filter应用"><a href="#filter应用" class="headerlink" title="filter应用"></a>filter应用</h4><hr><p>接下来我们利用<code>Iterator</code>、<code>filter</code>实现<a href="https://enderxiao.top/ACM/%E6%95%B0%E8%AE%BA%E5%88%9D%E6%AD%A5/%E6%95%B0%E8%AE%BA%E5%88%9D%E6%AD%A5-%E7%B4%A0%E6%95%B0%E7%AD%9B%E6%B3%95/">埃氏筛法</a>：</p><p>首先对该问题进行分解：</p><ol><li>除了2以外的偶数都是和数，因此我们只需要考虑奇数，为此，我们需要先创建一个能够不断产生奇数的<code>Iterator</code></li><li>创建一个用来筛选的函数</li><li>接下来我们需要再创建一个函数，利用<code>filter</code>筛去1中的一些奇和数。</li><li>最后打印</li></ol><h5 id="产生奇数"><a href="#产生奇数" class="headerlink" title="产生奇数"></a>产生奇数</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_odd_iterator</span>():</span></span><br><span class="line">    n = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n += <span class="number">2</span></span><br><span class="line">        <span class="keyword">yield</span> n</span><br></pre></td></tr></table></figure><p>构造一个能不断产生奇数的<code>Iterator</code></p><h5 id="筛选函数"><a href="#筛选函数" class="headerlink" title="筛选函数"></a>筛选函数</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">primes_filter</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">lambda</span> x: x % n &gt; <span class="number">0</span></span><br></pre></td></tr></table></figure><p>使用n筛去n的倍数，由于<code>filter</code>的第一个参数需要接受一个函数，我们可以再此处返回一个<code>lambda</code>函数，使这个函数既可以接受参数又可以作为<code>filter</code>的第一个参数</p><h5 id="素数生成器"><a href="#素数生成器" class="headerlink" title="素数生成器"></a>素数生成器</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_odd_iterator</span>():</span></span><br><span class="line">    n = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n += <span class="number">2</span></span><br><span class="line">        <span class="keyword">yield</span> n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">primes_filter</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">lambda</span> x: x % n &gt; <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">primes</span>():</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">    odd = _odd_iterator()  <span class="comment"># 初始化序列</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n = <span class="built_in">next</span>(odd)  <span class="comment"># 从奇数列中取d</span></span><br><span class="line">        <span class="keyword">yield</span> n</span><br><span class="line">        odd = <span class="built_in">filter</span>(primes_filter(n), odd)  <span class="comment"># 构造新序列</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 再写个生成器来取前max个素数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_prime</span>(<span class="params"><span class="built_in">max</span></span>):</span></span><br><span class="line">    p = primes()</span><br><span class="line">    n = <span class="built_in">next</span>(p)</span><br><span class="line">    <span class="keyword">while</span> n &lt;= <span class="built_in">max</span>:</span><br><span class="line">        <span class="keyword">yield</span> n</span><br><span class="line">        n = <span class="built_in">next</span>(p)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取出小于100的全部素数</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> print_prime(<span class="number">100</span>):</span><br><span class="line">    print(n)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="sorted"><a href="#sorted" class="headerlink" title="sorted"></a>sorted</h3><hr><p>类似C++中的<code>sort</code>函数，包含三个参数：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sorted</span>(<span class="built_in">list</span>,key,reverse)</span><br></pre></td></tr></table></figure><ol><li>其中list表示需要排序的序列</li><li>key代表排序过程中作用在list中元素上的函数</li><li>reverse表示从大到小还是从小到大</li></ol><p>比如按绝对值大小排序：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; sorted([<span class="number">36</span>, <span class="number">5</span>, -<span class="number">12</span>, <span class="number">9</span>, -<span class="number">21</span>], key=abs)</span><br><span class="line">[<span class="number">5</span>, <span class="number">9</span>, -<span class="number">12</span>, -<span class="number">21</span>, <span class="number">36</span>]</span><br></pre></td></tr></table></figure><p>上述操作是先对list中的每个元素做了abs操作，再按abs操作后的值排序，再将原本的值放入相应位置。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">keys排序结果 &#x3D;&gt; [5, 9,  12,  21, 36]</span><br><span class="line">                |  |    |    |   |</span><br><span class="line">最终结果     &#x3D;&gt; [5, 9, -12, -21, 36]</span><br></pre></td></tr></table></figure><h3 id="返回函数"><a href="#返回函数" class="headerlink" title="返回函数"></a>返回函数</h3><hr><p>python中允许将另一个函数作为某一函数的返回值，被返回的函数将不会立即进行运算，例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lazy_sum</span>(<span class="params">*args</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sum</span>():</span></span><br><span class="line">        ax = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> args:</span><br><span class="line">            ax = ax + n</span><br><span class="line">        <span class="keyword">return</span> ax</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line"></span><br><span class="line">f = lazy_sum(<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>)</span><br></pre></td></tr></table></figure><p>此时分别调用<code>f</code>与<code>f()</code>：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; f</span><br><span class="line">&lt;<span class="function"><span class="keyword">function</span> <span class="title">lazy_sum</span>.&lt;<span class="title">locals</span>&gt;.<span class="title">sum</span> <span class="title">at</span> <span class="title">0x101c6ed90</span>&gt;</span></span><br><span class="line">&gt;&gt;&gt; f()</span><br><span class="line"><span class="number">25</span></span><br></pre></td></tr></table></figure><p>此处内部函数<code>sum</code>可以引用外部函数<code>lazy_sum</code>中的参数和局部变量，当<code>sum</code>被<code>lazy_sum</code>返回时，相关参数和变量都保存在返回的函数（sum）中，这种程序结构被成为闭包</p><p>需要注意的是<code>lazy_sum</code>每次都会返回一个新的函数，即：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; f1 = lazy_sum(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>)</span><br><span class="line">&gt;&gt;&gt; f2 = lazy_sum(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>)</span><br><span class="line">&gt;&gt;&gt; f1==f2</span><br><span class="line">False</span><br></pre></td></tr></table></figure><p><code>f1()</code>和<code>f2()</code>的调用结果互不影响。</p><h4 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h4><hr><p>由闭包的定义，我们来看如下的一个操作：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span>():</span></span><br><span class="line">    fs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">4</span>):</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">f</span>():</span></span><br><span class="line">            <span class="keyword">return</span> i*i</span><br><span class="line">        fs.append(f)</span><br><span class="line">    <span class="keyword">return</span> fs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f1,f2,f3 = count()</span><br></pre></td></tr></table></figure><p>此时乍一看<code>f1()</code>应该返回1，<code>f2()</code>返回4，<code>f3()</code>返回9</p><p>但是实际上结果如下：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; f1, f2, f3 = count()</span><br><span class="line">&gt;&gt;&gt; f1()</span><br><span class="line"><span class="number">9</span></span><br><span class="line">&gt;&gt;&gt; f2()</span><br><span class="line"><span class="number">9</span></span><br><span class="line">&gt;&gt;&gt; f3()</span><br><span class="line"><span class="number">9</span></span><br></pre></td></tr></table></figure><p>原因在于，返回函数将会把函数内部的变量封装，而python中的变量均为引用变量，即存储数据的地址，而变量<code>i</code>的值一直在变化，等到返回第个函数时，<code>i</code>中存储的值已变为3，此时无论调用哪个返回函数，其中<code>i</code>存储的值均为3</p><p>因此返回闭包时，有如下注意事项：</p><div class="note danger"><p>返回函数不要引用任何循环变量，或者后续会发生变化的变量。</p></div><p>但如上函数并不是没有解决的办法，只需要使用参数来保存循环值即可：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">j</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">g</span>():</span></span><br><span class="line">            <span class="keyword">return</span> j*j</span><br><span class="line">        <span class="keyword">return</span> g</span><br><span class="line">    fs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">4</span>):</span><br><span class="line">        fs.append(f(i))</span><br><span class="line"><span class="comment"># 此处f()不是闭包，因此在调用时立即被执行</span></span><br><span class="line">    <span class="keyword">return</span> fs</span><br></pre></td></tr></table></figure><p>使用闭包构造一个计数器：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createCounter</span>():</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span>():</span></span><br><span class="line">        <span class="keyword">nonlocal</span> i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line">    <span class="keyword">return</span> counter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">counterA = createCounter()</span><br><span class="line">print(counterA(), counterA(), counterA(), counterA(), counterA())</span><br><span class="line"><span class="comment"># 1 2 3 4 5</span></span><br></pre></td></tr></table></figure><h3 id="番外——变量作用域"><a href="#番外——变量作用域" class="headerlink" title="番外——变量作用域"></a>番外——变量作用域</h3><hr><p>python中的变量作用域大致与C++相同，但python为动态语言，定义时无需给出变量的类型，导致定义语法与引用语法相同，因此，python中加入了两个指定变量的关键字<code>global</code>和<code>nonlocal</code></p><p>其中：</p><ul><li><em>global关键字用来在函数或其他局部作用域中使用全局变量。</em></li><li><em>nonlocal声明的变量不是局部变量,也不是全局变量,而是外部嵌套函数内的变量。</em></li></ul><p>如，当我们需要在函数中使用全局变量时：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">global_test</span>():</span></span><br><span class="line">    <span class="keyword">global</span> count</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    print(count)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">global_test()  <span class="comment"># 1</span></span><br></pre></td></tr></table></figure><p>当我们需要在内部函数中使用外部函数的变量时：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nonlocal_test</span>():</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test2</span>():</span></span><br><span class="line">        <span class="keyword">nonlocal</span> count</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">    <span class="keyword">return</span> test2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">val = nonlocal_test()</span><br><span class="line">print(val())</span><br><span class="line">print(val())</span><br><span class="line">print(val())</span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"><span class="comment"># 3</span></span><br></pre></td></tr></table></figure><h3 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h3><hr><p>在函数式变成时，我们经常需要传入函数或是返回函数，这样大量的使用函数将导致命名成为一个非常麻烦的问题，因此python为我们提供了一种匿名函数的机制，省去了为函数命名的麻烦：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lambda</span> x: x*x</span><br></pre></td></tr></table></figure><p>上面这段函数就相当于：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> x * x</span><br></pre></td></tr></table></figure><p>匿名函数的基本格式为：</p><div class="note info"><p>lambda argument_list : expression</p></div><p>其中<code>argument_list</code>是参数列表，具有如下特性：</p><ol><li>参数需要在argument_list中有定义</li><li>表达式只能是单行</li></ol><p>可以使用如下种种形式：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">None</span><br><span class="line">a+b</span><br><span class="line">sum(a)</span><br><span class="line">1 if a &gt;10 else 0</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>而<code>expression</code>只允许使用一个表达式，且该表达式的值即时该函数的返回值。</p><p>lambda函数既可以作为变量赋值给一个变量，也可以作为返回值：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; f = lambda x: x * x</span><br><span class="line">&gt;&gt;&gt; f</span><br><span class="line">&lt;<span class="function"><span class="keyword">function</span> &lt;<span class="title">lambda</span>&gt; <span class="title">at</span> <span class="title">0x101c6ef28</span>&gt;</span></span><br><span class="line">&gt;&gt;&gt; f(<span class="number">5</span>)</span><br><span class="line"><span class="number">25</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">lambda</span>: x * x + y * y</span><br></pre></td></tr></table></figure><p>关于lambda函数的使用一直存在争议，有些人认为使用lambda函数能使代码更加的pythonic，而有些人认为只能使用一条语句的lambda函数有时反而会降低代码的可读性。</p><h3 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h3><hr><p>首先要明确python中函数作为对象，也具有一些属性，比如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">now</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;2021-7-26&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = now</span><br><span class="line">print(f.__name__)</span><br><span class="line"><span class="comment"># now</span></span><br></pre></td></tr></table></figure><p>此时，如果我们希望丰富now的功能，但又不希望修改now的定义，我们该怎么办呢？学习过<code>java注解</code>和<code>AOP</code>就知道，这就是AOP的编程思维。</p><p>在java中这样的操作并不难，通过为函数添加注解，再为该注解编写一些逻辑就能首先。而python中提供了一种使用函数实现AOP的方式：装饰器(Decorator)</p><p>本质上，<code>decorator</code>是一个<code>高阶函数</code>。如果我们想要定义一个能打印日志的decorate，可以通过如下方式：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span>(<span class="params">func</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kw</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;call %s():&#x27;</span> % func.__name__)</span><br><span class="line">        <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure><p>然后只需要使用python提供的<code>@语法糖</code>，把decorate置于函数的定义处：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@log</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">now</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;2021-7-26&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">now()</span><br><span class="line"><span class="comment"># call now():</span></span><br><span class="line"><span class="comment"># 2021-7-26</span></span><br></pre></td></tr></table></figure><p>该语法糖相当于执行了：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">now = log(now)</span><br></pre></td></tr></table></figure><p>还能定义需要参数的<code>decorate</code>，实现方式是再如上双重函数嵌套的基础上再增加一层用来接受参数：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span>(<span class="params">text</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decorator</span>(<span class="params">func</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kw</span>):</span></span><br><span class="line">            print(<span class="string">&#x27;%s %s():&#x27;</span> % (text, func.__name__))</span><br><span class="line">            <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> decorator</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@log(<span class="params"><span class="string">&#x27;execute&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">now</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;2021-7-26&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">now()</span><br><span class="line"><span class="comment"># execute now():</span></span><br><span class="line"><span class="comment"># 2021-7-26</span></span><br></pre></td></tr></table></figure><p>该语法糖相当于执行了：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">now = log(<span class="string">&#x27;execute&#x27;</span>)(now)</span><br></pre></td></tr></table></figure><p>其中<code>log(‘execute’)</code>返回<code>decorator</code>，接着将<code>decorator(now)</code>赋值给<code>now</code></p><p>但由于为<code>now</code>重新赋值，单纯的该过程将导致如下问题：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>now.__name__</span><br><span class="line"><span class="string">&#x27;wrapper&#x27;</span></span><br></pre></td></tr></table></figure><p>我们发现<code>now</code>中的值变了，导致<code>now</code>的<code>__name__</code>属性变了，因此我们需要把原始函数的<code>__name__</code>等属性赋值到<code>wrapper()</code>函数中去，否则，有些依赖函数签名的代码执行会出错。</p><p>Python的<code>functools</code>模块中也为我们提供了一个用于做这些事情的<code>decorator</code> : <code>functools.wraps</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">    @functools.wraps(<span class="params">func</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kw</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;call %s():&#x27;</span> % func.__name__)</span><br><span class="line">        <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure><p>对于有参数的<code>decorator</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span>(<span class="params">text</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decorator</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">        @functools.wraps(<span class="params">func</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kw</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;call %s():&#x27;</span> % func.__name__)</span><br><span class="line">        <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> decorator</span><br></pre></td></tr></table></figure><h3 id="偏函数"><a href="#偏函数" class="headerlink" title="偏函数"></a>偏函数</h3><hr><p>Python的<code>functools</code>模块提供了很多有用的功能，其中一个就是偏函数（Partial function）</p><p>可以通过偏函数来固定一个函数中的某个参数值，并返回一个新函数，但新函数仍然允许对固定的参数传入其他值。例如<code>int</code>函数：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int2 = functools.partial(<span class="built_in">int</span>, base = <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>(<span class="string">&#x27;12345&#x27;</span>)  <span class="comment"># 12345</span></span><br><span class="line"><span class="built_in">int</span>(<span class="string">&#x27;12345&#x27;</span>, <span class="number">8</span>)  <span class="comment"># 5349</span></span><br><span class="line"><span class="built_in">int</span>(<span class="string">&#x27;12345&#x27;</span>, <span class="number">16</span>)  <span class="comment"># 74565</span></span><br><span class="line">int2(<span class="string">&#x27;1000000&#x27;</span>)  <span class="comment"># 64</span></span><br><span class="line">int2(<span class="string">&#x27;1000000&#x27;</span>, base=<span class="number">10</span>)  <span class="comment"># 1000000</span></span><br></pre></td></tr></table></figure><p>创建偏函数时，实际上可以接收函数对象、<code>*args</code>和<code>**kw</code>这3个参数，当传入：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int2 = functools.partial(<span class="built_in">int</span>, base=<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>实际上固定了<code>int()</code>函数的<code>关键字参数base</code>，也就是：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kw = &#123; <span class="string">&#x27;base&#x27;</span>: <span class="number">2</span> &#125;</span><br><span class="line"><span class="built_in">int</span>(<span class="string">&#x27;10010&#x27;</span>, **kw)</span><br></pre></td></tr></table></figure><p>再看另一个例子：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">max2 = functools.partial(<span class="built_in">max</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">max2(<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>)  <span class="comment"># 10</span></span><br></pre></td></tr></table></figure><p>相当于：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">args = (<span class="number">10</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>)</span><br><span class="line"><span class="built_in">max</span>(*args)</span><br></pre></td></tr></table></figure><p>结合<a href="https://enderxiao.top/Python/python%E5%9F%BA%E7%A1%80/">python入门</a>中函数章节提到的，任何函数都能通过：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func(*args, **kw)</span><br></pre></td></tr></table></figure><p>来调用，我们可以大胆猜测一下偏函数的参数调用规则：</p><ol><li>偏函数先将默认值中的<code>位置参数</code>和调用时传入的<code>位置参数</code>组合为一个<code>*args</code>，且默认位置参数在前。</li><li>再将默认<code>关键字参数</code>和调用时传入的<code>关键字参数</code>组合为一个<code>**kw</code>，同名关键字将用传入值覆盖默认值。</li><li>最后通过<code>func(*args, **kw)</code>去调用</li></ol><p>通过如下例子可以验证：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">*args, **kw</span>):</span></span><br><span class="line">    print(args)</span><br><span class="line">    print(kw)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f1 = functools.partial(f, <span class="number">1</span>, <span class="number">2</span>, a = <span class="number">1</span>, b = <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f1(<span class="number">3</span>, <span class="number">4</span>, c = <span class="number">3</span>, d = <span class="number">4</span>)</span><br><span class="line"><span class="comment"># (1,2,3,4)</span></span><br><span class="line"><span class="comment"># &#123;&#x27;a&#x27;:1, &#x27;b&#x27;:2, &#x27;c&#x27;:3, &#x27;d&#x27;:4&#125;</span></span><br><span class="line"></span><br><span class="line">f1(a = <span class="number">2</span>, b = <span class="number">3</span>)</span><br><span class="line"><span class="comment"># (1,2)</span></span><br><span class="line"><span class="comment"># &#123;&#x27;a&#x27;:2, &#x27;b&#x27;: 3&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;python学习笔记函数式编程部分&lt;/p&gt;</summary>
    
    
    
    <category term="机器学习" scheme="http://enderxiao.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="计算机语言" scheme="http://enderxiao.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AF%AD%E8%A8%80/"/>
    
    <category term="研究生课程基础" scheme="http://enderxiao.top/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E8%AF%BE%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    <category term="Python" scheme="http://enderxiao.top/categories/Python/"/>
    
    
    <category term="机器学习" scheme="http://enderxiao.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="python" scheme="http://enderxiao.top/tags/python/"/>
    
    <category term="函数式编程" scheme="http://enderxiao.top/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"/>
    
    <category term="进阶" scheme="http://enderxiao.top/tags/%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title>python进阶-OOP</title>
    <link href="http://enderxiao.top/Python/python%E8%BF%9B%E9%98%B6-oop/"/>
    <id>http://enderxiao.top/Python/python%E8%BF%9B%E9%98%B6-oop/</id>
    <published>2021-07-25T16:00:00.000Z</published>
    <updated>2021-08-05T23:37:48.424Z</updated>
    
    <content type="html"><![CDATA[<p>python学习笔记，面对对象部分</p><a id="more"></a><h2 id="OOP"><a href="#OOP" class="headerlink" title="OOP"></a>OOP</h2><p>作为长期使用C++，java进行开发的程序员老说，OOP可以说是一种比较情切的程序设计思想了，所谓万物皆对象。</p><p>在python，几乎所有数据类型都可视为对象，甚至函数，python同样支持自定义对象。</p><h3 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h3><hr><p>在了解python中实现OOP之前，先来描述一下模块的概念，如下是一个自定义模块的样子：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27; a test module &#x27;</span></span><br><span class="line"></span><br><span class="line">__author__ = <span class="string">&#x27;Ender&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 以上是模块的文档规范</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span>():</span></span><br><span class="line">    args = sys.argv</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(args)==<span class="number">1</span>:</span><br><span class="line">        print(<span class="string">&#x27;Hello, world!&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">len</span>(args)==<span class="number">2</span>:</span><br><span class="line">        print(<span class="string">&#x27;Hello, %s!&#x27;</span> % args[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&#x27;Too many arguments!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test()</span><br></pre></td></tr></table></figure><p>第10行中，在导入<code>sys</code>模块后，变量<code>sys</code>就指向了该模块，此后便可通过该变量访问这个模块中的功能。</p><p>例如第13行的<code>argv</code>变量，就是该模块中用于存储命令行中参数的<code>list</code>，<code>argv</code>中至少包含一个元素，即<code>.py</code>文件的名称。</p><p>例如使用如下命令调用时：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 hello.py Ender</span><br></pre></td></tr></table></figure><p><code>argv</code>中的参数就是：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&#x27;hello.py&#x27;</span>, <span class="string">&#x27;Michael&#x27;</span>]</span><br></pre></td></tr></table></figure><p>当我们在命令行运行<code>hello</code>模块文件时，python解释器把一个特殊的变量<code>__name__</code>置为<code>__main__</code>，而如果在其他地方导入该<code>hello</code>模块时，<code>if</code>判断将失败。因此，这种<code>if</code>测试可以让一个模块通过命令行运行时执行一些额外的代码，最常见的用途就是运行测试。</p><p>例如使用命令行运行<code>hello.py</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; python3 hello.py</span><br><span class="line">Hello, world!</span><br><span class="line">&gt;&gt;&gt; python hello.py Ender</span><br><span class="line">Hello, Ender!</span><br></pre></td></tr></table></figure><p>而导入<code>hello</code>模块时，不会打印任何东西，原因是没有调用<code>test</code>函数：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; python</span><br><span class="line">&gt;&gt;&gt; import hello</span><br><span class="line">&gt;&gt;&gt; hello.text()</span><br><span class="line">&gt;&gt;&gt; Hello, world!</span><br></pre></td></tr></table></figure><h4 id="模块内作用域"><a href="#模块内作用域" class="headerlink" title="模块内作用域"></a>模块内作用域</h4><hr><p>Python中没有严格的作用域限定方式，只能依靠某些特定的命名方式以及约定俗称来限定模块间对象的访问规则：</p><ol><li>能够被外部访问的模块内对象只能以<strong>字母</strong>开头</li><li>特殊对象，如声明作者，调用判断，文档说明等，均以<code>__</code>开头以及结尾，如<code>__author__</code>, <code>__name__</code>, <code>__doc__</code></li><li>非公开变量需要使用下划线开头，例如<code>_xxx</code>, <code>__xxx</code>，这样的对象不应该被直接引用。</li></ol><h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><hr><p>接下来我们看一些python中的相关操作。</p><p>Python中定义类通过<code>class</code>关键字</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p><code>class</code>后面紧接着是类名，即<code>Student</code>，类名通常是大写开头的单词，紧接着是<code>(object)</code>，表示该类是从哪个类继承下来的，继承的概念我们后面再讲，通常，如果没有合适的继承类，就使用<code>object</code>类，这是所有类最终都会继承的类。</p><p>实例化则通过如下方式：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; bart = Student()</span><br><span class="line">&gt;&gt;&gt; bart</span><br><span class="line">&lt;__main__.Student object at <span class="number">0</span>x10a67a590&gt;</span><br><span class="line">&gt;&gt;&gt; Student</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;__<span class="title">main__</span>.<span class="title">Student</span>&#x27;&gt;</span></span><br></pre></td></tr></table></figure><p>创建实例后，可以为某一单独实例绑定属性：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; bart.name = <span class="string">&#x27;Bart Simpson&#x27;</span></span><br><span class="line">&gt;&gt;&gt; bart.name</span><br><span class="line"><span class="string">&#x27;Bart Simpson&#x27;</span></span><br></pre></td></tr></table></figure><p>而为类绑定属性，则需要使用一个特殊的方法：<code>__init__</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, score</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.score = score</span><br></pre></td></tr></table></figure><p>其中第一个参数<code>self</code>表示创建的实例本身，因此在该函数内会将各种属性绑定到<code>self</code>即<code>self</code>所指的实例。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>bart = Student(<span class="string">&#x27;Bart Simpson&#x27;</span>, <span class="number">59</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bart.name</span><br><span class="line"><span class="string">&#x27;Bart Simpson&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bart.score</span><br><span class="line"><span class="number">59</span></span><br></pre></td></tr></table></figure><p>可见实例本身不用显式的传入实例。</p><p>为类创建方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, score</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.score = score</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_score</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;%s: %s&#x27;</span> % (self.name, self.score))</span><br></pre></td></tr></table></figure><p>调用时直接使用：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; bart.print_score()</span><br><span class="line">Bart Simpson: <span class="number">59</span></span><br></pre></td></tr></table></figure><p>可见<code>self</code>也不需要显示的传入</p><h3 id="访问限制"><a href="#访问限制" class="headerlink" title="访问限制"></a>访问限制</h3><hr><p>有时为了更好的封装某个类，我们通常会对类中的变量进行访问权限的限制。在python中，没有特定的访问限制关键字，而是通过特殊的变量名进行限制。</p><p>如果要让内部属性不被外部访问，可以把属性的名称前加上两个下划线<code>__</code>，在Python中，实例的变量名如果以<code>__</code>开头，就变成了一个私有变量（private），只有内部可以访问，外部不能访问，例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, score</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__score = score</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_score</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;%s: %s&#x27;</span> % (self.__name, self.__score))</span><br></pre></td></tr></table></figure><p>再次访问将得到如下结果：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; bart = Student(<span class="string">&#x27;Bart Simpson&#x27;</span>, <span class="number">59</span>)</span><br><span class="line">&gt;&gt;&gt; bart.__name</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">AttributeError: <span class="string">&#x27;Student&#x27;</span> object has no attribute <span class="string">&#x27;__name&#x27;</span></span><br></pre></td></tr></table></figure><p>此时可以通过为私有变量增加get和set方法创建接口来访问他们。</p><p>还需要注意的是，在Python中，变量名类似<code>__xxx__</code>的，也就是以双下划线开头，并且以双下划线结尾的，是特殊变量，特殊变量是可以直接访问的，不是private变量，所以，不能用<code>__name__</code>、<code>__score__</code>这样的变量名。</p><p>而有些时候，你会看到以一个下划线开头的实例变量名，比如<code>_name</code>，这样的实例变量外部是可以访问的，但是，按照约定俗成的规定，当你看到这样的变量时，意思就是，“虽然我可以被访问，但是，请把我视为私有变量，不要随意访问”。</p><p>而模块中讲到，python中作用域限定通常依靠约定俗称。其实是类中的访问权限限制也是如此。</p><p>不能直接访问<code>__name</code>是因为Python解释器对外把<code>__name</code>变量改成了<code>_Student__name</code>，所以，仍然可以通过<code>_Student__name</code>来访问<code>__name</code>变量：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>bart._Student__name</span><br><span class="line"><span class="string">&#x27;Bart Simpson&#x27;</span></span><br></pre></td></tr></table></figure><p>但不同版本的Python解释器可能会把<code>__name</code>改成不同的变量名。</p><p>另外，在修改操作上，Python的访问限制也没有达到理想效果：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; bart = Student(<span class="string">&#x27;Bart Simpson&#x27;</span>, <span class="number">59</span>)</span><br><span class="line">&gt;&gt;&gt; bart.get_name()</span><br><span class="line"><span class="string">&#x27;Bart Simpson&#x27;</span></span><br><span class="line">&gt;&gt;&gt; bart.__name = <span class="string">&#x27;New Name&#x27;</span> <span class="comment"># 设置__name变量！</span></span><br><span class="line">&gt;&gt;&gt; bart.__name</span><br><span class="line"><span class="string">&#x27;New Name&#x27;</span></span><br></pre></td></tr></table></figure><p>表面上看，外部代码“成功”地设置了<code>__name</code>变量，但实际上这个<code>__name</code>变量和class内部的<code>__name</code>变量<em>不是</em>一个变量！内部的<code>__name</code>变量已经被Python解释器自动改成了<code>_Student__name</code>，而外部代码给<code>bart</code>新增了一个<code>__name</code>变量：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>bart.get_name() <span class="comment"># get_name()内部返回self.__name</span></span><br><span class="line"><span class="string">&#x27;Bart Simpson&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="继承与多态"><a href="#继承与多态" class="headerlink" title="继承与多态"></a>继承与多态</h3><hr><p>在类的章节有讲到python中继承的方式：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Class Animal(<span class="built_in">object</span>):</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;Animal is running...&#x27;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Introduce</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;I\&#x27;m an animal&#x27;</span>)</span><br></pre></td></tr></table></figure><p>如上类就是继承了object类的一个Animal类，我们可以继续编写它的子类：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>(<span class="params">Animal</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;Dog is running...&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eat</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;Eating meat...&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span>(<span class="params">Animal</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;Cat is running...&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eat</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;Eating Fish...&#x27;</span>)</span><br></pre></td></tr></table></figure><p>可见Dog和Cat类继承了Animal的方法，并且在其中重写了<code>run</code>方法</p><p>Python中创建一个类，实际上是定义了一种新的数据类型，也就意味着：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="built_in">list</span>()</span><br><span class="line">b = Animal()</span><br><span class="line">c = Dog()</span><br><span class="line"></span><br><span class="line"><span class="built_in">isinstance</span>(a, <span class="built_in">list</span>)  <span class="comment"># True</span></span><br><span class="line"><span class="built_in">isinstance</span>(b, Animal)  <span class="comment"># True</span></span><br><span class="line"><span class="built_in">isinstance</span>(c, Dog)  <span class="comment"># True</span></span><br><span class="line"><span class="built_in">isinstance</span>(c, Animal)  <span class="comment"># True</span></span><br></pre></td></tr></table></figure><p>可见<code>c</code>即是<code>Dog</code>也是<code>Animal</code>，那么如下操作也是合法的：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">running</span>(<span class="params">animal</span>):</span></span><br><span class="line">    animal.run()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">running(Animal())  <span class="comment"># Animal is running</span></span><br><span class="line">running(Dog())  <span class="comment"># Dog is running</span></span><br><span class="line">running(Cat())  <span class="comment"># Cat is running</span></span><br></pre></td></tr></table></figure><p>可见<code>Dog</code>与<code>Cat</code>的实例能够被接受且均能调用<code>run()</code>方法。</p><p>这样的特性能够让我们很方便的实现<strong>“开闭”原则</strong>即：</p><ol><li>对扩展开放：允许新增<code>Animal</code>子类</li><li>对修改封闭：不需要修改以来<code>Animal</code>类型的<code>running</code>等函数</li></ol><h4 id="静态语言与动态语言"><a href="#静态语言与动态语言" class="headerlink" title="静态语言与动态语言"></a>静态语言与动态语言</h4><hr><p>上面的例子中的<code>running</code>函数看起来是用了一个<code>Animal</code>类型的变量接受了参数，但由于Python是动态语言，实际上传入<code>running</code>函数前，编辑器并不知道将传入的是个怎样的类型，这就意味着，只要我们传入的参数包含<code>run</code>方法，那么代码就能正常运行，例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Timer</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;Start...&#x27;</span>)</span><br><span class="line"></span><br><span class="line">running(Timer())  <span class="comment"># &#x27;Start...&#x27;</span></span><br></pre></td></tr></table></figure><p>而在Java和C++中，这样的参数传入是不被允许的。</p><p>这就是动态语言中的<code>鸭子类型</code>，它并不要求严格的继承体系，所谓<em>一个对象只要“看起来像鸭子，走起路来像鸭子”，那它就可以被看做是鸭子。</em></p><p>Python的“file-like object“就是一种鸭子类型。对真正的文件对象，它有一个<code>read()</code>方法，返回其内容。但是，许多对象，只要有<code>read()</code>方法，都被视为“file-like object“。许多函数接收的参数就是“file-like object“，你不一定要传入真正的文件对象，完全可以传入任何实现了<code>read()</code>方法的对象。</p><h3 id="获取对象信息"><a href="#获取对象信息" class="headerlink" title="获取对象信息"></a>获取对象信息</h3><hr><p>当我们拿到一个实例对象时，有两种方法可以确定他们的类：</p><ol><li><code>type()</code></li><li><code>instance()</code></li></ol><h4 id="type"><a href="#type" class="headerlink" title="type"></a>type</h4><hr><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="built_in">type</span>(<span class="number">123</span>)</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">int</span>&#x27;&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">type</span>(&#x27;<span class="title">str</span>&#x27;)</span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> &#x27;<span class="title">str</span>&#x27;&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">type</span>(<span class="title">None</span>)</span></span><br><span class="line"><span class="class">&lt;<span class="title">type</span>(<span class="title">None</span>) &#x27;<span class="title">NoneType</span>&#x27;&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">type</span>(<span class="title">abs</span>)</span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> &#x27;<span class="title">builtin_function_or_method</span>&#x27;&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">type</span>(<span class="title">a</span>)</span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> &#x27;__<span class="title">main__</span>.<span class="title">Animal</span>&#x27;&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">type</span>(123)==<span class="title">type</span>(456)</span></span><br><span class="line"><span class="class"><span class="title">True</span></span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">type</span>(123)==<span class="title">int</span></span></span><br><span class="line"><span class="class"><span class="title">True</span></span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">type</span>(&#x27;<span class="title">abc</span>&#x27;)==<span class="title">type</span>(&#x27;123&#x27;)</span></span><br><span class="line"><span class="class"><span class="title">True</span></span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">type</span>(&#x27;<span class="title">abc</span>&#x27;)==<span class="title">str</span></span></span><br><span class="line"><span class="class"><span class="title">True</span></span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">type</span>(&#x27;<span class="title">abc</span>&#x27;)==<span class="title">type</span>(123)</span></span><br><span class="line"><span class="class"><span class="title">False</span></span></span><br></pre></td></tr></table></figure><p>如果需要判断一个对象是否是函数，则需要使用<code>types</code>模块：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import types</span><br><span class="line">&gt;&gt;&gt; def fn():</span><br><span class="line">...     pass</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">type</span>(fn)==types.FunctionType</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">type</span>(abs)==types.BuiltinFunctionType</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">type</span>(lambda x: x)==types.LambdaType</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">type</span>((x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>)))==types.GeneratorType</span><br><span class="line">True</span><br></pre></td></tr></table></figure><h4 id="instance"><a href="#instance" class="headerlink" title="instance"></a>instance</h4><hr><p><code>type</code>获取类型较为方便，但是对于继承关系来说，就没有那么方便了，此时需要用到instance，例如对于如下继承链：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object -&gt; Animal -&gt; Dog -&gt; Husky</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = Animal()</span><br><span class="line">&gt;&gt;&gt; d = Dog()</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">h</span> = Husky()</span><br><span class="line">&gt;&gt;&gt; isinstance(<span class="built_in">h</span>, Husky)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance(<span class="built_in">h</span>, Dog)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance(<span class="built_in">h</span>, Animal)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance(d, Dog) and isinstance(d, Animal)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance(d, Husky)</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; isinstance(<span class="string">&#x27;a&#x27;</span>, str)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance(<span class="number">123</span>, int)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance(b<span class="string">&#x27;a&#x27;</span>, bytes)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], (list, tuple))</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), (list, tuple))</span><br><span class="line">True</span><br></pre></td></tr></table></figure><div class="note info"><p>总是优先使用isinstance()判断类型，可以将指定类型及其子类“一网打尽”。</p></div><h3 id="获取对象属性"><a href="#获取对象属性" class="headerlink" title="获取对象属性"></a>获取对象属性</h3><hr><p>如果想要获取一个对象的所有属性和方法，可以使用<code>dir()</code>函数，它将返回一个包含该对象的所有属性名的字符串<code>list</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="built_in">dir</span>(<span class="string">&#x27;ABC&#x27;</span>)</span><br><span class="line">[<span class="string">&#x27;__add__&#x27;</span>, <span class="string">&#x27;__class__&#x27;</span>, <span class="string">&#x27;__contains__&#x27;</span>, <span class="string">&#x27;__delattr__&#x27;</span>, <span class="string">&#x27;__dir__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__eq__&#x27;</span>, <span class="string">&#x27;__format__&#x27;</span>, <span class="string">&#x27;__ge__&#x27;</span>, <span class="string">&#x27;__getattribute__&#x27;</span>, <span class="string">&#x27;__getitem__&#x27;</span>, <span class="string">&#x27;__getnewargs__&#x27;</span>, <span class="string">&#x27;__gt__&#x27;</span>, <span class="string">&#x27;__hash__&#x27;</span>, <span class="string">&#x27;__init__&#x27;</span>, <span class="string">&#x27;__init_subclass__&#x27;</span>, <span class="string">&#x27;__iter__&#x27;</span>, <span class="string">&#x27;__le__&#x27;</span>, <span class="string">&#x27;__len__&#x27;</span>, <span class="string">&#x27;__lt__&#x27;</span>, <span class="string">&#x27;__mod__&#x27;</span>, <span class="string">&#x27;__mul__&#x27;</span>, <span class="string">&#x27;__ne__&#x27;</span>, <span class="string">&#x27;__new__&#x27;</span>, <span class="string">&#x27;__reduce__&#x27;</span>, <span class="string">&#x27;__reduce_ex__&#x27;</span>, <span class="string">&#x27;__repr__&#x27;</span>, <span class="string">&#x27;__rmod__&#x27;</span>, <span class="string">&#x27;__rmul__&#x27;</span>, <span class="string">&#x27;__setattr__&#x27;</span>, <span class="string">&#x27;__sizeof__&#x27;</span>, <span class="string">&#x27;__str__&#x27;</span>, <span class="string">&#x27;__subclasshook__&#x27;</span>, <span class="string">&#x27;capitalize&#x27;</span>, <span class="string">&#x27;casefold&#x27;</span>, <span class="string">&#x27;center&#x27;</span>, <span class="string">&#x27;count&#x27;</span>, <span class="string">&#x27;encode&#x27;</span>, <span class="string">&#x27;endswith&#x27;</span>, <span class="string">&#x27;expandtabs&#x27;</span>, <span class="string">&#x27;find&#x27;</span>, <span class="string">&#x27;format&#x27;</span>, <span class="string">&#x27;format_map&#x27;</span>, <span class="string">&#x27;index&#x27;</span>, <span class="string">&#x27;isalnum&#x27;</span>, <span class="string">&#x27;isalpha&#x27;</span>, <span class="string">&#x27;isascii&#x27;</span>, <span class="string">&#x27;isdecimal&#x27;</span>, <span class="string">&#x27;isdigit&#x27;</span>, <span class="string">&#x27;isidentifier&#x27;</span>, <span class="string">&#x27;islower&#x27;</span>, <span class="string">&#x27;isnumeric&#x27;</span>, <span class="string">&#x27;isprintable&#x27;</span>, <span class="string">&#x27;isspace&#x27;</span>, <span class="string">&#x27;istitle&#x27;</span>, <span class="string">&#x27;isupper&#x27;</span>, <span class="string">&#x27;join&#x27;</span>, <span class="string">&#x27;ljust&#x27;</span>, <span class="string">&#x27;lower&#x27;</span>, <span class="string">&#x27;lstrip&#x27;</span>, <span class="string">&#x27;maketrans&#x27;</span>, <span class="string">&#x27;partition&#x27;</span>, <span class="string">&#x27;removeprefix&#x27;</span>, <span class="string">&#x27;removesuffix&#x27;</span>, <span class="string">&#x27;replace&#x27;</span>, <span class="string">&#x27;rfind&#x27;</span>, <span class="string">&#x27;rindex&#x27;</span>, <span class="string">&#x27;rjust&#x27;</span>, <span class="string">&#x27;rpartition&#x27;</span>, <span class="string">&#x27;rsplit&#x27;</span>, <span class="string">&#x27;rstrip&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;splitlines&#x27;</span>, <span class="string">&#x27;startswith&#x27;</span>, <span class="string">&#x27;strip&#x27;</span>, <span class="string">&#x27;swapcase&#x27;</span>, <span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;translate&#x27;</span>, <span class="string">&#x27;upper&#x27;</span>, <span class="string">&#x27;zfill&#x27;</span>]</span><br></pre></td></tr></table></figure><p>其中类似<code>__len__</code>的方法再python中是有特殊用途的，如果调用<code>len()</code>函数试图获取一个对象的长度，实际上，在<code>len()</code>函数试图获取一个对象的长度，实际上，在<code>len()</code>函数内部是去调用该对象的<code>__len__()</code>方法，所以以下两行代码是等价的：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">len</span>(<span class="string">&#x27;ABC&#x27;</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;ABC&#x27;</span>.__len__()</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure><p>这就意味着自定义类如果也想通过<code>len</code>函数获取长度，则只需要在我们自定义的类中实现<code>__len__()</code>方法即可：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDog</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span>(<span class="params">self</span>):</span></span><br><span class="line">        retrun <span class="number">100</span></span><br><span class="line"></span><br><span class="line">dog = MyDog()</span><br><span class="line"><span class="built_in">len</span>(dog)  <span class="comment"># 100</span></span><br></pre></td></tr></table></figure><p>此外配合<code>getattr()</code>，<code>setattr()</code>，<code>hasattr()</code>，可以直接操作一个对象的状态：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyObject</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">         self.x = <span class="number">9</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">power</span>(<span class="params">self</span>):</span></span><br><span class="line">         <span class="keyword">return</span> self.x * self.x</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">obj = MyObject()</span><br><span class="line"><span class="built_in">hasattr</span>(obj,<span class="string">&#x27;x&#x27;</span>)  <span class="comment"># True 有属性x</span></span><br><span class="line"><span class="built_in">hasattr</span>(obj,<span class="string">&#x27;y&#x27;</span>)  <span class="comment"># False 没有属性y</span></span><br><span class="line"><span class="built_in">setattr</span>(obj,<span class="string">&#x27;y&#x27;</span>,<span class="number">19</span>)  <span class="comment"># 设置一个属性y</span></span><br><span class="line"><span class="built_in">hasattr</span>(obj,<span class="string">&#x27;y&#x27;</span>)  <span class="comment"># True 有属性y</span></span><br><span class="line"><span class="built_in">getattr</span>(obj,<span class="string">&#x27;y&#x27;</span>)  <span class="comment"># 19 获取属性y</span></span><br></pre></td></tr></table></figure><p>如果获取一个没有的属性，则会报如下错误：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; getattr(obj, <span class="string">&#x27;z&#x27;</span>) <span class="comment"># 获取属性&#x27;z&#x27;</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">AttributeError: <span class="string">&#x27;MyObject&#x27;</span> object has no attribute <span class="string">&#x27;z&#x27;</span></span><br></pre></td></tr></table></figure><p><code>getattr()</code>还支持自定义错误返回值：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; getattr(obj, <span class="string">&#x27;z&#x27;</span>, <span class="number">404</span>) <span class="comment"># 获取属性&#x27;z&#x27;，如果不存在，返回默认值404</span></span><br><span class="line"><span class="number">404</span></span><br></pre></td></tr></table></figure><p>此外，对象的方法也是可以操作的：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; hasattr(obj, <span class="string">&#x27;power&#x27;</span>) <span class="comment"># 有属性&#x27;power&#x27;吗？</span></span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; getattr(obj, <span class="string">&#x27;power&#x27;</span>) <span class="comment"># 获取属性&#x27;power&#x27;</span></span><br><span class="line">&lt;bound method MyObject.power of &lt;__main__.MyObject object at <span class="number">0</span>x10077a6a0&gt;&gt;</span><br><span class="line">&gt;&gt;&gt; fn = getattr(obj, <span class="string">&#x27;power&#x27;</span>) <span class="comment"># 获取属性&#x27;power&#x27;并赋值到变量fn</span></span><br><span class="line">&gt;&gt;&gt; fn <span class="comment"># fn指向obj.power</span></span><br><span class="line">&lt;bound method MyObject.power of &lt;__main__.MyObject object at <span class="number">0</span>x10077a6a0&gt;&gt;</span><br><span class="line">&gt;&gt;&gt; fn() <span class="comment"># 调用fn()与调用obj.power()是一样的</span></span><br></pre></td></tr></table></figure><p>这些操作在不确定自己获得的是一个怎样的对象时会派上用场：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">readImage</span>(<span class="params">fp</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(fp, <span class="string">&#x27;read&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> readData(fp)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure><h3 id="实例属性和类属性"><a href="#实例属性和类属性" class="headerlink" title="实例属性和类属性"></a>实例属性和类属性</h3><hr><p>python中类的属性有实例属性与类属性的区别</p><p>实例属性是，在创建实例时，为每个实例都增加上的属性，操作如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">s = Student(<span class="string">&#x27;Bob&#x27;</span>)</span><br><span class="line">s.score = <span class="number">90</span></span><br></pre></td></tr></table></figure><p>而类属性则是为类绑定的属性：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    name = <span class="string">&#x27;Student&#x27;</span></span><br></pre></td></tr></table></figure><p>这样的属性我们不实例化也可以访问到：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; Student.name</span><br><span class="line">Student</span><br><span class="line">&gt;&gt;&gt; s = Student()</span><br><span class="line">&gt;&gt;&gt; s.name</span><br><span class="line">Student</span><br><span class="line">&gt;&gt;&gt; s.name = <span class="string">&quot;Michael&quot;</span></span><br><span class="line">&gt;&gt;&gt; s.name</span><br><span class="line">Michael</span><br><span class="line">&gt;&gt;&gt; Student.name</span><br><span class="line">Student</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">del</span> s.name</span><br><span class="line">&gt;&gt;&gt; s.name</span><br><span class="line">Student</span><br></pre></td></tr></table></figure><p>可以看到，在类和对象具有同名属性时，我们访问对象的该属性，优先访问到的是实例属性，因此不要对实例属性和类属性使用相同的名字，因为相同名称的实例属性将屏蔽掉类属性。</p><h3 id="属性绑定"><a href="#属性绑定" class="headerlink" title="属性绑定"></a>属性绑定</h3><hr><p>由于Python动态语言的特性，Python可以轻松实现在允许过程中对类进行操作，比如可以很轻松的为类绑定方法与属性：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = Student()</span><br><span class="line">&gt;&gt;&gt; s.name = <span class="string">&#x27;Michael&#x27;</span> <span class="comment"># 动态给实例绑定一个属性</span></span><br><span class="line">&gt;&gt;&gt; print(s.name)</span><br><span class="line">Michael</span><br></pre></td></tr></table></figure><p>绑定方法需要用到<code>types</code>库：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; def set_age(self, age): <span class="comment"># 定义一个函数作为实例方法</span></span><br><span class="line">...     self.age = age</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; from types import MethodType</span><br><span class="line">&gt;&gt;&gt; s.set_age = MethodType(set_age, s) <span class="comment"># 给实例绑定一个方法</span></span><br><span class="line">&gt;&gt;&gt; s.set_age(<span class="number">25</span>) <span class="comment"># 调用实例方法</span></span><br><span class="line">&gt;&gt;&gt; s.age <span class="comment"># 测试结果</span></span><br><span class="line"><span class="number">25</span></span><br></pre></td></tr></table></figure><p>与属性相同，为特定对象绑定的方法无法在另一对象或类中使用，需要为类绑定方法才能让所有对象均可使用</p><h4 id="slots"><a href="#slots" class="headerlink" title="__slots__"></a><code>__slots__</code></h4><p>python还提供了一种可以限制运行时绑定的属性的操作，比如只允许动态的为<code>Student</code>实例添加<code>name</code>和<code>age</code>属性，此时就可以用到<code>__slots__</code>变量：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    __slots__ = (<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;age&#x27;</span>) <span class="comment"># 用tuple定义允许绑定的属性名称</span></span><br></pre></td></tr></table></figure><p>然后尝试为其绑定属性：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = Student() <span class="comment"># 创建新的实例</span></span><br><span class="line">&gt;&gt;&gt; s.name = <span class="string">&#x27;Michael&#x27;</span> <span class="comment"># 绑定属性&#x27;name&#x27;</span></span><br><span class="line">&gt;&gt;&gt; s.age = <span class="number">25</span> <span class="comment"># 绑定属性&#x27;age&#x27;</span></span><br><span class="line">&gt;&gt;&gt; s.score = <span class="number">99</span> <span class="comment"># 绑定属性&#x27;score&#x27;</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">AttributeError: <span class="string">&#x27;Student&#x27;</span> object has no attribute <span class="string">&#x27;score&#x27;</span></span><br></pre></td></tr></table></figure><p>可见由于<code>score</code>没有被<code>__slots__</code>指明，因此绑定此属性时报错。</p><p>但<code>__slots__</code>定义的属性仅对当前类实例起作用，对继承的子类是不起作用的：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="class"><span class="keyword">class</span> <span class="title">GraduateStudent</span>(<span class="title">Student</span>):</span></span><br><span class="line"><span class="class">...     <span class="title">pass</span></span></span><br><span class="line"><span class="class">...</span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">g</span> = <span class="title">GraduateStudent</span>()</span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">g</span>.<span class="title">score</span> = 9999</span></span><br></pre></td></tr></table></figure><p>除非在子类中也定义<code>__slots__</code>，这样，子类实例允许定义的属性就是自身的<code>__slots__</code>加上父类的<code>__slots__</code>。</p><h3 id="property"><a href="#property" class="headerlink" title="@property"></a>@property</h3><hr><p>在进行面向对象编程时，我们为了代码的健壮性，通常会对某个类的属性操作进行封装，让这些属性变成私有属性，然后通过对外暴露<code>getter</code>和<code>setter</code>方法来操作这些属性，这样我们在修改和访问这些属性时，就能增加一些类似类型检测，安全检测等诸如此类的操作。</p><p>通常我们可以这样写：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_score</span>(<span class="params">self</span>):</span></span><br><span class="line">         <span class="keyword">return</span> self._score</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_score</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value, <span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must be an integer!&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; <span class="number">100</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must between 0 ~ 100!&#x27;</span>)</span><br><span class="line">        self._score = value</span><br></pre></td></tr></table></figure><p>修改和查询<code>score</code>属性时，我们需要这样做：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = Student()</span><br><span class="line">&gt;&gt;&gt; s.set_score(<span class="number">60</span>) <span class="comment"># ok!</span></span><br><span class="line">&gt;&gt;&gt; s.get_score()</span><br><span class="line"><span class="number">60</span></span><br><span class="line">&gt;&gt;&gt; s.set_score(<span class="number">9999</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  ...</span><br><span class="line">ValueError: score must between <span class="number">0</span> ~ <span class="number">100</span>!</span><br></pre></td></tr></table></figure><p>访问<code>score</code>属性时，我们需要通过<code>get_score</code>函数进行访问。</p><p>python为我们提供了更为直观的访问方法，可以直接通过<code>s.score</code>进行访问和修改，并且还能实现如上的安全检测功能，这就是<code>@property</code>语法糖：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._score</span><br><span class="line"></span><br><span class="line"><span class="meta">    @score.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value, <span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must be an integer!&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; <span class="number">100</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must between 0 ~ 100!&#x27;</span>)</span><br><span class="line">        self._score = value</span><br></pre></td></tr></table></figure><p>把一个getter方法变成属性，只需要加上<code>@property</code>就可以了，此时，<code>@property</code>本身又创建了另一个装饰器<code>@score.setter</code>，负责把一个setter方法变成属性赋值，于是，我们就拥有一个可控的属性操作：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = Student()</span><br><span class="line">&gt;&gt;&gt; s.score = <span class="number">60</span> <span class="comment"># OK，实际转化为s.set_score(60)</span></span><br><span class="line">&gt;&gt;&gt; s.score <span class="comment"># OK，实际转化为s.get_score()</span></span><br><span class="line"><span class="number">60</span></span><br><span class="line">&gt;&gt;&gt; s.score = <span class="number">9999</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  ...</span><br><span class="line">ValueError: score must between <span class="number">0</span> ~ <span class="number">100</span>!</span><br></pre></td></tr></table></figure><p>还可以实现对属性的只读访问：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">birth</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._birth</span><br><span class="line"></span><br><span class="line"><span class="meta">    @birth.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">birth</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        self._birth = value</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">age</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">2021</span> - self._birth</span><br></pre></td></tr></table></figure><p>上面的<code>age</code>属性并没有设置<code>setter</code>方法，因此感官上来说是不能对其进行修改操作。</p><p>需要特别注意的是：</p><div class="note danger"><p>属性的方法名和实例变量名不能一样</p></div><p>看如下例子：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 方法名称和实例变量均为birth:</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">birth</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.birth</span><br></pre></td></tr></table></figure><p>这时如果我们调用<code>s.birth</code>，首先执行上方定义的方法，在执行到<code>return self.birth</code>，又视为调用了对象<code>s</code>的<code>score</code>属性，于是又转到<code>birth</code>方法，形成无限层递归，由于没有对尾递归进行优化，最终将报栈溢出错误<code>RecursionError</code></p><h3 id="MixIn"><a href="#MixIn" class="headerlink" title="MixIn"></a>MixIn</h3><hr><p>Python中的类是支持多继承的，而MixIn设计思路是Python中为了更好的实现Python多继承的设计思路。</p><p>现在我们需要为如下几种动物创建类：</p><ol><li>Dog - 狗勾🐕</li><li>Bat - 蝙蝠🦇</li><li>Parrot - 鹦鹉🦜</li><li>Ostrich - 鸵鸟🦩</li></ol><p>如果我们想要将</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">                ┌───────────────┐</span><br><span class="line">                │    Animal     │</span><br><span class="line">                └───────────────┘</span><br><span class="line">                        │</span><br><span class="line">           ┌────────────┴────────────┐</span><br><span class="line">           │                         │</span><br><span class="line">           ▼                         ▼</span><br><span class="line">    ┌─────────────┐           ┌─────────────┐</span><br><span class="line">    │   Mammal    │           │    Bird     │</span><br><span class="line">    └─────────────┘           └─────────────┘</span><br><span class="line">           │                         │</span><br><span class="line">     ┌─────┴──────┐            ┌─────┴──────┐</span><br><span class="line">     │            │            │            │</span><br><span class="line">     ▼            ▼            ▼            ▼</span><br><span class="line">┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐</span><br><span class="line">│  MRun   │  │  MFly   │  │  BRun   │  │  BFly   │</span><br><span class="line">└─────────┘  └─────────┘  └─────────┘  └─────────┘</span><br><span class="line">     │            │            │            │</span><br><span class="line">     │            │            │            │</span><br><span class="line">     ▼            ▼            ▼            ▼</span><br><span class="line">┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐</span><br><span class="line">│   Dog   │  │   Bat   │  │ Ostrich │  │ Parrot  │</span><br><span class="line">└─────────┘  └─────────┘  └─────────┘  └─────────┘</span><br></pre></td></tr></table></figure><p>在Java中采用单继承的方式，如果必须为每个种类定义一个类的话，想必定义这些类就需要一长串的代码。但是通常Java中会使用接口来解决这一问题。Python中则使用多继承：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 大类:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mammal</span>(<span class="params">Animal</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bird</span>(<span class="params">Animal</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RunnableMixIn</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;Running...&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FlyableMixIn</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fly</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;Flying...&#x27;</span>)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 各种动物:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>(<span class="params">Mammal, RunnableMixIn</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bat</span>(<span class="params">Mammal, FlyableMixIn</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parrot</span>(<span class="params">Bird, FlyableMixIn</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ostrich</span>(<span class="params">Bird, RunnablebleMixIn</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>其中以<code>MixIn</code>结尾的类的目的就是给一个类增加多个功能，这一在设计类的时候，我们优先考虑通过多重继承来组合多个<code>MixIn</code>的功能，而不是设计多层次复杂的继承关系。</p><p>可见<code>MixIn</code>在思想上有些类似java中的接口，但是具体操作和实现上有很大的区别。</p><p>那么为什么java没有多继承机制呢？</p><p>因为采用多继承时，如果继承的两个类中有同名方法，那么调用该方法时编译器将不知道调用的是哪个父类中的方法。</p><p>那么Python中又是通过怎样的方式解决的呢？</p><p>实验过程参考如下博客：</p><div class="tag link"><a class="link-card" title="" href="Python多重继承排序原理"><div class="left"><img src="https://www.jianshu.com/p/c9a0b055947b" class="lazyload placeholder" data-srcset="https://www.jianshu.com/p/c9a0b055947b" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text"></p><p class="url">Python多重继承排序原理</p></div></a></div><p>该博客通过介绍拓扑排序以及C3算法，最后经过举例验证，得出结论：python中多继承的方法访问顺序遵从拓扑序。</p><p>该博客还补充了一个概念：<code>MRO</code>即<em>method resolution order</em></p><p>对于如下继承关系：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;A foo&#x27;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bar</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;A bar&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;B foo&#x27;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bar</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;B bar&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C1</span>(<span class="params">A,B</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C2</span>(<span class="params">A,B</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bar</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;C2-bar&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span>(<span class="params">C1,C2</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print(D.__mro__)</span><br><span class="line">    d=D()</span><br><span class="line">    d.foo()</span><br><span class="line">    d.bar()</span><br></pre></td></tr></table></figure><p>上述继承关系的图如下：</p><p><img src="https://upload-images.jianshu.io/upload_images/143920-c35a0535a4e124a3.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/349/format/webp" class="lazyload placeholder" data-srcset="https://upload-images.jianshu.io/upload_images/143920-c35a0535a4e124a3.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/349/format/webp" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="img"></p><p>当我们调用<code>d.foo()</code>时，按照拓扑排序规则，解释器会先去寻找D类中是否拥有<code>foo()</code>方法，即在图中去掉D对应的点以及D的出边。</p><p>于是存在的点只剩下：[C1,C2,A,B,object]，其中没有入度的点为C1和C2，根据左优先原则，寻找C1中是否包含<code>foo()</code>方法，去掉C1点以及C1的出边。</p><p>此时存在的点只剩下：[C2,A,B,object]，其中没有入度的点为C2，寻找C2中是否包含<code>foo()</code>方法，去掉C2点以及C2的出边。</p><p>此时存在的点只剩下：[A,B,object]，其中没有入度的点为A，B，根据左优先原则，寻找A中是否包含<code>foo()</code>方法，发现包含，于是调用该方法输出<code>A foo</code></p><p>调用<code>d.bar()</code>时，同样也是按照拓扑序进行查找，最终输出<code>C2-bar</code></p><p>而第26行代码，调用了D类的<code>__mro__</code>方法，将直接输出解释器寻找方法的先后顺序。因此最终的测试结果为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(&lt;class &#x27;__main__.D&#x27;&gt;, &lt;class &#x27;__main__.C1&#x27;&gt;, &lt;class &#x27;__main__.C2&#x27;&gt;, &lt;class &#x27;__main__.A&#x27;&gt;, &lt;class &#x27;__main__.B&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;)</span><br><span class="line">A foo</span><br><span class="line">C2-bar</span><br></pre></td></tr></table></figure><h3 id="定制类"><a href="#定制类" class="headerlink" title="定制类"></a>定制类</h3><hr><p>与<code>__slots__</code>类似，Python还具有很多类似命名的，有特殊作用的函数以及变量。下面来积累几个</p><h4 id="str"><a href="#str" class="headerlink" title="__str__"></a><code>__str__</code></h4><hr><p>类似Java中的<code>toString()</code>方法，当对某个实例进行打印时，实际上就是调用该实例的<code>__str__</code>方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Student object (name: %s)&#x27;</span> % self.name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(Student(<span class="string">&#x27;Michael&#x27;</span>))</span><br><span class="line"><span class="comment"># Student object (name: Michael)</span></span><br></pre></td></tr></table></figure><h4 id="repr"><a href="#repr" class="headerlink" title="__repr__"></a><code>__repr__</code></h4><hr><p>用于显示对该对象的解释，即我们直接在命令行中输入对象名时显示的内容，就是通过调用对象的<code>__repr__</code>方法得到，通常情况下，我们会将<code>__repr__</code>方法与<code>__str__</code>方法设置为同一个：</p><p>未定义<code>__repr__</code>时：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = Student(<span class="string">&#x27;Michael&#x27;</span>)</span><br><span class="line">&gt;&gt;&gt; s</span><br><span class="line">&lt;__main__.Student object at <span class="number">0</span>x109afb310&gt;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Student object (name=%s)&#x27;</span> % self.name</span><br><span class="line">    __repr__ = __str__</span><br></pre></td></tr></table></figure><p>定义后：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = Student(<span class="string">&#x27;Michael&#x27;</span>)</span><br><span class="line">&gt;&gt;&gt; s</span><br><span class="line">Student object (name: Michael)</span><br></pre></td></tr></table></figure><h4 id="iter-amp-next"><a href="#iter-amp-next" class="headerlink" title="__iter__&amp;__next__"></a><code>__iter__</code>&amp;<code>__next__</code></h4><hr><p>如果我们需要使用<code>for...in</code>来遍历某个对象，我们就需要实现<code>__iter__</code>与<code>__next__</code>方法。</p><ol><li><code>__iter__</code>用于返回一个迭代对象。即<code>for n in object</code>中的<code>n</code></li><li><code>__next__</code>用于在循环中反复调用1中返回的迭代对象的该函数以得到下一个对象，知道遇到<code>StopIteration</code>错误时退出循环。</li></ol><p>例如我们写一个可遍历的斐波那契类：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fib</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>():</span></span><br><span class="line">        self.a, self.b = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.a, self.b = self.b, self.a + self.b</span><br><span class="line">        <span class="keyword">if</span> self.a &gt; <span class="number">100000</span>:</span><br><span class="line">            <span class="keyword">raise</span> StopIteration()</span><br><span class="line">        <span class="keyword">return</span> self.a</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="keyword">for</span> n <span class="keyword">in</span> Fib():</span><br><span class="line">...    print(n)</span><br><span class="line">...</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">...</span><br><span class="line"><span class="number">46368</span></span><br><span class="line"><span class="number">75025</span></span><br></pre></td></tr></table></figure><h4 id="getitem"><a href="#getitem" class="headerlink" title="__getitem__"></a><code>__getitem__</code></h4><hr><p>用于对对象进行索引访问，如：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; Fib()[<span class="number">5</span>]</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">TypeError: <span class="string">&#x27;Fib&#x27;</span> object does not support indexing</span><br></pre></td></tr></table></figure><p>该操作实际上时调用对象的<code>__getitem__</code>方法，并将索引当作参数传入。当我们实现该方法后：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fib</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>():</span></span><br><span class="line">        self.a, self.b = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.a, self.b = self.b, self.a + self.b</span><br><span class="line">        <span class="keyword">if</span> self.a &gt; <span class="number">100000</span>:</span><br><span class="line">            <span class="keyword">raise</span> StopIteration()</span><br><span class="line">        <span class="keyword">return</span> self.a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span>(<span class="params">self, n</span>):</span></span><br><span class="line">        a, b = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            a,b = b, a + b</span><br><span class="line">        <span class="keyword">return</span> a</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; f = Fib()</span><br><span class="line">&gt;&gt;&gt; f[<span class="number">0</span>]</span><br><span class="line"><span class="number">1</span></span><br><span class="line">&gt;&gt;&gt; f[<span class="number">1</span>]</span><br><span class="line"><span class="number">1</span></span><br><span class="line">&gt;&gt;&gt; f[<span class="number">5</span>]</span><br><span class="line"><span class="number">8</span></span><br><span class="line">&gt;&gt;&gt; f[<span class="number">10</span>]</span><br><span class="line"><span class="number">89</span></span><br><span class="line">&gt;&gt;&gt; f[<span class="number">100</span>]</span><br><span class="line"><span class="number">573147844013817084101</span></span><br></pre></td></tr></table></figure><p>但是单纯的这样写，无法支持切片操作，切片操作实际上也是调用了对象的<code>__getitem__</code>方法，但是传入的是<code>slice</code>切片对象。由于动态语言python并不具备重载的能力，我们需要函数内部通过<code>if</code>进行判断</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fib</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>():</span></span><br><span class="line">        self.a, self.b = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.a, self.b = self.b, self.a + self.b</span><br><span class="line">        <span class="keyword">if</span> self.a &gt; <span class="number">100000</span>:</span><br><span class="line">            <span class="keyword">raise</span> StopIteration()</span><br><span class="line">        <span class="keyword">return</span> self.a</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span>(<span class="params">self, n</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(n, <span class="built_in">int</span>):  <span class="comment"># 接受int型参数</span></span><br><span class="line">        a, b = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            a,b = b, a + b</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(n, <span class="built_in">slice</span>):  <span class="comment"># 接受slice型参数</span></span><br><span class="line">            start = n.start</span><br><span class="line">            stop = n.stop</span><br><span class="line">            <span class="keyword">if</span> start <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                start = <span class="number">0</span></span><br><span class="line">            a, b = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">            L = []</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(stop):</span><br><span class="line">                <span class="keyword">if</span> x &gt;= start:</span><br><span class="line">                    L.append(a)</span><br><span class="line">                a, b = b, a + b</span><br><span class="line">            <span class="keyword">return</span> L</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; f = Fib()</span><br><span class="line">&gt;&gt;&gt; f[<span class="number">0</span>:<span class="number">5</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>]</span><br><span class="line">&gt;&gt;&gt; f[:<span class="number">10</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">21</span>, <span class="number">34</span>, <span class="number">55</span>, <span class="number">89</span>]</span><br></pre></td></tr></table></figure><p>如上并没有对<code>step</code>参数和负数进行处理，实际上这些都是可以处理的。</p><p>另外，如果将对象看作是<code>dict</code>，那么在该方法内还需要实现对<code>object</code>类型的参数第处理。</p><p>此外，除了<code>__getitem__</code>，还有<code>___setitem__</code>和<code>__delitem__</code>方法，用于删除和修改某个元素。</p><p>因此我们可以让自己的类创建的对象与<code>list</code>、<code>tuple</code>、<code>dict</code>没有什么区别。这都要归功于动态语言的<code>鸭子类型</code></p><h4 id="getattr"><a href="#getattr" class="headerlink" title="__getattr__"></a><code>__getattr__</code></h4><hr><p>该方法当我们访问某个对象中的未定义的属性时调用：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.name = <span class="string">&#x27;Michael&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span>(<span class="params">self, attr</span>):</span></span><br><span class="line">        <span class="keyword">if</span> attr==<span class="string">&#x27;score&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">99</span></span><br></pre></td></tr></table></figure><p>当调用不存在的属性时，比如<code>score</code>，Python解释器会试图调用<code>__getattr__(self, &#39;score&#39;)</code>来尝试获得属性，这样，我们就有机会返回<code>score</code>的值：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = Student()</span><br><span class="line">&gt;&gt;&gt; s.name</span><br><span class="line"><span class="string">&#x27;Michael&#x27;</span></span><br><span class="line">&gt;&gt;&gt; s.score</span><br><span class="line"><span class="number">99</span></span><br><span class="line">&gt;&gt;&gt; s.age</span><br><span class="line">None</span><br></pre></td></tr></table></figure><p>当访问没有定义的属性<code>score</code>和<code>age</code>时，就会调用<code>__getattr__</code>函数，由于该函数中未包含对<code>age</code>的处理，于是返回了默认返回值None。</p><p>要让class只响应特定的几个属性，我们就要按照约定，抛出<code>AttributeError</code>的错误：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span>(<span class="params">self, attr</span>):</span></span><br><span class="line">        <span class="keyword">if</span> attr==<span class="string">&#x27;age&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">lambda</span>: <span class="number">25</span></span><br><span class="line">        <span class="keyword">raise</span> AttributeError(<span class="string">&#x27;\&#x27;Student\&#x27; object has no attribute \&#x27;%s\&#x27;&#x27;</span> % attr)</span><br></pre></td></tr></table></figure><p>返回函数也是完全可以的：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span>(<span class="params">self, attr</span>):</span></span><br><span class="line">        <span class="keyword">if</span> attr==<span class="string">&#x27;age&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">lambda</span>: <span class="number">25</span></span><br></pre></td></tr></table></figure><p>只是调用方式要变为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.age()</span><br><span class="line"><span class="number">25</span></span><br></pre></td></tr></table></figure><p>该方法在写SDK时运用广泛。</p><p>有时我们可能需要给每个URL对应的API都写一个方法，API一旦改动，SDK也要改，利用动态的<code>__getattr__</code>，我们可以写一个链式调用：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Chain</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, path=<span class="string">&#x27;&#x27;</span></span>):</span></span><br><span class="line">        self._path = path</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span>(<span class="params">self, path</span>):</span></span><br><span class="line">        <span class="keyword">return</span> Chain(<span class="string">&#x27;%s/%s&#x27;</span> % (self._path, path))</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._path</span><br><span class="line">    </span><br><span class="line">    __repr__ = __str__</span><br></pre></td></tr></table></figure><p>这样我你们进行如下调用时，就能自由的获取各式各样的链接：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; Chain().status.user.timeline.list</span><br><span class="line"><span class="string">&#x27;/status/user/timeline/list&#x27;</span></span><br></pre></td></tr></table></figure><p>每次访问未定义参数时，都会调用对象的<code>__getattr__</code>方法，在此方法内，我们使用传入对象的<code>_path</code>以及传入的参数创建一个<code>Chain</code>对象，并返回，这样就能与后面属性调用组合，形成链式调用。</p><h4 id="call"><a href="#call" class="headerlink" title="__call__"></a><code>__call__</code></h4><hr><p>当我们需要直接对实例进行函数调用时，就会调用<code>__call__</code>函数：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;My name is %s.&#x27;</span> % self.name)</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = Student(<span class="string">&#x27;Michael&#x27;</span>)</span><br><span class="line">&gt;&gt;&gt; s() <span class="comment"># self参数不要传入</span></span><br><span class="line">My name is Michael.</span><br></pre></td></tr></table></figure><p>有了这个参数，那么完全可以把对象看成函数，把函数看成对象。</p><p>此处补充一个区分对象与函数的方法：<code>Callable</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; callable(Student())</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; callable(max)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; callable([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; callable(None)</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; callable(<span class="string">&#x27;str&#x27;</span>)</span><br><span class="line">False</span><br></pre></td></tr></table></figure><p>可见，函数即“可调用”对象。</p><p>有时我们会看到一些将参数放入URL中的REST API，比如GitHub的API：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get /users/:user/repos</span><br></pre></td></tr></table></figure><p>调用时，我们需要把<code>:user</code>替代为实际用户名，我们需要写出如下调用式：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Chain().users(<span class="string">&#x27;michael&#x27;</span>).repos</span><br></pre></td></tr></table></figure><p>此时在之前的链式调用的基础上，我们看到中间多出来一个类似函数调用的形式，因此我们需要将其中一环变成可调用对象，就需要用到我们的<code>__call__</code>，我们可以这样实现：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Chain</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, path=<span class="string">&#x27;&#x27;</span></span>):</span></span><br><span class="line">        self._path = path</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span>(<span class="params">self, path</span>):</span></span><br><span class="line">        <span class="keyword">return</span> Chain(<span class="string">&#x27;%s/%s&#x27;</span> % (self._path, path))</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._path</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self, users</span>):</span></span><br><span class="line">        <span class="keyword">return</span> Chain(<span class="string">&#x27;%s/%s&#x27;</span> % (self.path, users))</span><br><span class="line">    </span><br><span class="line">    __repr__ = __str__</span><br></pre></td></tr></table></figure><p>这样最外层的<code>Chain()</code>创建了一个对象，访问<code>users</code>属性，由于不存在该属性，进入<code>__getattr__</code>方法，并返回一个新的对象，该对象与之后的<code>(&#39;michael&#39;)</code>构成函数调用，于是调用该对象的<code>__call__</code>方法，再次返回一个新对象，最后与<code>repos</code>构成访问属性。最终完成链式调用。</p><h3 id="枚举类型"><a href="#枚举类型" class="headerlink" title="枚举类型"></a>枚举类型</h3><hr><p>与java一样，python也提供枚举类型。</p><p>引入<code>enum</code>类后即可创建：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</span><br><span class="line"></span><br><span class="line">Month = Enum(<span class="string">&#x27;Month&#x27;</span>, (<span class="string">&#x27;Jan&#x27;</span>, <span class="string">&#x27;Feb&#x27;</span>, <span class="string">&#x27;Mar&#x27;</span>, <span class="string">&#x27;Apr&#x27;</span>, <span class="string">&#x27;May&#x27;</span>, <span class="string">&#x27;Jun&#x27;</span>, <span class="string">&#x27;Jul&#x27;</span>, <span class="string">&#x27;Aug&#x27;</span>, <span class="string">&#x27;Sep&#x27;</span>, <span class="string">&#x27;Oct&#x27;</span>, <span class="string">&#x27;Nov&#x27;</span>, <span class="string">&#x27;Dec&#x27;</span>))</span><br></pre></td></tr></table></figure><p>这样我们就可以这样访问：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> name,member <span class="keyword">in</span> Month.__members__.items():</span><br><span class="line">    print(name, <span class="string">&#x27;=&gt;&#x27;</span>, member, <span class="string">&#x27;,&#x27;</span>, member.value)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Jan =&gt; Month.Jan , 1</span></span><br><span class="line"><span class="comment"># Feb =&gt; Month.Feb , 2</span></span><br><span class="line"><span class="comment"># Mar =&gt; Month.Mar , 3</span></span><br><span class="line"><span class="comment"># Apr =&gt; Month.Apr , 4</span></span><br><span class="line"><span class="comment"># May =&gt; Month.May , 5</span></span><br><span class="line"><span class="comment"># Jun =&gt; Month.Jun , 6</span></span><br><span class="line"><span class="comment"># Jul =&gt; Month.Jul , 7</span></span><br><span class="line"><span class="comment"># Aug =&gt; Month.Aug , 8</span></span><br><span class="line"><span class="comment"># Sep =&gt; Month.Sep , 9</span></span><br><span class="line"><span class="comment"># Oct =&gt; Month.Oct , 10</span></span><br><span class="line"><span class="comment"># Nov =&gt; Month.Nov , 11</span></span><br><span class="line"><span class="comment"># Dec =&gt; Month.Dec , 12</span></span><br></pre></td></tr></table></figure><p>其中<code>__members__</code>是Month中的一个特殊属性，该属性的类型是<code>mappingproxy</code>，具有如下特性：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 不可变映射类型,(字典)MappingProxyType</span></span><br><span class="line">   </span><br><span class="line"><span class="comment"># python3.3开始,types模块中引入了一个封装类名叫MappingProxyType</span></span><br><span class="line"><span class="comment"># 如果给这个类一个映射,它会返回一个只对映射视图.</span></span><br><span class="line"><span class="comment"># 虽然是个只读的视图,但是它是动态的,这意味着如果对原映射做出了改动,</span></span><br><span class="line"><span class="comment"># 我们可以通过这个视图观察到,但是无法通过这个视图对原映射做出修改</span></span><br><span class="line">   </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">#示例</span></span><br><span class="line"><span class="keyword">from</span> types <span class="keyword">import</span> MappingProxyType</span><br><span class="line"><span class="comment">#创建一个集合</span></span><br><span class="line">index_a = &#123;<span class="string">&#x27;a&#x27;</span> : <span class="string">&#x27;b&#x27;</span>&#125;</span><br><span class="line"><span class="comment">#创建index_a的映射视图</span></span><br><span class="line">a_proxy = MappingProxyType(index_a)</span><br><span class="line">print(a_proxy)</span><br><span class="line">a_proxy[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line"><span class="comment"># #不能对a_proxy视图进行修改</span></span><br><span class="line"><span class="comment"># a_proxy[&#x27;b&#x27;] = &#x27;bb&#x27;</span></span><br><span class="line"><span class="comment">#但是可以对原映射进行修改</span></span><br><span class="line">index_a[<span class="string">&#x27;b&#x27;</span>] = <span class="string">&#x27;bb&#x27;</span></span><br><span class="line">print(a_proxy)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># &#123;&#x27;a&#x27;: &#x27;b&#x27;&#125;</span></span><br><span class="line"><span class="comment"># &#123;&#x27;a&#x27;: &#x27;b&#x27;, &#x27;b&#x27;: &#x27;bb&#x27;&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果需要更精确的控制枚举类型，可以用一个派生自<code>Enum</code>的自定义类创建：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> enum <span class="keyword">import</span> Enum</span><br><span class="line"></span><br><span class="line"><span class="meta">@unique</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Weekday</span>(<span class="params">Enum</span>):</span></span><br><span class="line">    sun = <span class="number">0</span></span><br><span class="line">    Mon = <span class="number">1</span></span><br><span class="line">    Tue = <span class="number">2</span></span><br><span class="line">    Wed = <span class="number">3</span></span><br><span class="line">    Thu = <span class="number">4</span></span><br><span class="line">    Fri = <span class="number">5</span></span><br><span class="line">    Sat = <span class="number">6</span></span><br></pre></td></tr></table></figure><p>其中装饰器<code>@unique</code>用以检查并保证没有重复值</p><p>这样创建的枚举类型可以用如下方式访问：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; day1 = Weekday.Mon</span><br><span class="line">&gt;&gt;&gt; print(day1)</span><br><span class="line">Weekday.Mon</span><br><span class="line">&gt;&gt;&gt; print(Weekday.Tue)</span><br><span class="line">Weekday.Tue</span><br><span class="line">&gt;&gt;&gt; print(Weekday[<span class="string">&#x27;Tue&#x27;</span>])</span><br><span class="line">Weekday.Tue</span><br><span class="line">&gt;&gt;&gt; print(Weekday.Tue.value)</span><br><span class="line"><span class="number">2</span></span><br><span class="line">&gt;&gt;&gt; print(day1 == Weekday.Mon)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; print(day1 == Weekday.Tue)</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; print(Weekday(<span class="number">1</span>))</span><br><span class="line">Weekday.Mon</span><br><span class="line">&gt;&gt;&gt; print(day1 == Weekday(<span class="number">1</span>))</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; Weekday(<span class="number">7</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">...</span><br><span class="line">ValueError: <span class="number">7</span> is not a valid Weekday</span><br><span class="line">&gt;&gt;&gt; <span class="keyword">for</span> name, member <span class="keyword">in</span> Weekday.__members__.items():</span><br><span class="line">...     print(name, <span class="string">&#x27;=&gt;&#x27;</span>, member)</span><br><span class="line">...</span><br><span class="line">Sun =&gt; Weekday.Sun</span><br><span class="line">Mon =&gt; Weekday.Mon</span><br><span class="line">Tue =&gt; Weekday.Tue</span><br><span class="line">Wed =&gt; Weekday.Wed</span><br><span class="line">Thu =&gt; Weekday.Thu</span><br><span class="line">Fri =&gt; Weekday.Fri</span><br><span class="line">Sat =&gt; Weekday.Sat</span><br></pre></td></tr></table></figure><h3 id="元类"><a href="#元类" class="headerlink" title="元类"></a>元类</h3><hr><p>动态语言与静态语言的差别在于函数于类的定义，动态语言并不是在编译时创建类，而是在运行时创建类。比如如下类的创建：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hello</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">self, name=<span class="string">&#x27;world&#x27;</span></span>):</span></span><br><span class="line">        print(<span class="string">&#x27;Hello. %s.&#x27;</span> % name)</span><br></pre></td></tr></table></figure><p>我们可以将该类写到一个模块<code>hello.py</code>，再通过另一个模块来引入该模块，查看类创建的效果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hello <span class="keyword">import</span> Hello</span><br><span class="line"></span><br><span class="line">h = Hellp()</span><br><span class="line">h.hello()</span><br><span class="line">print(<span class="built_in">type</span>(Hello))</span><br><span class="line">print(<span class="built_in">type</span>(h))</span><br></pre></td></tr></table></figure><p>引入模块时，python解释器就会依次执行模块中的所有语句，执行<code>hello.py</code>的结果就是创建了一个<code>Hello</code>对象。为什么说是对象呢。<code>Hello</code>明明是类啊。Python中，万物接对象，包括我们创建的类。我们创建的类，实际上也是<code>type</code>类的一个对象。</p><p>从上例的输出结果可以看出：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello, world.</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">type</span>&#x27;&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> &#x27;<span class="title">hello</span>.<span class="title">Hello</span>&#x27;&gt;</span></span><br></pre></td></tr></table></figure><p><code>Hello</code>是一个class，它的类型就是<code>type</code>，而<code>h</code>是一个实例，它的类型就是class <code>Hello</code>。</p><p><code>type()</code>函数出了可以看到对象的类型外，还可以用于动态的创建类：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>(<span class="params">self, name = <span class="string">&#x27;world&#x27;</span></span>):</span></span><br><span class="line">    print(<span class="string">&#x27;Hello, %s.&#x27;</span> % name)</span><br><span class="line"></span><br><span class="line">Hello = <span class="built_in">type</span>(<span class="string">&#x27;Hello&#x27;</span>, (<span class="built_in">object</span>,), <span class="built_in">dict</span>(hello = fn))</span><br><span class="line">h = Hello()</span><br><span class="line">h.hello()</span><br><span class="line">print(<span class="built_in">type</span>(Hello))</span><br><span class="line">print(<span class="built_in">type</span>(h))</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello, world.</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">type</span>&#x27;&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> &#x27;<span class="title">hello</span>.<span class="title">Hello</span>&#x27;&gt;</span></span><br></pre></td></tr></table></figure><p>利用<code>type()</code>动态的创建类时，需要提供三个参数：</p><ol><li>class的名称。</li><li>继承的父类集合，需要传入tuple，注意tuple的单元素写法。</li><li>class的方法名称于函数进行绑定，此处将方法<code>fn</code>绑定到<code>hello</code>上</li></ol><p>通过<code>type()</code>函数创建的类和直接写class是完全一样的，因为Python解释器遇到class定义时，仅仅是扫描一下class定义的语法，然后调用<code>type()</code>函数创建出class。</p><p>可见，在动态操作类这件事上，动态语言比如python比静态语言，比如java方便很多。</p><p>除了使用type外，还能使用<code>metaclass</code>对类的创建进行控制</p><h4 id="metaclass"><a href="#metaclass" class="headerlink" title="metaclass"></a>metaclass</h4><hr><p><code>metaclass</code>直译为原类。</p><p>实例的创建可由类控制，那么类的创建则是由元类进行控制。</p><p>下面引用一个例子：</p><p>定义一个<code>metaclass</code>可以给我们自定义的<code>MyList</code>增加一个<code>add</code>方法：</p><p>定义<code>ListMetaclass</code>，按照默认习惯，<code>metaclass</code>的类名总是以<code>Metaclass</code>结尾，以便清楚地表示这是一个<code>metaclass</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># metaclass是类的模板，所以必须从`type`类型派生：</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListMetaclass</span>(<span class="params"><span class="built_in">type</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls, name, bases, attrs</span>):</span></span><br><span class="line">        attrs[<span class="string">&#x27;add&#x27;</span>] = <span class="keyword">lambda</span> self, value: self.append(value)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">type</span>.__new__(cls, name, bases, attrs)</span><br></pre></td></tr></table></figure><p>接下来我们利用这个原类，来创建我们自己的<code>list</code>类：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyList</span>(<span class="params"><span class="built_in">list</span>, metaclass = ListMetaclass</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>此时，在定义类时，我们指定使用<code>ListMetaclass</code>来定制类，传入关键字参数<code>metaclass</code></p><p>此后，Python解释器在创建<code>MyList</code>时，要通过<code>ListMetaclass.__new__()</code>来创建，在此，我们可以修改类的定义，比如，加上新的方法，然后，返回修改后的定义。</p><p><code>__new__()</code>方法接收到的参数依次是：</p><ol><li>当前准备创建的类的对象</li><li>类的名字</li><li>类继承的父类集合</li><li>类方法集合</li></ol><p>下面我们试着创建一个<code>MyList</code>对象：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; L = MyList()</span><br><span class="line">&gt;&gt;&gt; L.add(<span class="number">1</span>)</span><br><span class="line">&gt;&gt; L</span><br><span class="line">[<span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>普通的<code>list</code>并没有<code>add()</code>方法。</p><p>动态的修改类的定义将在编写ORM中起到非常大的作用。</p><p><code>ORM</code>——‘Object Relational Mapping’，即对象——关系映射。也即是将数据库中的一个表于一个类对应，一行与一个对象对应。</p><p>我们尝试利用<code>metaclass</code>来实现ORM中的保存功能：</p><ol><li>编写底层模块的第一步，就是先把调用接口写出来。比如，使用者如果使用这个ORM框架，想定义一个<code>User</code>类来操作对应的数据库表<code>User</code>，我们期待他写出这样的代码：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>(<span class="params">Model</span>):</span></span><br><span class="line">    <span class="comment"># 定义类的属性到列的映射：</span></span><br><span class="line">    <span class="built_in">id</span> = IntegerField(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">    name = StringField(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    email = StringField(<span class="string">&#x27;email&#x27;</span>)</span><br><span class="line">    password = StringField(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个实例：</span></span><br><span class="line">u = User(<span class="built_in">id</span>=<span class="number">12345</span>, name=<span class="string">&#x27;Michael&#x27;</span>, email=<span class="string">&#x27;test@orm.org&#x27;</span>, password=<span class="string">&#x27;my-pwd&#x27;</span>)</span><br><span class="line"><span class="comment"># 保存到数据库：</span></span><br><span class="line">u.save()</span><br></pre></td></tr></table></figure><p>其中，父类<code>Model</code>和属性类型<code>StringField</code>、<code>IntegerField</code>是由ORM框架提供的，剩下的方法比如<code>save()</code>全部由父类<code>Model</code>自动完成。虽然<code>metaclass</code>的编写会比较复杂，但ORM的使用者用起来却异常简单。</p><ol start="2"><li>接下来我们实现<code>Field</code>类，负责保存数据库表的字段名和字段类型：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Field</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, column_type</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.column_type = column_type</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;%s:%s&gt;&#x27;</span> % (self.__class__.__name__, self.name)</span><br></pre></td></tr></table></figure><p>在此基础上，定义各种类型的子类：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StringField</span>(<span class="params">Field</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(StringField, self).__init__(name, <span class="string">&#x27;varchar(100)&#x27;</span>)  <span class="comment"># 调用父类的__init__方法</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntegerField</span>(<span class="params">Field</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(IntegerField, self).__init__(name, <span class="string">&#x27;bigint&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="3"><li>接下来编写<code>ModelMetaclass</code>：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ModelMetaclass</span>(<span class="params"><span class="built_in">type</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls, name, bases, attrs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> name==<span class="string">&#x27;Model&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">type</span>.__new__(cls, name, bases, attrs)</span><br><span class="line">        print(<span class="string">&#x27;Found model: %s&#x27;</span> % name)</span><br><span class="line">        mappings = <span class="built_in">dict</span>()</span><br><span class="line">        <span class="keyword">for</span> k, v <span class="keyword">in</span> attrs.items():</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(v, Field):</span><br><span class="line">                print(<span class="string">&#x27;Found mapping: %s ==&gt; %s&#x27;</span> % (k, v))</span><br><span class="line">                mappings[k] = v</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> mappings.keys():</span><br><span class="line">            attrs.pop(k)</span><br><span class="line">        attrs[<span class="string">&#x27;__mappings__&#x27;</span>] = mappings <span class="comment"># 保存属性和列的映射关系</span></span><br><span class="line">        attrs[<span class="string">&#x27;__table__&#x27;</span>] = name <span class="comment"># 假设表名和类名一致</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">type</span>.__new__(cls, name, bases, attrs)</span><br></pre></td></tr></table></figure><ol start="4"><li>使用元类<code>ModelMetaclass</code>创建基类<code>Model</code>：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model</span>(<span class="params"><span class="built_in">dict</span>, metaclass=ModelMetaclass</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, **kw</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(Model, self).__init__(**kw)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span>(<span class="params">self, key</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">return</span> self[key]</span><br><span class="line">        <span class="keyword">except</span> KeyError:</span><br><span class="line">            <span class="keyword">raise</span> AttributeError(<span class="string">r&quot;&#x27;Model&#x27; object has no attribute &#x27;%s&#x27;&quot;</span> % key)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setattr__</span>(<span class="params">self, key, value</span>):</span></span><br><span class="line">        self[key] = value</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save</span>(<span class="params">self</span>):</span></span><br><span class="line">        fields = []</span><br><span class="line">        params = []</span><br><span class="line">        args = []</span><br><span class="line">        <span class="keyword">for</span> k, v <span class="keyword">in</span> self.__mappings__.items():</span><br><span class="line">            fields.append(v.name)</span><br><span class="line">            params.append(<span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            args.append(<span class="built_in">getattr</span>(self, k, <span class="literal">None</span>))</span><br><span class="line">        sql = <span class="string">&#x27;insert into %s (%s) values (%s)&#x27;</span> % (self.__table__, <span class="string">&#x27;,&#x27;</span>.join(fields), <span class="string">&#x27;,&#x27;</span>.join(params))</span><br><span class="line">        print(<span class="string">&#x27;SQL: %s&#x27;</span> % sql)</span><br><span class="line">        print(<span class="string">&#x27;ARGS: %s&#x27;</span> % <span class="built_in">str</span>(args))</span><br></pre></td></tr></table></figure><p>当用户定义一个<code>class User(Model)</code>时，Python解释器首先在当前类<code>User</code>的定义中查找<code>metaclass</code>，如果没有找到，就继续在父类<code>Model</code>中查找<code>metaclass</code>，找到了，就使用<code>Model</code>中定义的<code>metaclass</code>的<code>ModelMetaclass</code>来创建<code>User</code>类，也就是说，<code>metaclass</code>可以隐式地继承到子类，但子类自己却感觉不到。</p><p>在<code>ModelMetaclass</code>中，一共做了几件事情：</p><ol><li>排除掉对<code>Model</code>类的修改；</li><li>在当前类（比如<code>User</code>）中查找定义的类的所有属性，如果找到一个Field属性，就把它保存到一个<code>__mappings__</code>的<code>dict</code>中，同时从类属性中删除该<code>Field</code>属性，否则，容易造成运行时错误（实例的属性会遮盖类的同名属性）；</li><li>把表名保存到<code>__table__</code>中，这里简化为表名默认为类名。</li></ol><p>在<code>Model</code>类中，就可以定义各种操作数据库的方法，比如<code>save()</code>，<code>delete()</code>，<code>find()</code>，<code>update</code>等等。</p><p>使用如下代码进行测试：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">u = User(<span class="built_in">id</span>=<span class="number">12345</span>, name=<span class="string">&#x27;Michael&#x27;</span>, email=<span class="string">&#x27;test@orm.org&#x27;</span>, password=<span class="string">&#x27;my-pwd&#x27;</span>)</span><br><span class="line">u.save()</span><br></pre></td></tr></table></figure><p>输出如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Found model: User</span><br><span class="line">Found mapping: email &#x3D;&#x3D;&gt; &lt;StringField:email&gt;</span><br><span class="line">Found mapping: password &#x3D;&#x3D;&gt; &lt;StringField:password&gt;</span><br><span class="line">Found mapping: id &#x3D;&#x3D;&gt; &lt;IntegerField:uid&gt;</span><br><span class="line">Found mapping: name &#x3D;&#x3D;&gt; &lt;StringField:username&gt;</span><br><span class="line">SQL: insert into User (password,email,username,id) values (?,?,?,?)</span><br><span class="line">ARGS: [&#39;my-pwd&#39;, &#39;test@orm.org&#39;, &#39;Michael&#39;, 12345]</span><br></pre></td></tr></table></figure><p>这样一来我们就能直接得到对应操作的<code>SQL</code>语句，允许即可。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;python学习笔记，面对对象部分&lt;/p&gt;</summary>
    
    
    
    <category term="机器学习" scheme="http://enderxiao.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="计算机语言" scheme="http://enderxiao.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AF%AD%E8%A8%80/"/>
    
    <category term="研究生课程基础" scheme="http://enderxiao.top/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E8%AF%BE%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    <category term="Python" scheme="http://enderxiao.top/categories/Python/"/>
    
    
    <category term="机器学习" scheme="http://enderxiao.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="python" scheme="http://enderxiao.top/tags/python/"/>
    
    <category term="函数式编程" scheme="http://enderxiao.top/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"/>
    
    <category term="进阶" scheme="http://enderxiao.top/tags/%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title>python基础</title>
    <link href="http://enderxiao.top/Python/python%E5%9F%BA%E7%A1%80/"/>
    <id>http://enderxiao.top/Python/python%E5%9F%BA%E7%A1%80/</id>
    <published>2021-07-14T03:20:18.000Z</published>
    <updated>2021-08-06T09:30:50.045Z</updated>
    
    <content type="html"><![CDATA[<p>python学习笔记，基础语法部分</p><a id="more"></a><h1 id="Python基础"><a href="#Python基础" class="headerlink" title="Python基础"></a>Python基础</h1><h2 id="Into"><a href="#Into" class="headerlink" title="Into"></a>Into</h2><p>2021年5月，我收到了来自北京工业大学的调档函，这也许意味着我研究生生活的开始。研究生最终选择了机器学习相关的方向，并且得知导师所在实验室的方向是手写体识别。</p><p>说到Machine Learning，据说大多数人使用Python进行其相关的学习与发开，Python其实之前有接触过，并且使用pyGame复刻了一版2048，可以在我的GitHub上看到：</p><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/EnderXiao/py2048"><img src="https://github-readme-stats.vercel.app/api/pin/?username=EnderXiao&repo=py2048&theme=calm&show_owner=true" class="lazyload placeholder" data-srcset="https://github-readme-stats.vercel.app/api/pin/?username=EnderXiao&repo=py2048&theme=calm&show_owner=true" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></a><p>这大概是我大一的时候写的项目了，之后比赛以及训练时都是使用自己更为熟悉的C++，因此Python逐渐变得生疏，于是就有了这篇博客。MPGA就一定会实现！</p><p>Make Python Great Again！</p><hr><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.liaoxuefeng.com/wiki/1016959663602400">Python教程</a></p><h2 id="Get-Ready！"><a href="#Get-Ready！" class="headerlink" title="Get Ready！"></a>Get Ready！</h2><p>使用一门语言进行开发的第一步，大概是环境搭建吧。</p><p>搭建环境的方法有多种，最方便的大概使用windows的命令行，输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python</span><br></pre></td></tr></table></figure><p>如果你的电脑上尚未配置python的环境，windows自动为您打开windows引用商店，点击安装后，将自动为您修改环境变量。</p><p>此时如果再次输入python，即可编写脚本。</p><img src="https://i.postimg.cc/pVcVDKdh/Untitled.png" class="lazyload placeholder" data-srcset="https://i.postimg.cc/pVcVDKdh/Untitled.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="Python%20564b04e5895e443e982a45f45f1c78ee/Untitled.png"  /><hr><h2 id="Coding-Now！"><a href="#Coding-Now！" class="headerlink" title="Coding Now！"></a>Coding Now！</h2><p>环境搭建完成后，就该选择编辑器了，可以使用Jet Brain旗下的PyCharm，非常好用，但由于之前使用VS code进行前端开发，为了避免不必要的存储空间占用，我选择对VS Code进行一些配置，使它能够进行python开发。</p><p>首先进入python官网下载安装好VS Code，下载地址：</p><p><a href="https://code.visualstudio.com/">Visual Studio Code - Code Editing. Redefined</a></p><p>然后，为了使VSCode更适合于python开发，我们可以利用一款名为python的插件改造我们的编辑器。</p><p><img src="https://upload-images.jianshu.io/upload_images/5792949-8a2465cfedc2530a.gif" class="lazyload placeholder" data-srcset="https://upload-images.jianshu.io/upload_images/5792949-8a2465cfedc2530a.gif" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="https://upload-images.jianshu.io/upload_images/5792949-8a2465cfedc2530a.gif"></p><p>然后，新建一个文件夹作为工作区，为该工作区单独配置工作环境，通过一些必要的设置，我们将得到一个方便且强大的python编辑器。</p><p>接下来就能愉快的coding了</p><h2 id="Python数据类型"><a href="#Python数据类型" class="headerlink" title="Python数据类型"></a>Python数据类型</h2><h3 id="数字"><a href="#数字" class="headerlink" title="数字"></a>数字</h3><hr><ul><li>整数</li></ul><p>python整数的表达相对自由，支持以下形式：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">100</span> <span class="comment">#普通整数</span></span><br><span class="line">b = <span class="number">0xf</span> <span class="comment">#0x前缀表示16进制数</span></span><br><span class="line">c = <span class="number">100_00_00</span> <span class="comment">#可以使用分隔符表示较长的整数</span></span><br></pre></td></tr></table></figure><ul><li>浮点数</li></ul><p>python中浮点数可以使用如下形式表示：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1.5</span> <span class="comment">#普通浮点数</span></span><br><span class="line">b = <span class="number">1.2e8</span> <span class="comment">#科学计数法</span></span><br></pre></td></tr></table></figure><h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><hr><p>python中表示字符串，可以使用单引号<code>&#39;</code>或双引号<code>&quot;</code>。</p><p>如果使用<code>&quot;</code>包裹，则<code>&#39;</code>不需要进行转译：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;I&#x27;m Iron Man&quot;</span></span><br></pre></td></tr></table></figure><p>此外python还支持如下方法，使字符串全部不转译：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">r&quot;\\\\t\\\\&quot;</span> <span class="comment">#此行代码将输出\\\\t\\\\</span></span><br></pre></td></tr></table></figure><p>使用<code>&#39;&#39;&#39;@&#39;&#39;&#39;</code>可以输出多行内容</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">&#x27;&#x27;&#x27;I&#x27;m</span></span><br><span class="line"><span class="string">    the</span></span><br><span class="line"><span class="string">    iron</span></span><br><span class="line"><span class="string">    man&#x27;&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#该代码将输出：</span></span><br><span class="line"><span class="comment"># I&#x27;m</span></span><br><span class="line"><span class="comment"># the</span></span><br><span class="line"><span class="comment"># iron</span></span><br><span class="line"><span class="comment"># man</span></span><br></pre></td></tr></table></figure><p>但需要注意，python中的缩进将会被包含在内，如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    a = <span class="string">&#x27;&#x27;&#x27;I&#x27;m</span></span><br><span class="line"><span class="string">    the</span></span><br><span class="line"><span class="string">    iron</span></span><br><span class="line"><span class="string">    man&#x27;&#x27;&#x27;</span></span><br><span class="line">    print(a)</span><br><span class="line"><span class="comment">#该代码将输出</span></span><br><span class="line"><span class="comment"># I&#x27;m</span></span><br><span class="line">    <span class="comment"># the</span></span><br><span class="line">    <span class="comment"># iron</span></span><br><span class="line">    <span class="comment"># man</span></span><br></pre></td></tr></table></figure><h3 id="布尔值"><a href="#布尔值" class="headerlink" title="布尔值"></a>布尔值</h3><hr><p>python中也存在bool变量，python中使用<code>True</code>和<code>False</code>（区分大小写）表示。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="literal">True</span></span><br></pre></td></tr></table></figure><p>bool运算符使用如下方式表示</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="literal">True</span> <span class="keyword">and</span> Falseb = <span class="literal">True</span> <span class="keyword">or</span> Falsec = <span class="keyword">not</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure><h3 id="字符串-1"><a href="#字符串-1" class="headerlink" title="字符串"></a>字符串</h3><hr><ul><li>字符串编码</li></ul><p>最开始美国人生产计算机时只考虑了美式字符和英文字母，于是创造了只有127个字符转化的<code>ASCII</code></p><p>后来中国人为了适配自己的语言，创造了GB2312</p><p>日本人将日语编入<code>Shift_JIS</code>，韩国人将韩语编入<code>Euc-kr</code></p><p>这些操作都导致字符的编码系统及其复杂。于是<code>Unicode</code>诞生了，Unicode编码具有以下特征：</p><ol><li>将所有语言的字符进行整合</li><li>无论语言，通常每个字符占用2个字节，生僻字符将占用4字节</li></ol><p>但这样又会导致新的问题，ascii中英文字符占用一个字节，但用了unicode将占用两个，这导致了传输时的带宽浪费，因此又出现了UTF-8编码。UTF-8具有如下特点：</p><ol><li>采用不定长编码，常用字母占1字节，中文3字节，生僻字符占4-6字节。</li><li>兼容ASCII</li></ol><p>计算机内存中为了方便操作与管理，通常采用定长的编码方式，如windows采用的UTF-16就是Unicode的一种，而当对文件进行持久化操作时，通常会为了节约空间而使用变长编码，如UTF-8。</p><p><img src="https://i.postimg.cc/sxLVsCL9/Untitled-1.png" class="lazyload placeholder" data-srcset="https://i.postimg.cc/sxLVsCL9/Untitled-1.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="Python%20564b04e5895e443e982a45f45f1c78ee/Untitled%201.png"></p><p>同样的事也发生在网络上，为了节省带宽传输时，以及网页在显示时直接使用类似UTF-8的变长编码，而服务端则使用Unicode编码以便于管理</p><p><img src="https://i.postimg.cc/262k9ZFt/Untitled-2.png" class="lazyload placeholder" data-srcset="https://i.postimg.cc/262k9ZFt/Untitled-2.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="Python%20564b04e5895e443e982a45f45f1c78ee/Untitled%202.png"></p><ul><li>python中的字符串</li></ul><p>在python3中，字符使用Unicode编码，可以使用如下方式使字符串及其编码进行互转，<code>ord</code>和<code>chr</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line"><span class="comment"># 输出a为65</span></span><br><span class="line">b = <span class="built_in">ord</span>(<span class="string">&#x27;中&#x27;</span>)</span><br><span class="line"><span class="comment"># 输出b为20013</span></span><br><span class="line">c = <span class="built_in">chr</span>(<span class="number">66</span>) </span><br><span class="line"><span class="comment"># 输出c为&#x27;B&#x27;</span></span><br><span class="line">d = <span class="built_in">chr</span>(<span class="number">25991</span>) </span><br><span class="line"><span class="comment"># 输出d为&#x27;文&#x27;</span></span><br></pre></td></tr></table></figure><p>还可以直接使用编码来表示字符：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">&#x27;\u4e2d\u6587&#x27;</span>) <span class="comment"># 输出&#x27;中文&#x27;</span></span><br></pre></td></tr></table></figure><p>pyton中的str如果需要在网络上传播或保存到磁盘上，就需要使用如下操作把str变为以字节为单位的<code>bytes</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">b&#x27;ABC&#x27;</span> <span class="comment"># 此时每个字符将只占用一个字节</span></span><br></pre></td></tr></table></figure><p>以Unicode表示的字符也可通过<code>encode()</code>方法编码为指定的<code>bytes</code>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">&#x27;ABC&#x27;</span>.encode(<span class="string">&#x27;ascii&#x27;</span>)) </span><br><span class="line"><span class="comment"># 输出b&#x27;ABC&#x27;</span></span><br><span class="line">print(<span class="string">&#x27;中文&#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="comment"># 输出b&#x27;\xe4\xb8\xad\xe6\x96\x87&#x27;</span></span><br><span class="line">print(<span class="string">&#x27;中文&#x27;</span>.encode(<span class="string">&#x27;ascii&#x27;</span>)) </span><br><span class="line"><span class="comment"># 由于使用了不支持中文的编码方式编码，本次操作将报如下异常：</span></span><br><span class="line"><span class="comment"># UnicodeEncodeError# &#x27;ascii&#x27; codec can&#x27;t encode characters in position 0-1: ordinal not in range(128)</span></span><br></pre></td></tr></table></figure><p>如果从网络或者磁盘上读出了字节流<code>bytes</code>也可以使用<code>decode()</code>将其转化为str</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">b&#x27;ABC&#x27;</span>.decode(<span class="string">&#x27;ascii&#x27;</span>)) </span><br><span class="line"><span class="comment"># 将输出&#x27;ABC&#x27;</span></span><br><span class="line">print(<span class="string">b&#x27;\xe4\xb8\xad\xe6\x96\x87&#x27;</span>.decode(<span class="string">&#x27;utf-8&#x27;</span>)) </span><br><span class="line"><span class="comment"># 输出为&#x27;中文&#x27;</span></span><br><span class="line">print(<span class="string">b&#x27;\xe4\xb8\xad\xff&#x27;</span>.decode(<span class="string">&#x27;utf-8&#x27;</span>)) </span><br><span class="line"><span class="comment"># 将会报如下异常</span></span><br><span class="line"><span class="comment"># Traceback (most recent call last):</span></span><br><span class="line"><span class="comment">#   ...</span></span><br><span class="line"><span class="comment"># UnicodeDecodeError: &#x27;utf-8&#x27; codec can&#x27;t decode byte 0xff in position 3: invalid start byte</span></span><br></pre></td></tr></table></figure><p>如果<code>bytes</code>中只有一小部分无效的字节，可以传入<code>errors=&#39;ignore&#39;</code>忽略错误的字节：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">b&#x27;\xe4\xb8\xad\xff&#x27;</span>.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)) </span><br><span class="line"><span class="comment"># 输出&#x27;中&#x27;，utf-8无法编码的字符将被忽略</span></span><br></pre></td></tr></table></figure><p>此外，对于字符串，还可以使用<code>len()</code>方法获取字符串的长度：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">len</span>(<span class="string">&#x27;ABC&#x27;</span>) </span><br><span class="line"><span class="comment"># 输出3，由于每个字符只占1个，因此使用len得到的就是字符串的长度</span></span><br><span class="line"><span class="built_in">len</span>(<span class="string">&#x27;中文&#x27;</span>) </span><br><span class="line"><span class="comment"># 输出2</span></span><br><span class="line"><span class="built_in">len</span>(<span class="string">b&#x27;\xe4\xb8\xad\xe6\x96\x87&#x27;</span>)</span><br><span class="line"><span class="comment"># 输出6，为占用字节长度</span></span><br></pre></td></tr></table></figure><p>通常对于python文件而言，会使用如下两行注释来指定编码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br></pre></td></tr></table></figure><p>第一行注释是为了告诉Linux/OS X系统，这是一个Python可执行程序，Windows系统会忽略这个注释；</p><p>第二行注释是为了告诉Python解释器，按照UTF-8编码读取源代码，否则，你在源代码中写的中文输出可能会有乱码。</p><ul><li>python字符串格式化</li></ul><p>python字符串支持使用如下方式进行格式化：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">&#x27;Hello, %s&#x27;</span> % <span class="string">&#x27;world&#x27;</span>) </span><br><span class="line"><span class="comment"># %号后的值将会一次按类型进行替换，且无论什么类型，%s都能起作用</span></span><br><span class="line">print(<span class="string">&#x27;Hi, %s, you have $%d.&#x27;</span> % (<span class="string">&#x27;Michael&#x27;</span>, <span class="number">1000000</span>))</span><br></pre></td></tr></table></figure><p>此外还可以使用<code>format()</code>进行格式化：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;Hello, &#123;0&#125;, 成绩提升了 &#123;1:.1f&#125;%&#x27;</span>.<span class="built_in">format</span>(<span class="string">&#x27;小明&#x27;</span>, <span class="number">17.125</span>)</span><br></pre></td></tr></table></figure><p>此外，python还支持一种格式化字符串<code>f-string</code>，该字符串中的{xxx}，将会被对应变量替换：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r = <span class="number">2.5</span>s = <span class="number">3.14</span> * r ** <span class="number">2</span></span><br><span class="line">print(<span class="string">f&#x27;The area of a circle with radius <span class="subst">&#123;r&#125;</span> is <span class="subst">&#123;s:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># The area of a circle with radius 2.5 is 19.62</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>占位符</th><th>替换内容</th></tr></thead><tbody><tr><td>%d</td><td>整数</td></tr><tr><td>%f</td><td>浮点数</td></tr><tr><td>%s</td><td>字符串</td></tr><tr><td>%x</td><td>十六进制整数</td></tr></tbody></table><h3 id="空值"><a href="#空值" class="headerlink" title="空值"></a>空值</h3><hr><p>Python中使用None表示空值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="literal">None</span></span><br></pre></td></tr></table></figure><h3 id="动态语言"><a href="#动态语言" class="headerlink" title="动态语言"></a>动态语言</h3><hr><p>python属于动态语言，赋值时不需要指定变量类型</p><p>比如，进行值交换时可以使用如下方式：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">10</span></span><br><span class="line">b = <span class="number">100</span></span><br><span class="line">a, b = b, a</span><br><span class="line"><span class="comment">#此处a的值为100，b为10</span></span><br></pre></td></tr></table></figure><h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><hr><p>python中通常用全大写的变量名来表示常量，如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PI = <span class="number">3.14159265359</span></span><br></pre></td></tr></table></figure><p>但是这并不意味着PI这个量就是一个无法给便的值了，只是习惯上认为这是一个常量，PI仍然是一个变量且他的值仍然能被改变。</p><h3 id="除法"><a href="#除法" class="headerlink" title="除法"></a>除法</h3><hr><p>在python中，除法有两种，分别是<code>/</code>和<code>//</code>使用区别如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">9</span>/<span class="number">3</span> </span><br><span class="line"><span class="comment"># 此时a的值为3.0，为浮点型</span></span><br><span class="line">b = <span class="number">9</span>//<span class="number">3</span> </span><br><span class="line"><span class="comment"># 此时b的值为3，为整型</span></span><br><span class="line">c = <span class="number">8</span>/<span class="number">3</span></span><br><span class="line"><span class="comment"># 此时c的值为2.6666666665，为浮点型</span></span><br><span class="line">d = <span class="number">8</span>//<span class="number">3</span> </span><br><span class="line"><span class="comment"># 此时d的值为2，为整型</span></span><br></pre></td></tr></table></figure><h3 id="List"><a href="#List" class="headerlink" title="List"></a>List</h3><hr><p>Python中的<code>list</code>为一种有序集，具有如下特定：</p><ol><li>支持增删</li><li>支持随机访问</li><li>下标从0开始</li><li>下标为-x时表示从后向前数的索引</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">classmates = [<span class="string">&#x27;Michael&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Tracy&#x27;</span>]</span><br><span class="line"><span class="built_in">len</span>(classmates) </span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line">classmates[<span class="number">0</span>] </span><br><span class="line"><span class="comment"># Michael</span></span><br><span class="line">classmates[-<span class="number">1</span>] </span><br><span class="line"><span class="comment"># Tracy</span></span><br><span class="line">classmates[-<span class="number">2</span>] </span><br><span class="line"><span class="comment"># Bob</span></span><br></pre></td></tr></table></figure><ul><li>插入</li></ul><p>python支持两种插入方式，分别是<code>append</code>和<code>insert</code>,前者将直接在末尾进行插入，后者支持指定位置插入：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">classmates.append(<span class="string">&#x27;Adam&#x27;</span>)</span><br><span class="line">classmates.insert(<span class="number">1</span>,<span class="string">&#x27;jack&#x27;</span>)</span><br><span class="line"><span class="comment"># 结果：[&#x27;Michael&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;, &#x27;Adam&#x27;]</span></span><br><span class="line"><span class="comment"># 结果：[&#x27;Michael&#x27;, &#x27;Jack&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;, &#x27;Adam&#x27;]</span></span><br></pre></td></tr></table></figure><ul><li>删除</li></ul><p>list支持使用<code>pop</code>方法进行删除：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">classmates.pop()</span><br><span class="line"><span class="comment"># 删除末尾元素，即Adam将被删除</span></span><br><span class="line"><span class="comment"># [&#x27;Michael&#x27;, &#x27;Jack&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;]</span></span><br><span class="line">classmates.pop(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 删除第2个元素，即jack将被删除</span></span><br><span class="line"><span class="comment"># [&#x27;Michael&#x27;, &#x27;Bob&#x27;, &#x27;Tracy&#x27;]</span></span><br></pre></td></tr></table></figure><ul><li>修改</li></ul><p>通过重新赋值的方式即可对list中指定位置的元素进行修改：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">classmates[<span class="number">1</span>] = <span class="string">&#x27;Sarah&#x27;</span></span><br><span class="line"><span class="comment"># [&#x27;Michael&#x27;, &#x27;Sarah&#x27;, &#x27;Tracy&#x27;]</span></span><br></pre></td></tr></table></figure><ul><li>特性</li></ul><p>list允许存放不同类型的元素，如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">l = [<span class="string">&#x27;apple&#x27;</span>,<span class="number">123</span>,<span class="literal">True</span>]</span><br></pre></td></tr></table></figure><p>并且允许list嵌套：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="string">&#x27;python&#x27;</span>,<span class="string">&#x27;java&#x27;</span>,[<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;css&#x27;</span>],<span class="string">&#x27;c++&#x27;</span>]</span><br></pre></td></tr></table></figure><p>并且使用<code>len</code>方法求长度时会得到第一层list中的元素个数：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">len</span>(s) = <span class="number">4</span></span><br></pre></td></tr></table></figure><p>以此方式可以进行任意层数的嵌套</p><h3 id="tuple"><a href="#tuple" class="headerlink" title="tuple"></a>tuple</h3><hr><p>元组，另一种形式的有序表，具有如下特征：</p><ol><li>不支持增删改操作</li><li>允许定义空元组</li><li>允许随机访问</li><li>必要时使用tuple代替list可以保护</li><li>tuple，list可以相互嵌套</li></ol><ul><li>定义</li></ul><p>定义tuple时，使用<code>()</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">t = (<span class="number">1</span>,<span class="number">2</span>) </span><br><span class="line"><span class="comment"># 定义了一个包含两个元素的tuple</span></span><br></pre></td></tr></table></figure><p>但当定义只有一个元素的tuple时，需要注意避免如下歧义：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">t = (<span class="number">1</span>) </span><br><span class="line"><span class="comment"># 这样定义的t将会被解释为一个number类型，因为此处定义tuple的()与数学()产生了歧义，解释器优先将其解释为数学()</span></span><br><span class="line">t = (<span class="number">1</span>,) </span><br><span class="line"><span class="comment"># 此时t才会被正确的解释为一个tuple</span></span><br></pre></td></tr></table></figure><ul><li>“可变”tuple</li></ul><p>使用list与tuple的嵌套可以使tuple变得部分可变：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">t = (<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>])</span><br><span class="line">t[<span class="number">2</span>][<span class="number">0</span>] = <span class="string">&#x27;X&#x27;</span></span><br><span class="line">t[<span class="number">2</span>][<span class="number">1</span>] = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">print(r) </span><br><span class="line"><span class="comment"># 将会输出(&#x27;a&#x27;,&#x27;b&#x27;,[&#x27;X&#x27;,&#x27;Y&#x27;])</span></span><br><span class="line">print(<span class="built_in">len</span>(t))</span><br><span class="line"><span class="comment"># 将输出3，因为[&#x27;A&#x27;,&#x27;B&#x27;]，在t对应的内存中指保存有一个指向[&#x27;A&#x27;,&#x27;B&#x27;]所存在的地址的指针</span></span><br></pre></td></tr></table></figure><p>具体情况如下图所示</p><p>![Python%20564b04e5895e443e982a45f45f1c78ee/Untitled%203.png](E:/work/Python 564b04e5895e443e982a45f45f1c78ee/Untitled 3.png)</p><h2 id="Python条件语句"><a href="#Python条件语句" class="headerlink" title="Python条件语句"></a>Python条件语句</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> &lt;条件判断<span class="number">1</span>&gt;:    </span><br><span class="line">    &lt;执行<span class="number">1</span>&gt;</span><br><span class="line">    <span class="keyword">elif</span> &lt;条件判断<span class="number">2</span>&gt;:   </span><br><span class="line">        &lt;执行<span class="number">2</span>&gt;</span><br><span class="line">        <span class="keyword">elif</span> &lt;条件判断<span class="number">3</span>&gt;:    </span><br><span class="line">            &lt;执行<span class="number">3</span>&gt;</span><br><span class="line">            <span class="keyword">else</span>:    </span><br><span class="line">                &lt;执行<span class="number">4</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="Python循环语句"><a href="#Python循环语句" class="headerlink" title="Python循环语句"></a>Python循环语句</h2><h3 id="for"><a href="#for" class="headerlink" title="for"></a>for</h3><hr><p>Python允许使用<code>for...in</code>语句对有序表进行遍历：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 外部定义的list</span></span><br><span class="line">names = [<span class="string">&#x27;Michael&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Tracy&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> names:</span><br><span class="line">    print(name)</span><br><span class="line"><span class="comment"># 内部定义的list</span></span><br><span class="line"><span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]:    </span><br><span class="line">    <span class="built_in">sum</span> = <span class="built_in">sum</span> + xprint(<span class="built_in">sum</span>)</span><br></pre></td></tr></table></figure><p>此外对连续自然数进行便利还能直接使用<code>range()</code>，注意该函数从0开始</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">5</span>))</span><br><span class="line"><span class="comment"># [0, 1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure><h3 id="while"><a href="#while" class="headerlink" title="while"></a>while</h3><hr><p>Python中同样允许在循环中使用continue以及break</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> n &lt; <span class="number">10</span>:    </span><br><span class="line">    n = n + <span class="number">1</span>    </span><br><span class="line">    <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">0</span>: </span><br><span class="line">        <span class="comment"># 如果n是偶数，执行continue语句        </span></span><br><span class="line">        <span class="keyword">continue</span> </span><br><span class="line">        <span class="comment"># continue语句会直接继续下一轮循环，后续的print()语句不会执行 </span></span><br><span class="line">        print(n)</span><br></pre></td></tr></table></figure><h2 id="特殊数据结构"><a href="#特殊数据结构" class="headerlink" title="特殊数据结构"></a>特殊数据结构</h2><hr><h3 id="dict"><a href="#dict" class="headerlink" title="dict"></a>dict</h3><hr><p>dict是python中的一种类似map结构，每个元素由一对{key,value}组成，使用方法与map类似：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;<span class="string">&#x27;Michael&#x27;</span>: <span class="number">95</span>, <span class="string">&#x27;Bob&#x27;</span>: <span class="number">75</span>, <span class="string">&#x27;Tracy&#x27;</span>: <span class="number">85</span>&#125; </span><br><span class="line"><span class="comment">#在定义时赋值</span></span><br><span class="line">d[<span class="string">&#x27;Jack&#x27;</span>] = <span class="number">20</span> </span><br><span class="line"><span class="comment">#向dict中添加值</span></span><br></pre></td></tr></table></figure><p>存储同样的数据，用dict实现时的查找效率往往比用list实现更高效，原因如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对于存储上例中的数据，使用list实现时往往需要这样实现</span></span><br><span class="line">l = [ <span class="string">&#x27;Michael&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Tracy&#x27;</span> ]</span><br><span class="line">s = [ <span class="number">95</span>, <span class="number">75</span>, <span class="number">85</span> ]</span><br><span class="line"><span class="comment"># 对于此例，要查找Tracy的年龄时，需要做如下操作：</span></span><br><span class="line"><span class="comment"># 1. 先顺序查找list l，得到存有Tracy值的空间的下标，平均复杂度为O(n)</span></span><br><span class="line"><span class="comment"># 2. 再通过1操作得到的下标index，访问s[index]，得到85，平均复杂度为O(1)</span></span><br><span class="line"><span class="comment"># 如果使用dict实现，访问过程如下</span></span><br><span class="line">d = &#123;<span class="string">&#x27;Michael&#x27;</span>: <span class="number">95</span>, <span class="string">&#x27;Bob&#x27;</span>: <span class="number">75</span>, <span class="string">&#x27;Tracy&#x27;</span>: <span class="number">85</span>&#125;</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;Tracy&#x27;</span> <span class="keyword">in</span> d:</span><br><span class="line">    d[<span class="string">&#x27;Tracy&#x27;</span>]</span><br><span class="line"><span class="comment"># 上述过程的执行速度非常快，往往可以达到O(1)</span></span><br></pre></td></tr></table></figure><p>为什么dict的查找速度如此之快呢，这就需要了解dict的底层实现了。</p><ol><li><p>python3.6及以下使用普通的hash方式实现dict，即对key值进行hash，将key与value存储到hash对应的位置中去。也就意味着使用这样的简单hash方法会导致数据结构无序（unordered）；并且，为了保证尽量少的hash冲突发生，往往剩余空间小于当前总容量大1/3时，就会对dict进行扩容，这就导致随着存储内容的增多，dict可能逐渐变得稀疏，造成空间的浪费</p></li><li><p>python3.7对hash结构进行了改进，首先python会维护一张由list实现的index表，indices，这种表用来存放下标映射关系，也就是，对于存放第一组数据，进行如下操作：</p><ol><li>计算出key 的下标值index = getIndex( hash(key) )</li><li>indices[index] = 0</li><li>Entities[0] = {key,value,hash(key)}</li></ol><p>这样做有什么好处呢，</p><p>首先，真正存放数据的Entities中存放的数据是顺序且连续的；</p><p>其次，这样存储，indices是稀疏的，但其中仅仅存放一个表示下标的数字，消耗的空间大大减小。</p><p>查找过程如下：</p><ol><li>首先通过hash函数得到indices中的下标，index = getIndex( hash(key) )</li><li>访问Entities[index]得到数据。</li></ol><p>这样做，每次查找需要多查一次，但多出来的查找时间复杂对为O(1)，时间开销的增加并不明显。</p></li></ol><p>更详细的内容可以参考下面的博客：</p><p><a href="https://blog.csdn.net/weixin_43064185/article/details/107565845?ivk_sa=1024320u"></a></p><p>可见，dict的查找效率只与hash函数有关，与存储的容量没有直接关系。</p><p>dict还支持有如下操作：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.get(<span class="string">&#x27;Bob&#x27;</span>) <span class="comment"># 获取d中key为Bob的值，如果没有，返回None，输出到控制台时表现为什么都没有d.get(&#x27;FK&#x27;,-1) # 获取d中key为FK的值，如果没有返回-1d.pop(&#x27;Jack&#x27;) # 删除d中key为Jack的值（包括key），并返回该值&#x27;Jack&#x27; in d # 如果key为Jack的值包含在d中，返回True，否则返回False</span></span><br></pre></td></tr></table></figure><p>由于dict中的key需要进行hash变换，这就要求了dict中存放的key必须是<code>可hash的</code>，也就是说必须是确定的值，比如数字，字符串，自定义类，而可变的list则无法作为key。</p><p>为什么str是不可变对象呢：</p><p>对于这样的操作：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&#x27;abc&#x27;</span>b = a.replace(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;A&#x27;</span>)print(a)print(b)<span class="comment"># 对于a而言，进行a.replace(&#x27;a&#x27;,&#x27;A&#x27;)操作后，a中保存的值并没有变。</span></span><br></pre></td></tr></table></figure><p>对于第一条赋值语句而言，变量a可以理解为只是指向’abc’的指针，而真正的字符串对象则是’abc’本身。</p><p>也就是说不变对象调用自身的任意方法，都不会对自身造成改变，而是创建新的对象并返回。</p><h3 id="set"><a href="#set" class="headerlink" title="set"></a>set</h3><hr><p>python中的set同STL中的set，也可以理解为只有key的dict，因为底层逻辑是一样的，都是进行hash，只不过set是指用hash来保证不会有同样的元素被添加，定义set时需要使用一个list来创建。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="built_in">set</span>([ <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>]) <span class="comment"># 将得到一个set，内容为[1,2,3,4]</span></span><br></pre></td></tr></table></figure><p>注意set是无序的，使用set()去重时很可能得到不一样顺序的结果，主要原因是set存储是利用hash进行的，次序根据hash的值而定。但有时对纯数字的list进行set创建操作可能会得到有序的结果，原因可能是某些解释器的hash函数对数字进行hash时，得到的就是该数字。</p><p>set还包含如下操作：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.add(<span class="number">2</span>) <span class="comment"># 向s中加入一个值为2的元素，如果重复，则结果不会改变s.remove(2) # 从s中删除值为2的元素</span></span><br></pre></td></tr></table></figure><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><hr><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><hr><p>python使用如下方式进行函数的定义：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">functionName</span>(<span class="params">param</span>):</span></span><br><span class="line">    <span class="comment">#function body</span></span><br><span class="line">    <span class="keyword">return</span> value1, value2 </span><br><span class="line"><span class="comment">#缺省状态下返回None，还能写作return None或return</span></span><br></pre></td></tr></table></figure><p>python中函数再返回多个值的时候，会将返回值用tuple封装，而多个变量可以同时接受一个tuple，因此下面的写法被认为是正确的：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">move</span>(<span class="params">x, y, step, angle=<span class="number">0</span></span>):</span>    </span><br><span class="line">    nx = x + step * math.cos(angle)    </span><br><span class="line">    ny = y - step * math.sin(angle)    </span><br><span class="line">    <span class="keyword">return</span> nx, ny</span><br><span class="line">x,y = move(<span class="number">100</span>, <span class="number">100</span>, <span class="number">60</span>, math.pi / <span class="number">6</span>)</span><br></pre></td></tr></table></figure><h3 id="空函数"><a href="#空函数" class="headerlink" title="空函数"></a>空函数</h3><hr><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">emptyFunction</span>(<span class="params">param</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><hr><p>python中的函数支持许多定义函数参数的方法，包括如下几种：</p><ul><li>位置参数</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">function</span>(<span class="params">param</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><ul><li>含有默认值的参数</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">function</span>(<span class="params">param = <span class="string">&#x27;default value&#x27;</span></span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># python会将实参和形参进行顺序匹配，对于未匹配到的形参，python将为其赋值为设定的默认值</span></span><br></pre></td></tr></table></figure><p>但是，需要注意的是，如果将参数的默认值设为可变对象，那么会出现一些问题，比如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span>(<span class="params">l = []</span>):</span></span><br><span class="line">    l.append(<span class="string">&#x27;End&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> l</span><br><span class="line">print(fun([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]))</span><br><span class="line">print(fun())</span><br><span class="line">print(fun([<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]))</span><br><span class="line">print(fun())</span><br><span class="line">print(fun())</span><br><span class="line"><span class="comment"># [1, 2, 3, &#x27;End&#x27;]</span></span><br><span class="line"><span class="comment"># [&#x27;End&#x27;]</span></span><br><span class="line"><span class="comment"># [5, 6, 7, &#x27;End&#x27;]</span></span><br><span class="line"><span class="comment"># [&#x27;End&#x27;, &#x27;End&#x27;]</span></span><br><span class="line"><span class="comment"># [&#x27;End&#x27;, &#x27;End&#x27;, &#x27;End&#x27;]</span></span><br></pre></td></tr></table></figure><p>注意到我调用了三次使用默认参数的fun，但是，函数好像有记忆一样，后两次fun使用的默认对象与上一次使用的是同一个！这显然是反直觉的，原因是python会在内存中开辟一块空间来存放参数的默认对象，为了节约空间，每当某个参数适用默认对象时，python只需要将其指向默认对象存放的空间就行了。但是如果默认对象使用可变对象，那么可能会存在某些操作，是的内存中的可变对象发生改变，导致每次赋予的默认值都不一样。</p><p>因此使用默认值有如下规则：</p><div class="note danger"><p>使用带有默认值的参数时，尽量将默认值设置为不变参数</p></div><p>但是如果一定要让某个函数的默认值为某个可变对象，使用<code>None</code>是最安全便捷的方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span>(<span class="params">l = <span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> l <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        l = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">    l.append(<span class="string">&#x27;End&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>有时我们可能还想让间隔开的两个参数使用默认值，但由于python默认值检测是顺序的，考虑到这一点，python提供了如下方法来避免歧义：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span>(<span class="params">a=<span class="number">1</span>, b=<span class="number">2</span>, c=<span class="number">3</span>, d=<span class="number">4</span></span>):</span></span><br><span class="line">    <span class="built_in">sum</span> = a + b + c + d</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line">fun(a = <span class="number">10</span>,d = <span class="number">40</span>) </span><br><span class="line"><span class="comment"># 此时只有形参a和b将使用指定的实参，b和c将使用默认值</span></span><br></pre></td></tr></table></figure><ul><li>可变参数</li></ul><p>有时候我们可能无法确认传入参数的数量，为此，python提供了可变参数，此法允许我们传入任意数量的参数。当然用tuple或者set作为参数同样可以实现类似的功能，但是可变参数省去了创建set或tuple的操作，并且当传入参数为空时，不像set或tuple一样需要判空。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">function</span>(<span class="params">*param</span>):</span></span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> param:</span><br><span class="line">        <span class="built_in">sum</span> += i</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line">print(function())</span><br><span class="line">print(function(<span class="number">1</span>))</span><br><span class="line">print(function(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line">print(function(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line"><span class="comment"># 结果如下</span></span><br><span class="line"><span class="comment"># 0</span></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line"><span class="comment"># 6</span></span><br></pre></td></tr></table></figure><p>但当我们需要传入tuple或者set时，传入的tuple或set会和参数构成一个二维结构：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">function</span>(<span class="params">*param</span>):</span></span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> param:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">            print(j)</span><br><span class="line">function([<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line"><span class="comment"># 结果如下</span></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># 2</span></span><br></pre></td></tr></table></figure><p>为了避免这种情况，python允许使用如下方式来避免歧义：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">function</span>(<span class="params">*param</span>):</span></span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> param:</span><br><span class="line">        print(i)</span><br><span class="line">function([<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line"><span class="comment"># 结果如下</span></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line">function(*[<span class="number">1</span>,<span class="number">2</span>]) </span><br><span class="line"><span class="comment"># 在tuple或set前加*会告诉python这个实参用来满足某个可变形参</span></span><br></pre></td></tr></table></figure><ul><li>关键字参数</li></ul><p>改参数允许传入0个或任意个含参数名的参数，这些参数再函数内部自动组装为dict，定义时使用<code>**</code>加以区分：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person</span>(<span class="params">name, age, **kw</span>):</span>   </span><br><span class="line">    print(<span class="string">&#x27;name:&#x27;</span>, name, <span class="string">&#x27;age:&#x27;</span>, age, <span class="string">&#x27;other:&#x27;</span>, kw)</span><br><span class="line">person(<span class="string">&#x27;Jacky&#x27;</span>, <span class="number">30</span>) </span><br><span class="line"><span class="comment"># 输出为 name:Jacky age:30 other:&#123;&#125;</span></span><br><span class="line">person(<span class="string">&#x27;Bob&#x27;</span>, <span class="number">36</span>, gender = <span class="string">&#x27;M&#x27;</span>, city = <span class="string">&#x27;Beijing&#x27;</span>, job = <span class="string">&#x27;Engineer&#x27;</span>) </span><br><span class="line"><span class="comment">#输出为 name: Bob age: 36 other: &#123;&#x27;gender&#x27;:&#x27;M&#x27;,&#x27;city&#x27;: &#x27;Beijing&#x27;,&#x27;job&#x27;: &#x27;Engineer&#x27;&#125;</span></span><br></pre></td></tr></table></figure><p>关键字参数可以起到扩展函数功能的作用，比如在编写注册功能时。</p><p>还能自己组装dict后再传入：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">extra = &#123;<span class="string">&#x27;city&#x27;</span>: <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;job&#x27;</span>: <span class="string">&#x27;Engineer&#x27;</span>&#125;</span><br><span class="line">person(<span class="string">&#x27;Jack&#x27;</span>, <span class="number">24</span>, city=extra[<span class="string">&#x27;city&#x27;</span>], job=extra[<span class="string">&#x27;job&#x27;</span>])</span><br><span class="line">person(<span class="string">&#x27;Jack&#x27;</span>, <span class="number">24</span>, **extra)</span><br><span class="line"><span class="comment"># 输出如下</span></span><br><span class="line"><span class="comment"># name: Jack age: 24 other: &#123;&#x27;city&#x27;: &#x27;Beijing&#x27;, &#x27;job&#x27;: &#x27;Engineer&#x27;&#125;</span></span><br><span class="line"><span class="comment"># name: Jack age: 24 other: &#123;&#x27;city&#x27;: &#x27;Beijing&#x27;, &#x27;job&#x27;: &#x27;Engineer&#x27;&#125;</span></span><br></pre></td></tr></table></figure><p>此处<code>kw</code>获得的dict是<code>extra</code>的一份拷贝，对<code>kw</code>的改动不会影响<code>extra</code></p><ul><li>命名关键字参数</li></ul><p>关键字参数允许传入任意值，当我们需要限制关键字参数的名字时，可以使用命名关键字参数，如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person</span>(<span class="params">name, age, *, city, job</span>):</span>    </span><br><span class="line">    print(name, age, city, job)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">person(<span class="string">&#x27;Jack&#x27;</span>, <span class="number">24</span>, city=<span class="string">&#x27;Beijing&#x27;</span>, job=<span class="string">&#x27;Engineer&#x27;</span>)</span><br><span class="line"><span class="comment"># Jack 24 Beijing Engineer</span></span><br></pre></td></tr></table></figure><p><code>*</code>之后的参数被视为明面关键字参数</p><p>如果函数定义中已经有了一个可变参数，后面跟着的命名关键字参数就不再需要一个特殊分隔符<code>*</code>了：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person</span>(<span class="params">name, age, *args, city, job</span>):</span>    </span><br><span class="line">    print(name, age, args, city, job)</span><br></pre></td></tr></table></figure><p>命名关键字参数必须传入参数名，如果没有会报如下错：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">person(<span class="string">&#x27;Jack&#x27;</span>, <span class="number">24</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;Engineer&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Traceback (most recent call last):  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;TypeError: person() takes 2 positional arguments but 4 were given</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>次数由于没有指定参数名，python解释器认为调用时所提供的4个参数均为<code>position arguments</code>，即位置参数，而函数定义时只有2个位置参数。</p><p>命名关键字同样支持缺省值：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person</span>(<span class="params">name, age, *, city = <span class="string">&quot;Beijing&quot;</span>, job</span>):</span></span><br><span class="line">    print(name, age, city, job)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">person(<span class="string">&#x27;Jack&#x27;</span>, <span class="number">24</span> job = <span class="string">&quot;Engineer&quot;</span>)</span><br><span class="line"><span class="comment"># Jack 24 Beijing Engineer</span></span><br></pre></td></tr></table></figure><h3 id="参数顺序"><a href="#参数顺序" class="headerlink" title="参数顺序"></a>参数顺序</h3><hr><p>python中为了确保解释器对参数的解析正确，上述的5中参数需要按照一定顺序进行排列，即：</p><p>位置参数，默认参数，可变参数，命名关键字参数，关键字参数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1</span>(<span class="params">a, b, c = <span class="number">0</span>, *args, **kw</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;a=&#x27;</span>, a, <span class="string">&#x27;b=&#x27;</span>, b, <span class="string">&#x27;c=&#x27;</span>, c, <span class="string">&#x27;args=&#x27;</span>, args, <span class="string">&#x27;kw=&#x27;</span>, kw)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f2</span>(<span class="params">a, b, c = <span class="number">0</span>, *, d, **kw</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;a=&#x27;</span>, a, <span class="string">&#x27;b=&#x27;</span>, b, <span class="string">&#x27;c=&#x27;</span>, c, <span class="string">&#x27;d=&#x27;</span>, d, <span class="string">&#x27;kw=&#x27;</span>, kw)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">f1(<span class="number">1</span>,<span class="number">2</span>) </span><br><span class="line"><span class="comment"># a=1 b=2 c=0 args=() kw=&#123;&#125; </span></span><br><span class="line">f1(<span class="number">1</span>,<span class="number">2</span>,c = <span class="number">3</span>) </span><br><span class="line"><span class="comment"># a=1 b=2 c=3 args=() kw=&#123;&#125; </span></span><br><span class="line">f1(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"><span class="comment"># a=1 b=2 c=3 args=(&#x27;a&#x27;,&#x27;b&#x27;) kw=&#123;&#125;</span></span><br><span class="line">f1(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,x = <span class="number">99</span>) </span><br><span class="line"><span class="comment"># a=1 b=2 c=3 args=(&#x27;a&#x27;,&#x27;b&#x27;) kw=&#123;&#x27;x&#x27;:99&#125;</span></span><br><span class="line">f2(<span class="number">1</span>,<span class="number">2</span>,d = <span class="number">99</span>,ext = <span class="literal">None</span>) </span><br><span class="line"><span class="comment"># a=1 b=2 c=0 d=99 kw=&#123;&#x27;ext&#x27;:None&#125;</span></span><br></pre></td></tr></table></figure><p>除了上述方法以外，还可以使用一个<code>tuple</code>和一个<code>dict</code>调用上述函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">args = (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">kw = &#123;<span class="string">&#x27;d&#x27;</span>:<span class="number">99</span>, <span class="string">&#x27;x&#x27;</span>:<span class="string">&#x27;#&#x27;</span>&#125;</span><br><span class="line">f1(*args, **kw)</span><br><span class="line"><span class="comment"># a=1 b=2 c=3 args=(4,) </span></span><br><span class="line">kw=&#123;<span class="string">&#x27;d&#x27;</span>:<span class="number">99</span>, <span class="string">&#x27;x&#x27;</span>:<span class="string">&#x27;#&#x27;</span>&#125;</span><br><span class="line">args = (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">k2 = &#123;<span class="string">&#x27;d&#x27;</span>:<span class="number">88</span>, <span class="string">&#x27;x&#x27;</span>:<span class="string">&#x27;#&#x27;</span>&#125;</span><br><span class="line">f2(*args, **kw)</span><br><span class="line"><span class="comment"># a=1 b=2 c=3 d=88 k2=&#123;&#x27;x&#x27;:&#x27;#&#x27;&#125;</span></span><br></pre></td></tr></table></figure><p>虽然允许使用的参数组合有如此多种，但是使用过多的组合会导致函数接口的可读性下降</p><h3 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h3><hr><p>递归几乎是一门涉及到函数的语言必讲的内容，此处强调一下尾递归：</p><p><strong>尾递归</strong>：如果一个函数中所有<strong>递归形式的调用都出现在函数的末尾</strong>，我们称这个递归函数是尾递归的。当递归调用是整个函数体中最后执行的语句且它的返回值<strong>不属于表达式</strong>的一部分时，这个递归调用就是尾递归。</p><p>谈到递归，就不得不谈起另一个词：<strong>函数栈</strong></p><p>递归虽然具有优秀的易读性，但过多的递归调用会占用很大空间的函数栈。</p><p>而尾递归，或者说“伪递归”可以通过优化使其只占用常数级的栈空间。</p><p>递归的执行过程可以理解为由两部分组成：</p><ol><li>递归</li><li>回溯</li></ol><p>而尾递归能偶被优化的原因，就在于尾递归的回溯过程可以省略。</p><p>下面来看几个例子：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fact1</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> n * fact1(n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fact2</span>(<span class="params">n,res</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> fact2(n-<span class="number">1</span>,n * res)</span><br></pre></td></tr></table></figure><p>以上两个函数都能用来计算阶乘，但区别在于<code>fact1</code>中的回溯我们认为是有意义的，因为递归调用自身后，该层需要下一层递归返回的结果进行表达式运算$n*fact(n-1)$</p><p>而fact2中的当前层只是简单的对后一层结果进行返回。</p><p>因此这就意味着，我们不需要在进入下一层梦境之前，对当前层的“环境”进行保存。那么我们在函数栈中，便不需要为后一层开辟新的栈空间，而只是简单的让他覆盖掉当前层所在的栈帧。</p><p>此外，由于回溯时不需要做任何运算，只需要对结果进行保存，尾递归显然可以使用循环来代替。事实上，在一些没有循环结构的语言中，通常就是使用尾递归的方式来实现循环。</p><p>尾递归转化为循环的方法详见如下博客：</p><div class="tag link"><a class="link-card" title="尾递归为啥能优化？" href="https://zhuanlan.zhihu.com/p/36587160"><div class="left"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" class="lazyload placeholder" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text">尾递归为啥能优化？</p><p class="url">https://zhuanlan.zhihu.com/p/36587160</p></div></a></div><h2 id="Python高级特性"><a href="#Python高级特性" class="headerlink" title="Python高级特性"></a>Python高级特性</h2><hr><h3 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h3><hr><p>如果需要取一个list或tuple的某个片段，通常的做法是新建一个空list或tuple然后使用循环将其取出，但python提供了更方便的办法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">L = [<span class="string">&#x27;Michael&#x27;</span>, <span class="string">&#x27;Sarah&#x27;</span>, <span class="string">&#x27;Tracy&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Jack&#x27;</span>]L[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line"><span class="comment"># [&#x27;Michael&#x27;, &#x27;Sarah&#x27;, &#x27;Tracy&#x27;]</span></span><br><span class="line">L[:<span class="number">3</span>] </span><br><span class="line"><span class="comment"># [&#x27;Michael&#x27;, &#x27;Sarah&#x27;, &#x27;Tracy&#x27;]</span></span><br><span class="line">L[<span class="number">1</span>:<span class="number">3</span>] </span><br><span class="line"><span class="comment"># [&#x27;Sarah&#x27;, &#x27;Tracy&#x27;]</span></span><br><span class="line">L[-<span class="number">2</span>:] </span><br><span class="line"><span class="comment"># [&#x27;Bob&#x27;, &#x27;Jack&#x27;]</span></span><br><span class="line">L[-<span class="number">2</span>:-<span class="number">1</span>] </span><br><span class="line"><span class="comment"># [&#x27;Bob&#x27;]</span></span><br><span class="line">k = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">100</span>))</span><br><span class="line">K[:<span class="number">10</span>:<span class="number">2</span>] </span><br><span class="line"><span class="comment"># [0,2,3,5,8]</span></span><br><span class="line">K[::<span class="number">5</span>] </span><br><span class="line"><span class="comment"># [0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95]</span></span><br><span class="line">K[:] </span><br><span class="line"><span class="comment"># [0, 1, 2, 3, ..., 99]</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;ABCDEFG&quot;</span><span class="built_in">str</span>[::<span class="number">2</span>] </span><br><span class="line"><span class="comment"># &#x27;ACEG&#x27;</span></span><br></pre></td></tr></table></figure><p>python中切片操作提供了三个可选择参数：</p><div class="note info"><p>note info [起始位置:结束位置:取数间隔]</p></div><p>注意事项：</p><ol><li>其中取数是取到结束位置的前一个标号</li><li>起始位置默认为0</li><li>取数间隔是指每k个数取一个</li></ol><h3 id="迭代"><a href="#迭代" class="headerlink" title="迭代"></a>迭代</h3><hr><p>例如遍历一个list或tuple的过程我们可以称之为迭代。</p><p>python中的<code>for</code>具有很多特殊的操作。比如使用<code>for...in</code> 来完成C++11中加入的新特性来遍历数组或其他数据结构中的每一个元素</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//C++</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i:a)&#123;</span><br><span class="line">    <span class="comment">//body</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="comment">#body</span></span><br></pre></td></tr></table></figure><p>事实上python中的所有<code>可迭代对象</code>，都能通过<code>for...in</code>来遍历。比如<code>dict</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;b&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;c&#x27;</span>:<span class="number">3</span>&#125;<span class="keyword">for</span> key <span class="keyword">in</span> d:print(key)<span class="comment"># a# b# c</span></span><br></pre></td></tr></table></figure><p>由于<code>dict</code>的存储并不是按章顺序存储的，因此迭代顺序不一定是abc</p><p>默认情况下，dict迭代的是key</p><p>如果要迭代value，则需要使用：<code>for value in d.values()</code> ，如果需要同时迭代key和value，则需要使用如下方式：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> d.items():</span><br><span class="line">    print(k,v)</span><br></pre></td></tr></table></figure><p>那么我们该如何判断某对象是否输入可迭代对象呢？</p><p>需要通过如下方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections.abc <span class="keyword">import</span> Iterable</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">isinstance</span>(<span class="string">&#x27;abc&#x27;</span>, Iterable) <span class="comment"># True str可迭代</span></span><br><span class="line"><span class="built_in">isinstance</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], Iterable) <span class="comment"># True list可迭代</span></span><br><span class="line"><span class="built_in">isinstance</span>(<span class="number">123</span>, Iterable) <span class="comment"># False 整数不可迭代</span></span><br></pre></td></tr></table></figure><p>而当我们需要对某个list进行类似C中的下标迭代，可以使用<code>enumerate</code>关键字将list转化为索引-元素对</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i, value <span class="keyword">in</span> <span class="built_in">enumerate</span>([<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>]):</span><br><span class="line">    print(i, value)</span><br></pre></td></tr></table></figure><h3 id="列表生成"><a href="#列表生成" class="headerlink" title="列表生成"></a>列表生成</h3><hr><p>python提供了一种非常方便的列表生成方式：</p><div class="note info"><p>variable = [out_exp for out_exp in input_list if out_exp == 2]</p></div><p>如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[x * x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>) <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">0</span>]</span><br><span class="line"><span class="comment"># [4, 16, 36, 64, 100]</span></span><br></pre></td></tr></table></figure><p>此外还可以使用二重循坏：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[m + n <span class="keyword">for</span> m <span class="keyword">in</span> <span class="string">&#x27;ABC&#x27;</span> <span class="keyword">for</span> n <span class="keyword">in</span> <span class="string">&#x27;XYZ&#x27;</span>]</span><br><span class="line"><span class="comment"># [&#x27;AX&#x27;, &#x27;AY&#x27;, &#x27;AZ&#x27;, &#x27;BX&#x27;, &#x27;BY&#x27;, &#x27;BZ&#x27;, &#x27;CX&#x27;, &#x27;CY&#x27;, &#x27;CZ&#x27;]</span></span><br></pre></td></tr></table></figure><p>当我们使用<code>if</code>限制列表生成的元素时，<code>if...else</code>的使用需要特别注意：</p><ul><li>当if放在for后进行限定时，不能使用else</li><li>当if放在for前进行限定时，必须使用else</li></ul><p>这是因为for前面的部分是一个表达式，它必须根据x计算出一个结果。因此，考察表达式：x if x % 2 == 0，它无法根据x计算出结果，因为缺少else，必须加上else</p><p>例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[x <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">else</span> -x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>)]</span><br><span class="line"><span class="comment"># [-1, 2, -3, 4, -5, 6, -7, 8, -9, 10]</span></span><br></pre></td></tr></table></figure><h3 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h3><p>生成器也是一种可以用来生成列表的工具，他与生成式最大的不同在于：生成式是将列表中的所有元素提前计算好，而生成器则等到你需要时再计算当前位置的值。</p><p>简单生成器的创建较为简单，只需要将生成式的<code>[]</code>改为<code>()</code>即可：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>L = [x * x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>L</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>, <span class="number">36</span>, <span class="number">49</span>, <span class="number">64</span>, <span class="number">81</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>g = (x * x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>g</span><br><span class="line">&lt;generator <span class="built_in">object</span> &lt;genexpr&gt; at <span class="number">0x1022ef630</span>&gt;</span><br></pre></td></tr></table></figure><p>生成器可以使用如下两种方法访问：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">next</span>(g)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">next</span>(g)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">next</span>(g)</span><br><span class="line"><span class="number">4</span></span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt;<span class="built_in">next</span>(g)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">StopIteration</span><br><span class="line"><span class="comment"># 使用next访问到末尾时将抛出此异常</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#方法2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>g = (x * x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> n <span class="keyword">in</span> g:</span><br><span class="line"><span class="meta">... </span>    print(n)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">4</span></span><br><span class="line"><span class="string">9</span></span><br><span class="line"><span class="string">16</span></span><br><span class="line"><span class="string">25</span></span><br><span class="line"><span class="string">36</span></span><br><span class="line"><span class="string">49</span></span><br><span class="line"><span class="string">64</span></span><br><span class="line"><span class="string">81</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>此外，还能将函数改造为生成器，当函数中使用关键字<code>yield</code>，进行返回时，此为生成器的高级用法，比如使用生成器打印杨辉三角：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">triangles</span>():</span></span><br><span class="line">    l = [<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">yield</span> l[:] <span class="comment">#此处需要利用切片来为l创建副本</span></span><br><span class="line">        l.append(<span class="number">0</span>)</span><br><span class="line">        l = [l[i] + l[i - <span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(l))] <span class="comment"># 利用生成式简化循环操作</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line">results = []</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> fun():</span><br><span class="line">    results.append(t)</span><br><span class="line">    num = num + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(num &gt;= <span class="number">10</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> results:</span><br><span class="line">    print(t)</span><br></pre></td></tr></table></figure><blockquote><p>需要注意的是，python函数在返回可变对象时返回的是对象的地址</p></blockquote><p>此外，使用函数定义的生成器也能设置返回值，但需要通过捕捉<code>StopIteration</code>异常来查看返回值：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span>(<span class="params"><span class="built_in">max</span></span>):</span></span><br><span class="line">    n, a, b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> n &lt; <span class="built_in">max</span>:</span><br><span class="line">        <span class="keyword">yield</span> b</span><br><span class="line">        a, b = b, a + b</span><br><span class="line">        n = n + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;done&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">g = fib(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">     <span class="keyword">try</span>:</span><br><span class="line">        x = <span class="built_in">next</span>(g)</span><br><span class="line">        pint(<span class="string">&#x27;g:&#x27;</span>, x)</span><br><span class="line">     <span class="keyword">except</span> StopIteration <span class="keyword">as</span> e:</span><br><span class="line">         print(<span class="string">&#x27;Generator return value:&#x27;</span>, e.value)</span><br><span class="line">         <span class="keyword">break</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">g: 1</span></span><br><span class="line"><span class="string">g: 1</span></span><br><span class="line"><span class="string">g: 2</span></span><br><span class="line"><span class="string">g: 3</span></span><br><span class="line"><span class="string">g: 5</span></span><br><span class="line"><span class="string">g: 8</span></span><br><span class="line"><span class="string">Generator return value: done</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h3><p>迭代章节聊过可迭代对象：<code>Iterable</code></p><p>而迭代器，则是像生成器一样，不仅可以使用<code>for</code>遍历，还能被<code>next()</code>函数调用并不断返回下一个</p><p>可以使用如下方法进行判断：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections.abc <span class="keyword">import</span> Iterator</span><br><span class="line"></span><br><span class="line"><span class="built_in">isinstance</span>((x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)), Iterator)</span><br><span class="line"><span class="comment"># True</span></span><br><span class="line"><span class="built_in">isinstance</span>([], Iterator)</span><br><span class="line"><span class="comment"># False</span></span><br><span class="line"><span class="built_in">isinstance</span>(&#123;&#125;, Iterator)</span><br><span class="line"><span class="comment"># False</span></span><br><span class="line"><span class="built_in">isinstance</span>(<span class="string">&#x27;abc&#x27;</span>, Iterator)</span><br><span class="line"><span class="comment"># False</span></span><br></pre></td></tr></table></figure><p>此外还能用<code>iter()</code>方法把可迭代对象转化为迭代器：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">isinstance</span>(<span class="built_in">iter</span>([]), Iterator)</span><br><span class="line"><span class="comment"># True</span></span><br><span class="line"><span class="built_in">isinstance</span>(<span class="built_in">iter</span>(<span class="string">&#x27;abc&#x27;</span>), Iterator)</span><br><span class="line"><span class="comment"># True</span></span><br></pre></td></tr></table></figure><p>Python中的<code>Iterator</code>对象表示一个数据流。</p><p>即</p><ol><li>能作用与<code>for</code>循环的对象都是<code>Iterable</code>类型</li><li>能作用与<code>next()</code>函数的对象都是<code>Iterator</code>类型，它们表示一个惰性计算的序列</li></ol><p>事实上Python中的<code>for</code>本质上就是通过不断调用<code>next()</code>函数实现的。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;python学习笔记，基础语法部分&lt;/p&gt;</summary>
    
    
    
    <category term="机器学习" scheme="http://enderxiao.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="计算机语言" scheme="http://enderxiao.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AF%AD%E8%A8%80/"/>
    
    <category term="研究生课程基础" scheme="http://enderxiao.top/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E8%AF%BE%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    <category term="Python" scheme="http://enderxiao.top/categories/Python/"/>
    
    
    <category term="机器学习" scheme="http://enderxiao.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="python" scheme="http://enderxiao.top/tags/python/"/>
    
    <category term="基础" scheme="http://enderxiao.top/tags/%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>机器学习——入门</title>
    <link href="http://enderxiao.top/Machine-Learning/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%85%A5%E9%97%A8/"/>
    <id>http://enderxiao.top/Machine-Learning/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%85%A5%E9%97%A8/</id>
    <published>2021-04-02T03:01:41.000Z</published>
    <updated>2021-04-03T08:46:09.362Z</updated>
    
    <content type="html"><![CDATA[<h2 id="机器学习的定义"><a href="#机器学习的定义" class="headerlink" title="机器学习的定义"></a>机器学习的定义</h2><p>历史上主要有两位学者对机器学习进行过定义，反别是Arthur Samuel和Tom mitshell，下面分别给出介绍</p><h3 id="Arthur-Samuel"><a href="#Arthur-Samuel" class="headerlink" title="Arthur Samuel"></a>Arthur Samuel</h3><p>Arthur Samuel——编写世界上第一个棋类游戏人工智能程序</p><p>他对于机器学习的定义如下：</p><div class="note guide blue"><p>def： 机器学习是，赋予计算机学习能力，且该能力不是通过显著式编程获得</p></div><h4 id="非显著式编程"><a href="#非显著式编程" class="headerlink" title="非显著式编程"></a>非显著式编程</h4><p>让计算机自己总结规律的编程方法</p><h4 id="收益函数："><a href="#收益函数：" class="headerlink" title="收益函数："></a>收益函数：</h4><p>我们通常规定正在特定环境下，计算机做某些行为会带来某些收益，我们称它为<code>收益函数</code><br>在规定了行为和收益函数后，让计算机自己去找最大会收益函数的行为</p><h3 id="Tom-mitshell"><a href="#Tom-mitshell" class="headerlink" title="Tom mitshell"></a>Tom mitshell</h3><p>而Tom mitshell——在其书《Machine Learning》中对机器学习的定义为：</p><div class="note guide blue"><p>def： 机械学习，就是对于一个任务T，衡量完成T好换的性能指标P，以及计算机获得的经验E，计算机从经验E中学习，使得，计算机完成任务T的性能指标P逐步提升，即：计算机在T上的被P衡量的性能，会随着经验E的增加而提高</p></div><h2 id="机器学习任务的分类"><a href="#机器学习任务的分类" class="headerlink" title="机器学习任务的分类"></a>机器学习任务的分类</h2><h3 id="监督学习"><a href="#监督学习" class="headerlink" title="监督学习"></a>监督学习</h3><p>对于：</p><ol><li>垃圾邮件识别</li><li>人脸识别</li></ol><p>这类的机器学习任务，需要<code>为数据打标签</code>（Labeling for training data），才此情况下，经验E是是<code>训练样本</code>和<code>标签</code>的集合，由此我们可以得到监督学习的定义：</p><div class="note guide blue"><p>def： 所有经验E都是人工采集并输入计算机的，将这类输入计算机训练数据同时加上标签的机器学习称为监督学习(Supervised Learning)</p></div><p>在此类机器学习中，算法必须知道预测什么，即目标变量的分类信息</p><p>此外还能通过数据标签的存在与否对监督学习进行分类，分为：</p><ol><li>传统监督学习</li><li>半监督学习</li><li>非监督学习</li></ol><h4 id="传统监督学习"><a href="#传统监督学习" class="headerlink" title="传统监督学习"></a>传统监督学习</h4><div class="note guide blue"><p>def： 传统监督学习(Traditional Supervised Learning)中，每一个数据标签都有数据标签</p></div><p>传统学习中主要的算法有：</p><ol><li>支持向量机(Support Vector Machine)</li><li>人工神经网络(Neural Networks)</li><li>深度神经网络(Deep Neural Networks)</li></ol><h4 id="非监督学习"><a href="#非监督学习" class="headerlink" title="非监督学习"></a>非监督学习</h4><div class="note guide blue"><p>def： 如果所有的训练数据都没有对应的标签，则称为非监督学习(Unsupervised Learning)</p></div><p>非监督学习的数据中没有类别信息（标签），也不会给定目标值。在无监督学习中：</p><ol><li>将数据集合分成由了类似的对象组成的多个类的过程称为<code>聚类</code>；</li><li>将寻找描述数据统计值的过程称为<code>密度估计</code>;</li></ol><p>此外，非监督学习可以减少数据特征的维度，一遍我们可以使用二维或三维图形更直观的展示数据信息。</p><p>由定义，我们可能会产生一个问题，对于没有数据标签的数据，我们如何对数据进行分类。</p><p>对此我们需要做出如下假设：</p><ol><li>如果同一类的训练数据在空间中距离最近</li><li>根据样本空间中的空间信息</li><li>设计算法将它们聚集为两类</li></ol><p>从而实现无监督学习，其中主要算法包括：</p><ol><li>聚类(Clustering)</li><li>EM算法(Expectation-Maximization algorithm)</li><li>主成分分析(Principle Component Analysis)</li></ol><h4 id="半监督学习"><a href="#半监督学习" class="headerlink" title="半监督学习"></a>半监督学习</h4><div class="note guide blue"><p>def： 如果训练数据中一部分由标签一部分没有标签，称这种机器学习为<code>半监督学习(Semi-Supervised Learning)</code></p></div><p>为了节约为数据打标签的成本，由于半监督学习使用<code>少量的标注数据</code>与<code>大量未标注数据</code>进行训练的特性，近年半监督学习逐渐成为热点</p><h4 id="另一种分类方式"><a href="#另一种分类方式" class="headerlink" title="另一种分类方式"></a>另一种分类方式</h4><p>基于标签的固有属性，我们可以将监督学习分为：</p><ol><li>分类</li><li>回归</li></ol><h5 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h5><p>如果标签是<code>离散</code>的值，则将这种学习成为分类</p><p>如人脸识别算法，就是<code>分类</code>任务，如：</p><ol><li>给出两张人脸，判断是否为同一人，可以用0表示是，1表示否</li><li>从大量照片中，按照人脸将照片分类，则可以用$1,\dots,N$表示不同的人</li></ol><p>这些都是离散的值</p><h5 id="回归"><a href="#回归" class="headerlink" title="回归"></a>回归</h5><p>如果标签是<code>连续</code>的值，则将这种学习成为回归</p><p>例如设计算法预测房价的走势，标签为平均房价，训练样本为时间</p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>对于分类、回归、聚类、密度估计，在此将这些操作的相关算法以及能够解决的问题进行汇总</p><table><thead><tr><th>监督学习算法</th><th>算法用途</th></tr></thead><tbody><tr><td>k-近邻算法</td><td>线性回归</td></tr><tr><td>朴素贝叶斯算法</td><td>局部加权线性回归</td></tr><tr><td>支持向量机</td><td>Ridge回归</td></tr><tr><td>决策树</td><td>Lasso最小回归系数估计</td></tr></tbody></table><table><thead><tr><th>非监督学习算法</th><th>算法用途</th></tr></thead><tbody><tr><td>K-均值</td><td>最大期望算法</td></tr><tr><td>DBSCAN</td><td>Parzen窗设计</td></tr></tbody></table><h3 id="强化学习"><a href="#强化学习" class="headerlink" title="强化学习"></a>强化学习</h3><p>对于：</p><ol><li>下棋</li><li>自动驾驶</li></ol><p>这类机器学习任务，经验E是由计算机<code>与环境互动</code>获得的，我们只需要定义这些行为的<code>收益函数(Reward Function)</code>，对行为进行奖励和乘法，并且计算机能够根据这些奖励和乘法，改变自己的行为模式，从而<code>最大化收益函数</code></p><p>由此可以得到强化学习的定义：</p><p>计算机通过与环境的互动逐渐强化自己的行为模式的机器学习称为强化学习(Reinforcement Learning) </p><p>但对于AlphaGo而言，起初是通过监督学习，通过高手对局的视频，形成一个初始的围棋程序，在对该程序进行强化学习提成其性能。</p><h2 id="机器学习算法的过程"><a href="#机器学习算法的过程" class="headerlink" title="机器学习算法的过程"></a>机器学习算法的过程</h2><ol><li><p>特征提取(Feature Extraction)：</p><p>在这一步中会从样本中抽象出一些用于做分类的特征</p></li><li><p>特征选择(Feature Selection)</p><p>从1中抽象出的特征中分析，选出最能有效进行分类的特征，以此构建机器学习系统 </p></li><li><p>根据2中选出的特征构建特征空间(Feature Space)</p></li><li><p>选用不同的算法对特征空间进行划分</p><p>基于2中选择的特征构建算法</p></li></ol><blockquote><p>PS:</p><p>对于3中选择算法这一步，比如可以选择：</p><p>支持向量机(Support Vector Machine)，其中包含三种内核：</p><ol><li>线性内核</li><li>多项式核</li><li>高斯径向基函数核</li></ol></blockquote><p>再次列举一个构建特征空间的例子，特征空间可以按照特征的个数任意指定维数：</p><p><a href="https://postimg.cc/gX02mKM8"><img src="https://i.postimg.cc/MT7M0PVP/image.png" class="lazyload placeholder" data-srcset="https://i.postimg.cc/MT7M0PVP/image.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="image.png" style="zoom:150%;" /></a></p><p>在特征空间中包含的几个关键词：</p><ol><li><p>维度</p><p>人对于三维以上的事物缺乏想象力，但目前的机器学习算法可以较为精确的处理三维以上的数据</p></li><li><p>标准</p><p>使用不同的标准，对某一些区域的划分会有区别</p></li></ol><h2 id="没有免费午餐定理"><a href="#没有免费午餐定理" class="headerlink" title="没有免费午餐定理"></a>没有免费午餐定理</h2><div class="note guide cyan"><p>定理 4.1 1995年,D.H.Wolpert等人提出： No Free Lunch Theorem(没有免费午餐定理?) 任何一个预测函数，如果在一些训练样本上表现好，那么必然在另一些训练样本上表现不好，如果不对数据在特定空间的<code>先验分布</code>有一定假设，那么表现好与不好的情况将会一样多</p></div><p>因此没有任何情况下都最优的机器学习方法</p><p>对于NFL定理中提及的先验分布而言，我们可以用如下例子进行理解：</p><p><a href="https://postimg.cc/3y1xsqZ3"><img src="https://i.postimg.cc/sXdGhdQG/NFL.png" class="lazyload placeholder" data-srcset="https://i.postimg.cc/sXdGhdQG/NFL.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="NFL.png" style="zoom:150%;" /></a></p><p>其中<code>空间上距离接近的样本它们属于同一个类别的概论更高</code>就是一种先验分布，这就意味着机器学习算法是基于某些先验分布来进行预测的学科。</p><p>这就意味着在学习过程中，我们不能片面夸大某个定理的作用，要对开发新的算法保持探索的精神。</p><p><strong>此外该定理还提醒了我们机器学习的本质：基于有限的已知数据，在复杂的高维特征空间中预测未知样本的属性和类别</strong></p><h2 id="如何选用合适的算法"><a href="#如何选用合适的算法" class="headerlink" title="如何选用合适的算法"></a>如何选用合适的算法</h2><p>选用机器学习算法需要考虑以下几个问题：</p><ol><li>使用机器学习算法的目的</li><li>想要完成的任务</li><li>了解数据的特征</li></ol><ul><li>首先考虑机器学习<code>算法的目的</code>以及想要完成的<code>任务</code>：<ol><li>如果要预测目标变量的值，则可以选择监督学习算法；</li><li>否则可以选择无监督学习算法。</li><li>确定选择监督学习算法后，需要进一步明确目标变量的类型：<ol><li>如果目标变量是离散型，则可以选择分类算法；</li><li>如果是连续性，则可以使用回归算法</li></ol></li></ol></li><li>其次需要考虑实际的数据，应该充分了解数据，对数据了解的越充分，越容易创建符合实际需要的应用程序，主要应该了解数据的以下几个特征：<ol><li>特征值是<code>离散型</code>变量还是<code>连续型</code>变量</li><li>特征值中是否有<code>缺失的值</code>，何种<code>原因</code>造成</li><li>数据中是否有<code>异常值</code></li><li>某些特征发生的<code>频率</code>如何</li></ol></li><li>通过对数据的充分了解，可以帮助我们缩小算法的选择范围，而由NFL定理可以知道，一般并不存在最好的算法和可以给出最好效果的算法，一般发现最好算法的关键环节就是反复<code>调试</code>和<code>迭代</code></li></ul><h2 id="开发机器学习应用程序的步骤"><a href="#开发机器学习应用程序的步骤" class="headerlink" title="开发机器学习应用程序的步骤"></a>开发机器学习应用程序的步骤</h2><ol><li>收集数据：通过多种手段收集数据，比如<code>爬虫</code>等，也可以使用<code>开源数据源</code></li><li>准备输入数据：<ol><li>得到数据之后，还必须确保数据格式符合要求，使用<code>标准的数据格式</code>可以融合算法和数据源，方便匹配操作</li><li>还要为机器学习算法准备<code>特定的数据格式</code>，一般某些算法要求目标变量和特征值是字符串，而另一些算法要求是整型</li></ol></li><li>分析输入数据：主要是人工分析得到的数据，确保数据中没有<code>垃圾数据</code></li><li>训练算法：将前两步得到的格式化数据输入到算法，从中抽取信息</li><li>测试算法：<ol><li>对于监督学习，必须已知用于评估算法的目标变量值</li><li>对于非监督学习，也必须用其他评测手段来检验算法的成功率</li><li>如果不满意算法的输出结果，不改变算法的前提下，问题常常与数据的收集和准备有关</li></ol></li><li>使用算法：将机器学习算法转化为应用程序，执行实际任务，以检验上述步骤是否可以在实际环境中运行</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;机器学习的定义&quot;&gt;&lt;a href=&quot;#机器学习的定义&quot; class=&quot;headerlink&quot; title=&quot;机器学习的定义&quot;&gt;&lt;/a&gt;机器学习的定义&lt;/h2&gt;&lt;p&gt;历史上主要有两位学者对机器学习进行过定义，反别是Arthur Samuel和Tom mitshell</summary>
      
    
    
    
    <category term="Machine Learning" scheme="http://enderxiao.top/categories/Machine-Learning/"/>
    
    <category term="机器学习入门" scheme="http://enderxiao.top/categories/Machine-Learning/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/"/>
    
    
    <category term="Machine Learning" scheme="http://enderxiao.top/tags/Machine-Learning/"/>
    
  </entry>
  
  <entry>
    <title>离散数学-复合关系与逆关系</title>
    <link href="http://enderxiao.top/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/%E5%A4%8D%E8%AF%95/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6-%E5%A4%8D%E5%90%88%E5%85%B3%E7%B3%BB%E4%B8%8E%E9%80%86%E5%85%B3%E7%B3%BB/"/>
    <id>http://enderxiao.top/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/%E5%A4%8D%E8%AF%95/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6-%E5%A4%8D%E5%90%88%E5%85%B3%E7%B3%BB%E4%B8%8E%E9%80%86%E5%85%B3%E7%B3%BB/</id>
    <published>2021-03-14T13:50:48.000Z</published>
    <updated>2021-04-03T14:18:24.749Z</updated>
    
    <content type="html"><![CDATA[<h2 id="复合关系"><a href="#复合关系" class="headerlink" title="复合关系"></a>复合关系</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>设R是集合A到B的二元关系，S是集合B到C的二元关系，R和S的复合记作：$R \circ S$，它是集合A到C的二元关系，仅当$( a,b) \in R$且$(b,c) \in R$时，$(a,c) \in R \circ S$。</p><h3 id="复合关系的矩阵表示"><a href="#复合关系的矩阵表示" class="headerlink" title="复合关系的矩阵表示"></a>复合关系的矩阵表示</h3><h4 id="表示方法"><a href="#表示方法" class="headerlink" title="表示方法"></a>表示方法</h4><p>设$A = {a_1,a_2,a_3,…,a_n}, B = {b_1,b_2,b_3,…,b_m},C = {c_1,c_2,c_3,…,c_p}$,R时A到B的二元关系,R的关系矩阵为：<br>$$<br>M_R = \begin{bmatrix}<br>    x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1m} \\<br>    x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2m} \\<br>    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>    x_{n1} &amp; x_{n2} &amp; \cdots &amp; x_{nm} \\<br>\end{bmatrix}<br>$$</p><p>其中：<br>$$<br>x_{ij} =<br>\begin{cases}<br>    1 &amp; (a_i,b_j)\in R \\<br>    0 &amp; (a_i,b_j) \notin R<br>\end{cases}<br>$$</p><p>S是B到C的二元关系，S的关系矩阵为：<br>$$<br>M_s = \begin{bmatrix}<br>    y_{11} &amp; y_{12} &amp; \cdots &amp; y_{1p} \\<br>    y_{21} &amp; y_{22} &amp; \cdots &amp; y_{2p} \\<br>    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>    y_{m1} &amp; y_{m2} &amp; \cdots &amp; y_{mp} \\<br>\end{bmatrix}<br>$$<br>令$M_R\times M_S = [z_{ij}]$，即有：<br>$$<br>M_R \times M_S = \begin{bmatrix}<br>    z_{11} &amp; z_{12} &amp; \cdots &amp; z_{1p} \\<br>    z_{21} &amp; z_{22} &amp; \cdots &amp; z_{2p} \\<br>    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>    z_{n1} &amp; z_{n2} &amp; \cdots &amp; z_{np} \\<br>\end{bmatrix}<br>$$<br>由矩阵乘法规则的：<br>$$<br>z_{ij} = x_{i1}\times y_{1j} + x_{i2}\times y_{2j}+ \dots + x_{im} \times y_{mj} = \sum\limits_{k = 1}^m x_{ik} \times y_{kj}<br>$$</p><p>对于式中的$x_{ik}\times y_{ik}$，当且仅当，$x_{ik},y_{kj}$同时为1时，计算结果才为1。又由于只有当$(a_i,b_k) \in  R \and  (b_k,c_j)  \in  S$时，才有$x_{ik} \neq 0  \and   y_{kj}  \neq  0$，故，由复合运算的定义可得，此时的$R \circ S$中应该包含$(a_{i},c_{j})$，即$z_{ij} \neq 0$。</p><p>故以此法就能通过矩阵乘法去确定一个复合关系的关系矩阵，而在计算矩阵乘法的过程中，我们只关注$\sum\limits_{k = 1}^m x_{ik} \times y_{kj}$中是否有1出现，故我们可以将此处的加法替换为<code>布尔加</code>（即 0+0 = 0，1+0 = 0+1 = 1，1+1 = 1），这样在编程实现中，就能使用<code>与</code>运算来代替10进制的加法运算，众所周知，代码的世界里，位运算要比10进制运算来的快。</p><p>我们用$M_R \circ M_S$来表示使用<code>布尔加</code>的矩阵乘法，于是可以得到如下定理</p><div class="note guide cyan"><p>定理4.1：设R时A到B的二元关系，其关系矩阵为$M_R$，S时B到C的二元关系，其关系矩阵为$M_S$，则$M_{R \circ S} = M_R \circ M_S$</p></div><h3 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h3><p>复合关系具有如下特征：</p><ol><li>满足结合律</li><li>$R^i \circ R^j = R^{i+j}$（i,j为正整数）；$R^0$定义为${(a_1,b_1),(a_2,b_2),\dots ,(a_n,b_n)}$，即关系矩阵为单位矩阵</li></ol><h2 id="逆关系"><a href="#逆关系" class="headerlink" title="逆关系"></a>逆关系</h2><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p>设R是A到B的二元关系，如果把R中的每一个有序对中的元素顺序互换，所得B到A的二元关系称为R的逆关系，记作$R^{-1}$或$\tilde{R}$</p><h3 id="矩阵表示"><a href="#矩阵表示" class="headerlink" title="矩阵表示"></a>矩阵表示</h3><p>若二元关系R的的关系矩阵为$M _R$，则$M_R$的转置$M_{R}^T$，就是关系$R^{-1}$的关系矩阵</p><h3 id="特征-1"><a href="#特征-1" class="headerlink" title="特征"></a>特征</h3><p>有矩阵转置的运算规则可知：</p><p>$(A \times B)^T = B^T \times A^T$</p><p>由此可得以下定理</p><div class="note guide cyan"><p>定理4.2：设R是A到B的二元关系，S是B到C的二元关系，则$(R \circ S)^{-1} = S^{-1}\circ R^{-1}$</p></div><div class="note guide cyan"><p>定理4.3： 设R是A上的二元关系，$R^{-1}$ 是其逆关系，于是有：若R是 1. 自反的 2. 反自反的 3. 对称的 4. 反对称的 5. 可传递的 则$R^{-1}$也是</p></div><h2 id="关系的闭包运算"><a href="#关系的闭包运算" class="headerlink" title="关系的闭包运算"></a>关系的闭包运算</h2><h3 id="闭包运算的定义"><a href="#闭包运算的定义" class="headerlink" title="闭包运算的定义"></a>闭包运算的定义</h3><p>在给定的二元关系中，添加==最少量==的有序对后，使其称为自反的，或对称的，或传递的二元关系，则这样的操作称为关系的闭包运算</p><h3 id="自反、对称、传递闭包"><a href="#自反、对称、传递闭包" class="headerlink" title="自反、对称、传递闭包"></a>自反、对称、传递闭包</h3><p>设R是A上的二元关系，R的自反（对称、传递）闭包$R’$也是A上的二元关系，且满足：</p><ol><li>$R’$是自反的（对称的，传递的）</li><li>$R’ \supseteq R$</li><li>对于任何A上的自反的（对称的、传递的）二元关系$R’’$，如果$R’’ \supseteq R$，则必有$R’’\supseteq R’$</li></ol><p>通常R的自反闭包记作r(R)，对称闭包记作s(R)，传递闭包记作t(R)</p><h3 id="求闭包"><a href="#求闭包" class="headerlink" title="求闭包"></a>求闭包</h3><p>对于自反闭包和对称闭包，通过简单的添加“缺啥补啥”的原则即可求出</p><p>但在求传递闭包时，补充的元素可能会和已有的元素再次构成隐含的传递关系，那么处理起来就比较麻烦，下面介绍Warchall提出的求传递闭包的算法：</p><ol><li>置矩阵$M = M_R$（$M_R$ 是关系矩阵）</li><li>置 j = 1</li><li>对所有i，如果$m_{ij} = 1$，则对$k = 1,2,\dots,n$，置$m_{ik} = m_{ik} + m_{jk}$，即把第j行加到第i行</li><li>j = j + 1</li><li>如果$ j \leq n$，则跳转到步骤3，否则停止</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;复合关系&quot;&gt;&lt;a href=&quot;#复合关系&quot; class=&quot;headerlink&quot; title=&quot;复合关系&quot;&gt;&lt;/a&gt;复合关系&lt;/h2&gt;&lt;h3 id=&quot;定义&quot;&gt;&lt;a href=&quot;#定义&quot; class=&quot;headerlink&quot; title=&quot;定义&quot;&gt;&lt;/a&gt;定义&lt;/h</summary>
      
    
    
    
    <category term="离散数学" scheme="http://enderxiao.top/categories/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/"/>
    
    <category term="研究生入学考试" scheme="http://enderxiao.top/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/"/>
    
    <category term="复试" scheme="http://enderxiao.top/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/%E5%A4%8D%E8%AF%95/"/>
    
    
    <category term="离散数学" scheme="http://enderxiao.top/tags/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/"/>
    
    <category term="复合关系关系" scheme="http://enderxiao.top/tags/%E5%A4%8D%E5%90%88%E5%85%B3%E7%B3%BB%E5%85%B3%E7%B3%BB/"/>
    
    <category term="逆关系" scheme="http://enderxiao.top/tags/%E9%80%86%E5%85%B3%E7%B3%BB/"/>
    
  </entry>
  
  <entry>
    <title>离散数学-等价关系与偏序关系</title>
    <link href="http://enderxiao.top/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/%E5%A4%8D%E8%AF%95/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6-%E7%AD%89%E4%BB%B7%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%81%8F%E5%BA%8F%E5%85%B3%E7%B3%BB/"/>
    <id>http://enderxiao.top/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/%E5%A4%8D%E8%AF%95/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6-%E7%AD%89%E4%BB%B7%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%81%8F%E5%BA%8F%E5%85%B3%E7%B3%BB/</id>
    <published>2021-03-14T08:32:19.000Z</published>
    <updated>2021-03-22T14:42:02.143Z</updated>
    
    <content type="html"><![CDATA[<h2 id="等价关系"><a href="#等价关系" class="headerlink" title="等价关系"></a>等价关系</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>设存在关系R，若R满足：</p><ol><li>R是A上的二元关系</li><li>R是自反、==对称==、传递关系<br>则，R为A上的<code>等价关系</code>。</li></ol><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><ol><li>如果同年龄的大学生认为是相关的，不同年龄的大学生是无关的，则这种年龄关系R是<code>等价关系</code></li><li>如果姓氏相同的的大学生认为是相关的，不同姓氏的大学生是无关的，则这种姓氏关系R是<code>等价关系</code></li></ol><p>综上，若对于一个集合A种的元素，按某种条件进行分组，并使得：</p><ol><li>A种每个元素必属于某一组且仅属于一组</li><li>定义同一组内的元素相关，不同一组内的元素无关<br>则定义的二元关系必然是<code>等价关系</code></li></ol><h3 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h3><p>若把A中的元素按“组”顺序排列，那么等价关系R的关系矩阵是由若干个元素全为1的小方阵构成</p><h2 id="等价类和商集"><a href="#等价类和商集" class="headerlink" title="等价类和商集"></a>等价类和商集</h2><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><h4 id="等价类"><a href="#等价类" class="headerlink" title="等价类"></a>等价类</h4><p>设R是A商的等价关系，a是A中的任意元素，由A中所有与a相关的元素组成的集合，称为a关于R的<code>等价类</code>，记作$[a]_R$</p><h4 id="商集"><a href="#商集" class="headerlink" title="商集"></a>商集</h4><p>设R是A上的等价关系，由关于R的所有不同的等价类作为元素构成的集合称为A关于R的<code>商集</code>，记作A/R</p><h2 id="集合划分"><a href="#集合划分" class="headerlink" title="集合划分"></a>集合划分</h2><h3 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h3><p>设A是集合，$A_1 , A_2 , \dots , A_n$ 是A的非空子集，且满足：</p><ol><li>$A_1 \cup A_2 \cup \dots \cup A_n = A$</li><li>$A_i \cap A_j = \emptyset(i \neq j,i,j = 1,2,3,\dots,n)$</li></ol><p>则以$A_1 , A_2 , \dots , A_n$作为元素构成的集合S称为集合A的<code>划分</code>，每个子集$A_i$称为<code>块</code></p><h3 id="等价类、商集与集合划分"><a href="#等价类、商集与集合划分" class="headerlink" title="等价类、商集与集合划分"></a>等价类、商集与集合划分</h3><p>当R是A上的等价关系时，A关于R的<code>商集</code>时A的一个<code>划分</code>，<code>等价类</code>就是<code>块</code></p><p>于是有定理：</p><div class="note guide cyan"><p>定理3.1：集合A的划分能唯一地确定A上的一个等价关系；反之，确定了A上的等价关系也能唯一地确定A的一个划分，即A上的等价关系与划分一一对应</p></div><h3 id="集合运算的等价关系"><a href="#集合运算的等价关系" class="headerlink" title="集合运算的等价关系"></a>集合运算的等价关系</h3><p>设$R_1$ 和 $R_2$ 时非空集合A上的等价关系，则</p><ol><li>$R_1 \cup R_2$ 一定不是等价关系</li><li>$R_1 \cap R_2$ 一定是等价关系</li><li>$R_1 - R_2$ 一定不是等价关系</li><li>$R_1 \oplus R_2$ 一定不是等价关系</li></ol><p>可通过定义法，验证是否满足转递、自反、对称关系证明</p><h2 id="偏序关系"><a href="#偏序关系" class="headerlink" title="偏序关系"></a>偏序关系</h2><h3 id="定义-3"><a href="#定义-3" class="headerlink" title="定义"></a>定义</h3><p>设有关系R，集合A，若R满足：</p><ol><li>R是A上的二元关系</li><li>R是自反，==反对称==，传递关系</li></ol><p>则R是A上的<code>偏序关系</code>(半序关系)</p><h3 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h3><ol><li>对于正整数集，$\mathbb{Z}^+$,R是其上的小于等于关系关系，即当$a \leq b$时，$(a,b) \in R$，则R是其上的<code>偏序关系</code></li><li>对于正整数集，$\mathbb{Z}^+$,R是其上的整除关系，即当$b \ mod \ a = 0$时，$(a,b) \in R$，则R是其上的<code>偏序关系</code></li></ol><p>通常把集合A和集合A上的偏序关系R合在一起称为<code>偏序集</code>，并记作（A,R）或（A,$\preceq$）</p><h3 id="偏序关系哈斯图表示"><a href="#偏序关系哈斯图表示" class="headerlink" title="偏序关系哈斯图表示"></a>偏序关系哈斯图表示</h3><p>由偏序关系的特征：</p><ol><li>每个顶点都有自回，则可省略所有自环</li><li>对于$(a,b) \in R$和$(b,c)\in R$时，必有$(a,c) \in R$，则可省略a到c的边</li><li>通过调整点的位置，可以使所有有向边全部朝上，则可省略有向边的箭头</li></ol><h4 id="例子-2"><a href="#例子-2" class="headerlink" title="例子"></a>例子</h4><p>如设A = {1,2,3,4,5,6,12},R时A上的整除关系。易知，R = {(1,1),(2,2),(3,3),(4,4),(6,6),(12,12),(1,2),(1,3),(1,4),(1,6),(1,12),(2,4),(2,6),(2,12),(3,6),(3,12),(4,12),(6,12)}</p><p>则使用有向图表示为：</p><img src="https://i.postimg.cc/nrL13PXd/2-2-1-a.png" class="lazyload placeholder" data-srcset="https://i.postimg.cc/nrL13PXd/2-2-1-a.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="图2.2.1(a)" style="zoom: 200%;" /><p>使用哈斯图表示为：</p><img src="https://i.postimg.cc/Vs7gJmh2/1.png" class="lazyload placeholder" data-srcset="https://i.postimg.cc/Vs7gJmh2/1.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="图2.2.1(a)" style="zoom: 200%;" /><h4 id="覆盖"><a href="#覆盖" class="headerlink" title="覆盖"></a>覆盖</h4><p>设A(A,$\preceq$)是偏序集，a和b是A种两个不同的元素，如果$a\preceq b$，且在A中不存在其他元素c，使得$a\preceq c,c\preceq b$，则称b覆盖a</p><h4 id="作图原则"><a href="#作图原则" class="headerlink" title="作图原则"></a>作图原则</h4><p>利用覆盖的概念，可以油邻接矩阵直接画出哈斯图，即：</p><p>当b覆盖a时，代表b的顶点应华仔代表a的顶点上复，并用直线段连接这两个顶点</p><h3 id="偏序集中的特殊元素"><a href="#偏序集中的特殊元素" class="headerlink" title="偏序集中的特殊元素"></a>偏序集中的特殊元素</h3><p>设A(A,$\preceq$)是偏序集，A中存在元素a</p><ol><li>极小元：<ol><li>A中没有其他元素x满足$x\preceq a$，则a为A中的极小元</li><li>即a再也不能==覆盖==A中其他元素时，a时极小元</li></ol></li><li>极大元：<ol><li>A中没有其他元素x满足$x\succeq a$，则a为A中的极小元</li><li>即A中没有其他元素能==覆盖==a时，a为极大元</li></ol></li><li>最小元：<ol><li>中任何元素x，都有$x\succeq a$，则a为A中的最小元</li><li>即能被所有覆盖</li></ol></li><li>最大元：<ol><li>A中任何元素x，都有$x\preceq a$，则a为A中的最大元</li><li>即能覆盖所有</li></ol></li><li>上界：设B是A的子集，如果B中任何元素x，都有$x\preceq a$,则称a为子集B的上界</li><li>下界：设B是A的子集，如果B中任何元素x，都有$a\preceq x$,则称a为子集B的下界</li><li>上确界：<ol><li>设B是A的子集，a是B的上界，若B中任何上界x，都有$a\preceq x$，则称a为子集B的上确界</li><li>即最小上界</li></ol></li><li>下确界：<ol><li>设B是A的子集，a是B的上界，若B中任何上界x，都有$x \preceq a$，则称a为子集B的下确界</li><li>即最大下界</li></ol></li></ol><h3 id="全序集和拟序集"><a href="#全序集和拟序集" class="headerlink" title="全序集和拟序集"></a>全序集和拟序集</h3><h4 id="全序集"><a href="#全序集" class="headerlink" title="全序集"></a>全序集</h4><h5 id="定义-4"><a href="#定义-4" class="headerlink" title="定义"></a>定义</h5><p>设A(A,$\preceq$)是偏序集，如果A中任意两个元素都是<code>可比的</code>（即任意两个元素都有关系），则称$\preceq$为全序关系，$(A,\preceq)$为全序集</p><h5 id="例子-3"><a href="#例子-3" class="headerlink" title="例子"></a>例子</h5><p>如$Z^+$是正整数集合，对于先于等于关系，$(Z^+,\preceq)$是全序集下</p><h4 id="拟序集"><a href="#拟序集" class="headerlink" title="拟序集"></a>拟序集</h4><h5 id="定义-5"><a href="#定义-5" class="headerlink" title="定义"></a>定义</h5><p>设R是A上的一个二元关系，若满足：</p><ol><li>R是反自反关系</li><li>R是传递关系</li></ol><p>则R为A上的拟序关系，A为拟序集</p><h5 id="例子-4"><a href="#例子-4" class="headerlink" title="例子"></a>例子</h5><p>如$Z$上的小于关系是拟序关系</p><h5 id="相关定理"><a href="#相关定理" class="headerlink" title="相关定理"></a>相关定理</h5><p>拟序关系有如下定理：</p><div class="note guide cyan"><p>定理3.2：设R是A上的拟序关系，则R是A上的反对称关系</p></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;等价关系&quot;&gt;&lt;a href=&quot;#等价关系&quot; class=&quot;headerlink&quot; title=&quot;等价关系&quot;&gt;&lt;/a&gt;等价关系&lt;/h2&gt;&lt;h3 id=&quot;定义&quot;&gt;&lt;a href=&quot;#定义&quot; class=&quot;headerlink&quot; title=&quot;定义&quot;&gt;&lt;/a&gt;定义&lt;/h</summary>
      
    
    
    
    <category term="离散数学" scheme="http://enderxiao.top/categories/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/"/>
    
    <category term="研究生入学考试" scheme="http://enderxiao.top/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/"/>
    
    <category term="复试" scheme="http://enderxiao.top/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/%E5%A4%8D%E8%AF%95/"/>
    
    
    <category term="离散数学" scheme="http://enderxiao.top/tags/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/"/>
    
    <category term="等价关系" scheme="http://enderxiao.top/tags/%E7%AD%89%E4%BB%B7%E5%85%B3%E7%B3%BB/"/>
    
    <category term="偏序关系" scheme="http://enderxiao.top/tags/%E5%81%8F%E5%BA%8F%E5%85%B3%E7%B3%BB/"/>
    
  </entry>
  
  <entry>
    <title>离散数学-二元关系与函数</title>
    <link href="http://enderxiao.top/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/%E5%A4%8D%E8%AF%95/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6-%E4%BA%8C%E5%85%83%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%87%BD%E6%95%B0/"/>
    <id>http://enderxiao.top/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/%E5%A4%8D%E8%AF%95/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6-%E4%BA%8C%E5%85%83%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%87%BD%E6%95%B0/</id>
    <published>2021-02-28T14:04:49.000Z</published>
    <updated>2021-03-06T15:41:42.883Z</updated>
    
    <content type="html"><![CDATA[<h2 id="二元关系基本概念"><a href="#二元关系基本概念" class="headerlink" title="二元关系基本概念"></a>二元关系基本概念</h2><h3 id="二元关系定义"><a href="#二元关系定义" class="headerlink" title="二元关系定义"></a>二元关系定义</h3><hr><p>$$<br>设存在集合A={a,b,c,d,e}<br>$$</p><p>$$<br>若存在集合形如R={(a,b),(b,c),(b,d),(d,e)}的仅由A中两个元素组成的集合，称为二元关系<br>$$</p><h3 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h3><hr><p>笛卡尔积，又称直积</p><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><hr><p>设A、B是集合,A到B的笛卡尔积用$A\times B$表示，$A\times B$为所有以形如（a,b）的有序对为元素的集合，其中$a \in A,b\in B$</p><p>当B = A时，$A\times A$称为集合A上的笛卡尔乘积</p><h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><hr><p>$A = {a,b,c},B = {x,y}$<br>$则A\times B = {(a,x),(a,y),(b,x),(b,y),(c,x),(c,y)}$</p><h4 id="笛卡尔积元素个数"><a href="#笛卡尔积元素个数" class="headerlink" title="笛卡尔积元素个数"></a>笛卡尔积元素个数</h4><hr><p>由笛卡尔积的性质可知，若确定了某个集合A和B，则$A\times B$中的元素个数时可确定的。</p><p>接下来讨论元素个数的特点</p><p>若$|A| = n,|B| = m$ </p><p>A中任意一个元素a都能与B中的每一个元素组成一个元组，则可以组成m个</p><p>则$|A\times B| = n\times m$</p><h4 id="笛卡尔积相关定义"><a href="#笛卡尔积相关定义" class="headerlink" title="笛卡尔积相关定义"></a>笛卡尔积相关定义</h4><hr><h5 id="二元关系"><a href="#二元关系" class="headerlink" title="二元关系"></a>二元关系</h5><hr><p>$设A、B是集合，R是笛卡尔乘积A\times B的子集，则称R是A到B的一个二元关系$</p><p>$若B = A，R是笛卡尔乘积A\times B的子集，称R是A上的一个二元关系$</p><h5 id="前域与值域"><a href="#前域与值域" class="headerlink" title="前域与值域"></a>前域与值域</h5><hr><p>$设R是二元关系，由(x,y)\in R的所有x组成的集合称为R的前域记作domR$</p><p>$所有y组成的集合称为R的值域，记作ranR$</p><h5 id="平凡子集"><a href="#平凡子集" class="headerlink" title="平凡子集"></a>平凡子集</h5><p>对于集合A，空集和集合A本身一定是A的子集，则成这两个集合为A的平凡子集</p><h5 id="笛卡尔积的平凡子集"><a href="#笛卡尔积的平凡子集" class="headerlink" title="笛卡尔积的平凡子集"></a>笛卡尔积的平凡子集</h5><p>对于A和B的笛卡尔乘积$A\times B$，$\emptyset和A\times B$分别称为空关系和全域关系</p><h3 id="二元关系表示法"><a href="#二元关系表示法" class="headerlink" title="二元关系表示法"></a>二元关系表示法</h3><hr><h4 id="表格表示法"><a href="#表格表示法" class="headerlink" title="表格表示法"></a>表格表示法</h4><hr><p>前域为行，值域为列</p><p>如：</p><p>$A = {a_1,a_2,a_3,a_4,a_5}$</p><p>$B = {b_1,b_2,b_3,b_4}$</p><p>$R = {(a_1,b_1),(a_1,b_2),(a_3,b_3),(a_4,b_4),(a_5,b_3)}$</p><p>则R可表示为</p><table><thead><tr><th></th><th>b1</th><th>b2</th><th>b3</th><th>b4</th></tr></thead><tbody><tr><td>a1</td><td>√</td><td>√</td><td></td><td></td></tr><tr><td>a2</td><td></td><td></td><td></td><td></td></tr><tr><td>a3</td><td></td><td></td><td>√</td><td></td></tr><tr><td>a4</td><td></td><td></td><td></td><td>√</td></tr><tr><td>a5</td><td></td><td></td><td>√</td><td></td></tr></tbody></table><h4 id="矩阵表示法"><a href="#矩阵表示法" class="headerlink" title="矩阵表示法"></a>矩阵表示法</h4><hr><p>设$|A| = n,|B| = m$,则可以用一个$n\times m$的矩阵C来表示关系二元关系R</p><p>即将C中元素$C_{ij}$定义为：<br>$$<br>\begin{cases}<br>    1 &amp; (a_i,b_j)\in R \\<br>    0 &amp; (a_i,b_j) \notin R<br>\end{cases}<br>$$</p><p>则，矩阵<br>$$<br>C = \begin{bmatrix}<br>        1 &amp; 0 &amp; 0 \\<br>        0 &amp; 1 &amp; 1 \\<br>        0 &amp; 0 &amp; 1 \\<br>        0 &amp; 1 &amp; 0 \\<br>        0 &amp; 0 &amp; 1 \\<br>     \end{bmatrix}<br>$$</p><p>则C称为R的关系矩阵</p><h4 id="图形表示法"><a href="#图形表示法" class="headerlink" title="图形表示法"></a>图形表示法</h4><hr><p>对于R中的所有关系，分别用n个点表示A中的所有元素，m个点表示B中的所有元素，若$a\in A,b \in B,(a,b) \in R$,则从点a至b画一条有向边</p><p>若R是A上的二元关系，则可以只用n个点表示A中的所有元素，若$(a_i,a_j) \in R$,则从点$a_i$到点$a_j$画一条有向边</p><h3 id="二元关系的基本类型"><a href="#二元关系的基本类型" class="headerlink" title="二元关系的基本类型"></a>二元关系的基本类型</h3><hr><table><thead><tr><th>基本类型</th><th>定义</th><th>特征</th></tr></thead><tbody><tr><td>自反</td><td>设R是A上的一个二元关系，如果对于A中每一个元素a，都有$(a,a) \in R$，则称R为自反的二元关系</td><td>R的关系矩阵中的主对角线元素均为1</td></tr><tr><td>反自反</td><td>设R是A上的二元关系，如果对于A中每一个元素a，都有$(a,a) \notin R$，则称R为反自反的二元关系</td><td>R的关系矩阵中主对角线元素均为0</td></tr><tr><td>对称</td><td>设R是A上的二元关系，且每当$(a,b)\in R$时，就一定有$(b,a)\in R$，则称R为对称的二元关系</td><td>R的关系矩阵是一个对称的方阵</td></tr><tr><td>反对称</td><td>设R是A上的二元关系，每当$(a,b)\in R$，且$(b,a) \in R$时，必有a = b，则称R为反对称的二元关系</td><td>R的关系矩阵中以主对角线对称的两个元素不能同时为1</td></tr><tr><td>传递</td><td>设R是A上的二元关系，每当有$(a,b)\in R$且$(b,c) \in R$时，必有$(a,c) \in R$，则称R为传递的二元关系</td><td>可以通过矩阵乘法判断是否传递</td></tr></tbody></table><h4 id="传递性的判断"><a href="#传递性的判断" class="headerlink" title="传递性的判断"></a>传递性的判断</h4><hr><p>判断关系R是否为传递的二元关系时，需要利用矩阵乘法，下面进行分析<br>$$<br>设A = {a_1,a_2,…,a_3},R时A上的二元关系，R的关系矩阵A_R为<br>$$</p><p>$$<br>A_R = \begin{bmatrix}<br>    a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\<br>    a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\<br>    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>    a_{n1} &amp; a_{n2} &amp; \cdots &amp; a_{nn} \\<br>\end{bmatrix}<br>$$</p><p>其中<br>$$<br>a_{ij} =<br>\begin{cases}<br>    1 &amp; (a_i,b_j)\in R \\<br>    0 &amp; (a_i,b_j) \notin R<br>\end{cases}<br>$$<br>令$B = A_R \times A_R, B$中的元素为$b_{ij}$,即有<br>$$<br>B = \begin{bmatrix}<br>        b_{11} &amp; b_{12} &amp; \cdots &amp; b_{1n} \\<br>        b_{21} &amp; b_{22} &amp; \cdots &amp; b_{2n} \\<br>        \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>        b_{n1} &amp; b_{n2} &amp; \cdots &amp; b_{nn} \\<br>        \end{bmatrix} = \begin{bmatrix}<br>            a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\<br>            a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\<br>            \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\<br>            a_{n1} &amp; a_{n2} &amp; \cdots &amp; a_{nn} \\<br>            \end{bmatrix}\times \begin{bmatrix}<br>                a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\                     a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\                    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\                    a_{n1} &amp; a_{n2} &amp; \cdots &amp; a_{nn} \\<br>            \end{bmatrix}<br>$$</p><p>由矩阵乘法运算规则可知</p><p>$$<br>b_{ij} = a_{i1} \times a_{1j} + a_{i2}\times a_{2j} + \cdots +a_{in}\times a_{nj} = \sum\limits_{R = 1}^n a_{ik} \times a_{kj}<br>$$</p><p>即，当$b_{ij} \neq 0$时，说明，存在一个$k\leq n$,其对应的一组$a_{ik}=a_{kj}=1$，即$(a_{ik},a{jk})\in R$，那么如果R为传递关系，则必须有$a_{ij} = 1$，故对于任意$b_{ij} \neq 0$都有$a_{ij} = 1$,则R为传递关系。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;二元关系基本概念&quot;&gt;&lt;a href=&quot;#二元关系基本概念&quot; class=&quot;headerlink&quot; title=&quot;二元关系基本概念&quot;&gt;&lt;/a&gt;二元关系基本概念&lt;/h2&gt;&lt;h3 id=&quot;二元关系定义&quot;&gt;&lt;a href=&quot;#二元关系定义&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="离散数学" scheme="http://enderxiao.top/categories/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/"/>
    
    <category term="研究生入学考试" scheme="http://enderxiao.top/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/"/>
    
    <category term="复试" scheme="http://enderxiao.top/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/%E5%A4%8D%E8%AF%95/"/>
    
    
    <category term="离散数学" scheme="http://enderxiao.top/tags/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/"/>
    
    <category term="二元关系" scheme="http://enderxiao.top/tags/%E4%BA%8C%E5%85%83%E5%85%B3%E7%B3%BB/"/>
    
    <category term="笛卡尔积" scheme="http://enderxiao.top/tags/%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF/"/>
    
  </entry>
  
  <entry>
    <title>毕业设计</title>
    <link href="http://enderxiao.top/%E6%9C%AC%E7%A7%91/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    <id>http://enderxiao.top/%E6%9C%AC%E7%A7%91/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/</id>
    <published>2021-02-25T09:53:14.000Z</published>
    <updated>2021-02-25T10:17:39.595Z</updated>
    
    <content type="html"><![CDATA[<h2 id="毕业设计"><a href="#毕业设计" class="headerlink" title="毕业设计"></a>毕业设计</h2><h3 id="数据字典"><a href="#数据字典" class="headerlink" title="数据字典"></a>数据字典</h3><hr><h4 id="college"><a href="#college" class="headerlink" title="college"></a>college</h4><hr><table><thead><tr><th>字段名</th><th>数据类型</th><th>键</th><th>长度</th><th>备注</th><th>不是null</th></tr></thead><tbody><tr><td>college_id</td><td>int</td><td>主键</td><td></td><td>自增</td><td>√</td></tr><tr><td>college_name</td><td>varchar</td><td></td><td>40</td><td>学院名，唯一</td><td>√</td></tr><tr><td>college_student_num</td><td>int</td><td></td><td></td><td>学院总人数</td><td></td></tr></tbody></table><h4 id="major"><a href="#major" class="headerlink" title="major"></a>major</h4><hr><table><thead><tr><th>字段名</th><th>数据类型</th><th>键</th><th>长度</th><th>备注</th><th>不是null</th></tr></thead><tbody><tr><td>major_id</td><td>int</td><td>主键</td><td></td><td>自增</td><td>√</td></tr><tr><td>major_name</td><td>varchar</td><td></td><td>40</td><td>专业名，唯一</td><td>√</td></tr><tr><td>major_student_num</td><td>int</td><td></td><td></td><td>专业人数</td><td></td></tr><tr><td>college_id</td><td>int</td><td>外键（college）</td><td></td><td>学院名</td><td>√</td></tr></tbody></table><h4 id="classes"><a href="#classes" class="headerlink" title="classes"></a>classes</h4><hr><table><thead><tr><th>字段名</th><th>数据类型</th><th>键</th><th>长度</th><th>备注</th><th>不是null</th></tr></thead><tbody><tr><td>classes_id</td><td>int</td><td>主键</td><td></td><td>自增</td><td>√</td></tr><tr><td>major_id</td><td>int</td><td>外键（major）</td><td></td><td>所属专业</td><td>√</td></tr><tr><td>school_year</td><td>int</td><td></td><td></td><td>学年</td><td>√</td></tr><tr><td>classes_name</td><td>int</td><td></td><td></td><td>班级名（1，2，3…）</td><td>√</td></tr></tbody></table><h4 id="user"><a href="#user" class="headerlink" title="user"></a>user</h4><hr><table><thead><tr><th>字段名</th><th>数据类型</th><th>键</th><th>长度</th><th>备注</th><th>不是null</th></tr></thead><tbody><tr><td>u_id</td><td>int</td><td>主键</td><td></td><td>学生学号</td><td>√</td></tr><tr><td>username</td><td>varchar</td><td></td><td>20</td><td>学生姓名</td><td>√</td></tr><tr><td>password</td><td>char</td><td></td><td>6</td><td>必须为6位数字</td><td>√</td></tr><tr><td>class_id</td><td>int</td><td>外键（classes表）</td><td></td><td>班级id</td><td>√</td></tr></tbody></table><h4 id="virtualCard"><a href="#virtualCard" class="headerlink" title="virtualCard"></a>virtualCard</h4><hr><table><thead><tr><th>字段名</th><th>数据类型</th><th>键</th><th>长度</th><th>备注</th><th>不是null</th></tr></thead><tbody><tr><td>vc_id</td><td>int</td><td>主键</td><td></td><td>自增</td><td>√</td></tr><tr><td>u_id</td><td>int</td><td>外键（user）</td><td></td><td>用户id</td><td>√</td></tr><tr><td>rest_money</td><td>int</td><td></td><td></td><td>卡内剩余金额数</td><td>√</td></tr><tr><td>card_status</td><td>byte</td><td></td><td></td><td>0表示未激活，1表示激活</td><td>√</td></tr><tr><td>creat_time</td><td>datetime</td><td></td><td></td><td>创建时间</td><td>√</td></tr><tr><td>last_edit_time</td><td>datetime</td><td></td><td></td><td>最后一次更新时间</td><td>√</td></tr><tr><td>vc_password</td><td>char</td><td></td><td>6</td><td>校园卡支付密码</td><td>√</td></tr></tbody></table><h4 id="store"><a href="#store" class="headerlink" title="store"></a>store</h4><hr><table><thead><tr><th>字段名</th><th>数据类型</th><th>键</th><th>长度</th><th>备注</th><th>不是null</th></tr></thead><tbody><tr><td>store_id</td><td>int</td><td>主键</td><td></td><td>自增</td><td>√</td></tr><tr><td>store_name</td><td>varchar</td><td></td><td>40</td><td>商铺名，唯一</td><td>√</td></tr><tr><td>create_time</td><td>datetime</td><td></td><td></td><td>创建时间</td><td>√</td></tr></tbody></table><h4 id="consumption"><a href="#consumption" class="headerlink" title="consumption"></a>consumption</h4><hr><table><thead><tr><th>字段名</th><th>数据类型</th><th>键</th><th>长度</th><th>备注</th><th>不是null</th></tr></thead><tbody><tr><td>csp_id</td><td>int</td><td>主键</td><td></td><td>自增</td><td>√</td></tr><tr><td>csp_money</td><td>int</td><td></td><td></td><td>消费金额</td><td>√</td></tr><tr><td>store_id</td><td>int</td><td>外键（store）</td><td></td><td>消费地点id</td><td>√</td></tr><tr><td>csp_time</td><td>datetime</td><td></td><td></td><td>消费时间</td><td>√</td></tr><tr><td>u_id</td><td>int</td><td>外键（user）</td><td></td><td>消费用户</td><td>√</td></tr><tr><td>csp_status</td><td>byte</td><td></td><td></td><td>0表示出账，1表示入账</td><td>√</td></tr></tbody></table><h4 id="grade"><a href="#grade" class="headerlink" title="grade"></a>grade</h4><hr><table><thead><tr><th>字段名</th><th>数据类型</th><th>键</th><th>长度</th><th>备注</th><th>不是null</th></tr></thead><tbody><tr><td>grade_id</td><td>int</td><td>主键</td><td></td><td>自增</td><td>√</td></tr><tr><td>u_id</td><td>int</td><td>外键（user）</td><td></td><td>成绩所属学生</td><td>√</td></tr><tr><td>grade_sum</td><td>varchar</td><td></td><td></td><td>总成绩</td><td>√</td></tr><tr><td>daily_grade</td><td>varchar</td><td></td><td>10</td><td>平时成绩</td><td></td></tr><tr><td>exam_grade</td><td>varchar</td><td></td><td>10</td><td>考试成绩</td><td></td></tr><tr><td>exam_type</td><td>varchar</td><td></td><td>10</td><td>测试类型</td><td>√</td></tr><tr><td>grade_name</td><td>varchar</td><td></td><td>40</td><td>课程名</td><td>√</td></tr></tbody></table><h4 id="classRoom"><a href="#classRoom" class="headerlink" title="classRoom"></a>classRoom</h4><hr><table><thead><tr><th>字段名</th><th>数据类型</th><th>键</th><th>长度</th><th>备注</th><th>不是null</th></tr></thead><tbody><tr><td>class_room_id</td><td>int</td><td>主键</td><td></td><td>自增</td><td>√</td></tr><tr><td>class_room_no</td><td>int</td><td></td><td></td><td>教室编号</td><td>√</td></tr><tr><td>class_building</td><td>varchar</td><td></td><td>40</td><td>所属教学楼</td><td>√</td></tr><tr><td>area_name</td><td>varchar</td><td></td><td>10</td><td>校区</td><td>√</td></tr></tbody></table><h4 id="course"><a href="#course" class="headerlink" title="course"></a>course</h4><hr><table><thead><tr><th>字段名</th><th>数据类型</th><th>键</th><th>长度</th><th>备注</th><th>不是null</th></tr></thead><tbody><tr><td>course_id</td><td>int</td><td>主键</td><td></td><td>自增</td><td>√</td></tr><tr><td>course_name</td><td>varchar</td><td></td><td>30</td><td>课程名</td><td>√</td></tr><tr><td>classes_id</td><td>int</td><td>外键（classes）</td><td></td><td>上课班级</td><td>√</td></tr><tr><td>week_no</td><td>int</td><td></td><td>1-25</td><td>上课周次</td><td>√</td></tr><tr><td>week_day</td><td>int</td><td></td><td>1~7</td><td>课程在周几</td><td>√</td></tr><tr><td>course_no</td><td>int</td><td></td><td>1~8</td><td>第几节课</td><td>√</td></tr><tr><td>class_room_id</td><td>int</td><td>外键（classRoom）</td><td></td><td>上课教室</td><td>√</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;毕业设计&quot;&gt;&lt;a href=&quot;#毕业设计&quot; class=&quot;headerlink&quot; title=&quot;毕业设计&quot;&gt;&lt;/a&gt;毕业设计&lt;/h2&gt;&lt;h3 id=&quot;数据字典&quot;&gt;&lt;a href=&quot;#数据字典&quot; class=&quot;headerlink&quot; title=&quot;数据字典&quot;&gt;&lt;/a</summary>
      
    
    
    
    <category term="本科" scheme="http://enderxiao.top/categories/%E6%9C%AC%E7%A7%91/"/>
    
    <category term="毕业设计" scheme="http://enderxiao.top/categories/%E6%9C%AC%E7%A7%91/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    
    <category term="毕业设计" scheme="http://enderxiao.top/tags/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/"/>
    
    <category term="微信小程序" scheme="http://enderxiao.top/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
    <category term="本科" scheme="http://enderxiao.top/tags/%E6%9C%AC%E7%A7%91/"/>
    
    <category term="虚拟校园" scheme="http://enderxiao.top/tags/%E8%99%9A%E6%8B%9F%E6%A0%A1%E5%9B%AD/"/>
    
  </entry>
  
  <entry>
    <title>mybatis入门</title>
    <link href="http://enderxiao.top/ssm/mybatis/mybatis%E5%85%A5%E9%97%A8/"/>
    <id>http://enderxiao.top/ssm/mybatis/mybatis%E5%85%A5%E9%97%A8/</id>
    <published>2021-02-08T07:34:18.000Z</published>
    <updated>2021-08-05T23:43:14.117Z</updated>
    
    <content type="html"><![CDATA[<p>java工具——持久层工具mybatis</p><a id="more"></a><h2 id="mybatis简介"><a href="#mybatis简介" class="headerlink" title="mybatis简介"></a>mybatis简介</h2><div class="tag link"><a class="link-card" title="以下引用自百度" href="https://baike.baidu.com/item/MyBatis/2824918?fr=aladdin"><div class="left"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" class="lazyload placeholder" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text">以下引用自百度</p><p class="url">https://baike.baidu.com/item/MyBatis/2824918?fr=aladdin</p></div></a></div><p>MyBatis 本是apache的一个<a href="https://baike.baidu.com/item/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/3406069">开源项目</a>iBatis, 2010年这个<a href="https://baike.baidu.com/item/%E9%A1%B9%E7%9B%AE/477803">项目</a>由apache software foundation 迁移到了<a href="https://baike.baidu.com/item/Google%E4%BB%A3%E7%A0%81/1433386?fromtitle=google%20code&fromid=2346604">google code</a>，并且改名为MyBatis 。2013年11月迁移到<a href="https://baike.baidu.com/item/Github/10145341">Github</a>。</p><p>iBATIS一词来源于“internet”和“abatis”的组合，是一个基于Java的<a href="https://baike.baidu.com/item/%E6%8C%81%E4%B9%85%E5%B1%82/3584971">持久层</a>框架。iBATIS提供的持久层框架包括SQL Maps和Data Access Objects（DAOs）</p><h2 id="mybatis作用"><a href="#mybatis作用" class="headerlink" title="mybatis作用"></a>mybatis作用</h2><div class="tag link"><a class="link-card" title="以下引用自百度" href="https://baike.baidu.com/item/MyBatis/2824918?fr=aladdin"><div class="left"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" class="lazyload placeholder" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text">以下引用自百度</p><p class="url">https://baike.baidu.com/item/MyBatis/2824918?fr=aladdin</p></div></a></div><ol><li>MyBatis 是一款优秀的持久层框架，它支持定制化 SQL、存储过程以及高级映射。</li><li>MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。</li><li>MyBatis 可以使用简单的 XML 或注解来配置和映射原生信息，将接口和 Java 的 POJOs(Plain Ordinary Java Object,普通的 Java对象)映射成数据库中的记录。</li></ol><h3 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h3><hr><p><a href="https://baike.baidu.com/item/%E6%8C%81%E4%B9%85%E5%8C%96/6726574?fr=aladdin">将程序数据在持久状态和瞬间状态之间转化的机制，最好的例子就是将内存中的数据保存到磁盘就是一个持久化的过程</a></p><p>我们的程序在运行时说的持久化通常就是指将内存数据存在硬盘，比如保存在数据库文件、xml文件中</p><h3 id="持久层"><a href="#持久层" class="headerlink" title="持久层"></a>持久层</h3><hr><p>java中所说的持久层，大体上指将业务中操作数据库的代码统一抽离出来，形成了位于业务层和数据库之间的独立的层</p><p>常见的解决方案有：</p><ul><li>JDBC</li><li>EJB</li><li>JDO</li></ul><h3 id="mybatis优点和缺点"><a href="#mybatis优点和缺点" class="headerlink" title="mybatis优点和缺点"></a>mybatis优点和缺点</h3><hr><ul><li>sql语句与代码分离，存放在xml配置文件中<ul><li>优点：便于维护管理，不用在java代码中找这些语句，使项目能更好的符合开闭原则</li><li>缺点：JDBC方式可以用打断点的方式调试，但是mybatis不能，需要通过log4j日志输出日志信息帮助调试，然后再配置文件中修改</li></ul></li><li>用逻辑标签控制动态SQL的拼接<ul><li>优点：用标签代替写逻辑代码</li><li>缺点：拼接复杂SQL语句时，没有代码灵活，拼写比较复杂。</li></ul></li><li>查询的结果集与java对象自动映射<ul><li>优点：保证名称相同，配置好映射关系即可自动映射，或者，不配置映射关系，通过配置列名 = 字段名也可以完成自动映射</li><li>缺点：对开发人员缩写的SQL依赖很强</li></ul></li><li>编写原生SQL<ul><li>接近JDBC，比较灵活</li><li>对SQL语句依赖程度很高；并且属于半自动，数据库移植比较麻烦，比如mysql数据库变成Oracle数据库，部分sql语句需要调整</li></ul></li></ul><h2 id="代理设计模式"><a href="#代理设计模式" class="headerlink" title="代理设计模式"></a>代理设计模式</h2><p>代理模式分为：</p><ol><li>静态代理</li><li>动态代理</li></ol><p>代理的核心功能是方法增强</p><h3 id="静态代理"><a href="#静态代理" class="headerlink" title="静态代理"></a>静态代理</h3><hr><h4 id="角色分析"><a href="#角色分析" class="headerlink" title="角色分析"></a>角色分析</h4><hr><ol><li>抽象角色：一般使用接口或者抽象类来实现</li><li>真实角色：被代理的角色</li><li>代理角色：代理真实角色；代理真实角色后，一般会做一些附属的操作</li><li>客户：使用代理角色来进行一些操作</li></ol><h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><hr><p>写一个接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Singer</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 歌手都能唱歌</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sing</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>男歌手</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MaleSinger</span> <span class="keyword">implements</span> <span class="title">Singer</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MaleSinger</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sing</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.name+<span class="string">&quot;开始唱歌了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>经纪人</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Agent</span> <span class="keyword">implements</span> <span class="title">Singer</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Singer singer;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Agent</span><span class="params">(Singer singer)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.singer = singer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;和节目组谈好价格，曲目，场地....&quot;</span>);</span><br><span class="line">        singer.sing();</span><br><span class="line">        System.out.println(<span class="string">&quot;结算费用&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>客户</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Singer singer = <span class="keyword">new</span> MaleSinger(<span class="string">&quot;Bob.M&quot;</span>);</span><br><span class="line">        Singer agent = <span class="keyword">new</span> Agent(singer);</span><br><span class="line">        agent.sing();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个过程中我们直接接触的是经纪人，经济人在演出前后做了一些复杂的事情</p><h5 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h5><hr><ul><li>虽然整个演出的过程复杂了，但是歌手类并没有改变</li><li>公共的统一问题都交给了代理完成</li><li>公共业务进行拓展或变更时，可以更为方便</li><li>符合开闭原则、单一原则</li></ul><h5 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h5><hr><ul><li>每个类都写个代理，重复工作较多，比较麻烦</li></ul><h3 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h3><hr><ol><li>动态代理的角色和静态代理的一样</li><li>动态代理的代理类是动态生成的，静态代理中的代理是我们自己创建的</li><li>动态代理分为两类：<ol><li>基于接口的动态代理——JDK动态代理</li><li>基于类的动态代理——cglib</li></ol></li><li>现在用的比较多的是javasist来生成动态代理</li></ol><h4 id="JDK动态代理"><a href="#JDK动态代理" class="headerlink" title="JDK动态代理"></a>JDK动态代理</h4><hr><p>核心：invocationHandler和Proxy，打开JDK帮助文档可查看</p><p>【invocationHandler：调用处理程序】</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Object <span class="title">invoke</span><span class="params">(Object proxy,Method method, Object[] args)</span></span>;</span><br><span class="line"><span class="comment">//参数</span></span><br><span class="line"><span class="comment">//proxy -调用该方法的代理实列</span></span><br><span class="line"><span class="comment">//method - 所描述方法对应于调用代理实列上的接口方法的实列。方法对象的声明类将是该方法声明的接口，它可以是代理类继承该方法的代理接口的超级接口</span></span><br><span class="line"><span class="comment">//args -包含的方法调用传递代理实列的参数值的对象的阵列，或null如果接口方法没有参数。原始类型的参数包含在适当的原始包装器类的实列中，例如java.lang.Integer或java.lang.Boolean.</span></span><br></pre></td></tr></table></figure><p>【proxy：代理】</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//生成代理类</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">getProxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Proxy.<span class="function">new <span class="title">ProxyInstance</span><span class="params">(<span class="keyword">this</span>.getClass()</span>.<span class="title">getClassLoader</span><span class="params">()</span>, rent.<span class="title">getClass</span><span class="params">()</span>.<span class="title">getInterface</span><span class="params">()</span>,<span class="keyword">this</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**参数：</span></span><br><span class="line"><span class="comment"> * 类加载器，接口数组，innovationHandler</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><p>例子：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Singer singer = <span class="keyword">new</span> MaleSinger(<span class="string">&quot;Bob.M&quot;</span>);</span><br><span class="line">        Singer agent = (Singer) Proxy.newProxyInstance(Client.class.getClassLoader(), singer.getClass().getInterfaces(), <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;节目组找过了，需要演出，谈好费用...&quot;</span>);</span><br><span class="line">                Object invoke = method.invoke(singer, args);</span><br><span class="line">                System.out.println(<span class="string">&quot;结算费用，下一次合作预约...&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> invoke;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//此处匿名内部类InvocationHandler也可以使用lambda表达式:</span></span><br><span class="line">        <span class="comment">//        Singer agent = (Singer) Proxy.newProxyInstance(Client.class.getClassLoader(), singer.getClass().getInterfaces(), (proxy, method, args1) -&gt; &#123;</span></span><br><span class="line">        <span class="comment">//            System.out.println(&quot;节目组找过了，需要演出，谈好费用...&quot;);</span></span><br><span class="line">        <span class="comment">//            Object invoke = method.invoke(singer, args1);</span></span><br><span class="line">        <span class="comment">//            System.out.println(&quot;结算费用，下一次合作预约...&quot;);</span></span><br><span class="line">        <span class="comment">//            return invoke;</span></span><br><span class="line">        <span class="comment">//        &#125;);</span></span><br><span class="line"></span><br><span class="line">        agent.sing();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Proxy会利用java发反射机制，自动的为你的项目中创建一个代理类，使用如下语句，生成的动态代理，就会在编译后的文件中显示</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">System.getProperties().put(<span class="string">&quot;sun.misc.ProxyGenerator.saveGeneratedFiles&quot;</span>,<span class="keyword">true</span>);<span class="comment">//jdk1.8可以使用</span></span><br><span class="line"><span class="comment">//然而在新版本中使用该方法仍然无法显示，通过查找包中ProxyGenerator类的路径得知，新版本需要如下设置</span></span><br><span class="line">System.getProperties().put(<span class="string">&quot;jdk.proxy.ProxyGenerator.saveGeneratedFiles&quot;</span>,<span class="string">&quot;true&quot;</span>);<span class="comment">//jdk11可以使用</span></span><br></pre></td></tr></table></figure><p>原因在此：</p><div class="tag link"><a class="link-card" title="关于如何获取动态创建的代理的问题" href="https://blog.csdn.net/zyq8514700/article/details/99892329"><div class="left"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" class="lazyload placeholder" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text">关于如何获取动态创建的代理的问题</p><p class="url">https://blog.csdn.net/zyq8514700/article/details/99892329</p></div></a></div><p>Singer代理产生类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Agent</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Object object;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Agent</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.object = object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;节目组找过了，需要演出，谈好费用...&quot;</span>);</span><br><span class="line">        Object invoke = method.invoke(object, args);</span><br><span class="line">        System.out.println(<span class="string">&quot;结算费用，下一次合作预约...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> invoke;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getProxy</span><span class="params">(Singer singer)</span></span>&#123;</span><br><span class="line">        Agent agent = <span class="keyword">new</span> Agent(singer);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(Agent.class.getClassLoader(),singer.getClass().getInterfaces(),agent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.getProperties().put(<span class="string">&quot;jdk.proxy.ProxyGenerator.saveGeneratedFiles&quot;</span>,<span class="string">&quot;true&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Singer singer = <span class="keyword">new</span> MaleSinger(<span class="string">&quot;Bob.M&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Singer agent = (Singer) Agent.getProxy(singer);</span><br><span class="line"></span><br><span class="line">        agent.sing();</span><br><span class="line"></span><br><span class="line">        Singer singer1 = <span class="keyword">new</span> MaleSinger(<span class="string">&quot;Bob.D&quot;</span>);</span><br><span class="line">        Singer agent1 = (Singer) Agent.getProxy(singer1);</span><br><span class="line">        agent1.sing();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>万能代理：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Agent</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;打开资源&quot;</span>);</span><br><span class="line">        System.out.println(method.getName());</span><br><span class="line">        <span class="keyword">if</span>(args != <span class="keyword">null</span>)&#123;</span><br><span class="line">            System.out.println(args[<span class="number">0</span>].getClass().getSimpleName());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;关闭资源&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt;<span class="function">T <span class="title">getProxy</span><span class="params">(Class&lt;T&gt; target)</span></span>&#123;</span><br><span class="line">        Agent agent = <span class="keyword">new</span> Agent();</span><br><span class="line">        Object o = Proxy.newProxyInstance(Agent.class.getClassLoader(), <span class="keyword">new</span> Class[]&#123;target&#125;, agent);<span class="comment">//new 一个该类型的接口</span></span><br><span class="line">        <span class="keyword">return</span> (T)o;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.getProperties().put(<span class="string">&quot;jdk.proxy.ProxyGenerator.saveGeneratedFiles&quot;</span>,<span class="string">&quot;true&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Singer proxy = Agent.getProxy(Singer.class);</span><br><span class="line">        proxy.sing();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        IUserDao proxy1 = Agent.getProxy(IUserDao.class);</span><br><span class="line">        proxy1.saveUser(<span class="string">&quot;Ender&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="搭建环境"><a href="#搭建环境" class="headerlink" title="搭建环境"></a>搭建环境</h2><h3 id="建立数据库"><a href="#建立数据库" class="headerlink" title="建立数据库"></a>建立数据库</h3><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE IF EXISTS &#96;user&#96;;</span><br><span class="line">CREATE TABLE &#96;user&#96; (</span><br><span class="line">&#96;id&#96; INT(20) NOT NULL,</span><br><span class="line">&#96;username&#96; VARCHAR(30) DEFAULT NULL,</span><br><span class="line">&#96;password&#96; VARCHAR(30) DEFAULT NULL,</span><br><span class="line">PRIMARY KEY (&#96;id&#96;)</span><br><span class="line">) ENGINE&#x3D;INNODB DEFAULT CHARSET&#x3D;utf8;</span><br><span class="line"></span><br><span class="line">INSERT into &#96;user&#96;(&#96;id&#96;,&#96;username&#96;,&#96;password&#96;)VALUE (1,&#39;张三&#39;,&#39;123456&#39;),(2,&#39;李四&#39;,&#39;abcdef&#39;),(3,&#39;王五&#39;,&#39;987654&#39;);</span><br></pre></td></tr></table></figure><h3 id="编写实体类"><a href="#编写实体类" class="headerlink" title="编写实体类"></a>编写实体类</h3><hr><blockquote><p>此处用到lombok插件，可使用注释的方式在编译时生成构造函数，toString等方法</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Ender-PC</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/2/2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Maven配置"><a href="#Maven配置" class="headerlink" title="Maven配置"></a>Maven配置</h3><hr><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--单元测试--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mybatis 核心--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--数据库驱动--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.23<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--单元测试--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">source</span>&gt;</span>11<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">target</span>&gt;</span>11<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--防止在java中写的配置文件不被加载到resources文件夹--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Mybatis核心配置文件"><a href="#Mybatis核心配置文件" class="headerlink" title="Mybatis核心配置文件"></a>Mybatis核心配置文件</h3><hr><p>mybatis-config.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--对xml的约束--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 1.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/schema/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--环境--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--事物管理器--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--数据源--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/ssm?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mappers/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>实列对应的xml，在该文件中，可以直接添加sql语句来进行查询</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="line">&lt;!--对xml的约束--&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">        PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="line">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;com.ender.dao.UserMapper&quot;</span>&gt;</span><br><span class="line">    &lt;select id=<span class="string">&quot;selectUsers&quot;</span> resultType=<span class="string">&quot;com.ender.entity.User&quot;</span>&gt;</span><br><span class="line">        select id,username,password from user</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure><h2 id="DAO层接口"><a href="#DAO层接口" class="headerlink" title="DAO层接口"></a>DAO层接口</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Ender-PC</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有用户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">selectUsers</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查找用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">User <span class="title">selectUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>此处使用junit中的before和after将数据库的开关分离处理</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Ender-PC</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/2/2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestUser</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String resource = <span class="string">&quot;mybatis-config.xml&quot;</span>;</span><br><span class="line">            InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">            SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">            session = sqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectUsers</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//使用代理调用dao</span></span><br><span class="line">        UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">        List&lt;User&gt; users = mapper.selectUsers();</span><br><span class="line">        <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h2><h3 id="select"><a href="#select" class="headerlink" title="select"></a>select</h3><hr><ol><li>在接口中添加方法的声明:</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查找用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">User <span class="title">selectUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在UserMapper.xml中添加select语句</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.ender.entity.User&quot;</span>&gt;</span></span><br><span class="line">    select id,username,password from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>其中：</p><ol><li>resultType：指定了返回值类型</li><li>parameterType：参数类型（具有自动映射自动转化的过程）</li><li>id：指定对应的方法</li><li>#{id}：sql中的变量，要保证大括号中的变量必须在User对象里有</li><li>#{}：占位符，其实就是<code>PreparedStatement</code>处理这个变量</li></ol><h4 id="与-的区别"><a href="#与-的区别" class="headerlink" title="#{}与${}的区别"></a>#{}与${}的区别</h4><hr><ul><li>#{}的主要作用就是替换预编译语句{<code>PreparedStatement</code>}中的占位符<kbd>, ?</kbd>[推荐使用]</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">INSERT INTO <span class="title">user</span> <span class="params">(name)</span> <span class="title">VALUE</span> <span class="params">(#&#123;name&#125;)</span></span>;</span><br><span class="line"><span class="function">INSERT INTO <span class="title">user</span> <span class="params">(name)</span> <span class="title">VALUE</span> <span class="params">(?)</span></span>;</span><br></pre></td></tr></table></figure><ul><li>${}的作用是直接进行字符串替换</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">INSERT INTO <span class="title">user</span> <span class="params">(name)</span> <span class="title">VALUE</span> <span class="params">(<span class="string">&#x27;$&#123;name&#125;&#x27;</span>)</span></span>;</span><br><span class="line"><span class="function">INSERT INTO <span class="title">user</span> <span class="params">(name)</span> <span class="title">VALUE</span> <span class="params">(<span class="string">&#x27;赵六&#x27;</span>)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h3><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Ender-PC</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存用户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">saveUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;saveUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.ender.entity.User&quot;</span>&gt;</span></span><br><span class="line">    insert into user (username,password) value (#&#123;username&#125;,#&#123;password&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="update"><a href="#update" class="headerlink" title="update"></a>update</h3><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Ender-PC</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新用户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.ender.entity.User&quot;</span>&gt;</span></span><br><span class="line">    update user set username = #&#123;username&#125; , password = #&#123;password&#125; where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h3><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Ender-PC</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id删除一个用户记录</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">deleteUser</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.lang.Integer&quot;</span>&gt;</span></span><br><span class="line">    delete from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="操作注释"><a href="#操作注释" class="headerlink" title="操作注释"></a>操作注释</h2><p>通常不推荐使用注释的方法，因为要保证代码遵循开闭原则，如果使用注释操作，今后修改时就需要修改源代码，违反了开闭原则</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Ender-PC</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/2/2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestAdmin</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String resource = <span class="string">&quot;mybatis-config.xml&quot;</span>;</span><br><span class="line">            InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">            SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">            session = sqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectAdmins</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//使用代理调用dao</span></span><br><span class="line">        AdminMapper mapper = session.getMapper(AdminMapper.class);</span><br><span class="line">        List&lt;Admin&gt; admins = mapper.selectAdmins();</span><br><span class="line">        <span class="keyword">for</span> (Admin admin : admins) &#123;</span><br><span class="line">            System.out.println(admin);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectAdminsById</span><span class="params">()</span></span>&#123;</span><br><span class="line">        AdminMapper mapper = session.getMapper(AdminMapper.class);</span><br><span class="line">        Admin admin = mapper.selectAdminById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(admin);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSaveAdmin</span><span class="params">()</span></span>&#123;</span><br><span class="line">        AdminMapper mapper = session.getMapper(AdminMapper.class);</span><br><span class="line">        Admin admin = <span class="keyword">new</span> Admin(<span class="number">4</span>, <span class="string">&quot;赵六&quot;</span>, <span class="string">&quot;123&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> rows = mapper.saveAdmin(admin);</span><br><span class="line">        System.out.println(rows);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateAdmin</span><span class="params">()</span></span>&#123;</span><br><span class="line">        AdminMapper mapper = session.getMapper(AdminMapper.class);</span><br><span class="line">        Admin admin = <span class="keyword">new</span> Admin(<span class="number">4</span>, <span class="string">&quot;赵六2&quot;</span>, <span class="string">&quot;dsjioa123&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> rows = mapper.updateAdmin(admin);</span><br><span class="line">        System.out.println(rows);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteAdmin</span><span class="params">()</span></span>&#123;</span><br><span class="line">        AdminMapper mapper = session.getMapper(AdminMapper.class);</span><br><span class="line">        <span class="keyword">int</span> rows = mapper.deleteAdmin(<span class="number">4</span>);</span><br><span class="line">        System.out.println(rows);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注册时需要选择类进行注册</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.ender.dao.AdminMapper&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="模糊查找"><a href="#模糊查找" class="headerlink" title="模糊查找"></a>模糊查找</h2><h3 id="Java代码中拼接字符串"><a href="#Java代码中拼接字符串" class="headerlink" title="Java代码中拼接字符串"></a>Java代码中拼接字符串</h3><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">string name = <span class="string">&quot;%IT%&quot;</span>;</span><br><span class="line"><span class="comment">//对于带有索引的字段，建议使用如下形式</span></span><br><span class="line"><span class="comment">//string name = &quot;IT%&quot;;</span></span><br><span class="line">list&lt;name&gt; names = mapper.getUserByName(name);</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span> = <span class="string">&quot;getUserByName&quot;</span>&gt;</span></span><br><span class="line">    select * from user where name like #&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="在配置文件中拼接"><a href="#在配置文件中拼接" class="headerlink" title="在配置文件中拼接"></a>在配置文件中拼接</h3><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string name = <span class="string">&quot;IT&quot;</span>;</span><br><span class="line">list&lt;name&gt; names = mapper.getUserByName(name);</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">    select * from user where name like &quot;%&quot;#&#123;name&#125;&quot;%&quot;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--此处必须用双引号--&gt;</span></span><br></pre></td></tr></table></figure><h2 id="map的使用"><a href="#map的使用" class="headerlink" title="map的使用"></a>map的使用</h2><p>map可以代替任何的实体类，所以当我们数据比较复杂时，可以适当考虑使用map来完成相关工作</p><ol><li>配置文件</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserByParams&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span> &gt;</span></span><br><span class="line">    select id,username,password from user where username = #&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>方法</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据一些参数查询</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> map</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUsersByParams</span><span class="params">(Map&lt;String,String&gt; map)</span></span>;</span><br></pre></td></tr></table></figure><ol start="3"><li>测试</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findByParams</span><span class="params">()</span></span>&#123;</span><br><span class="line">    UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">    Map&lt;String,String&gt; map = <span class="keyword">new</span> HashMap&lt;String,String&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;郑七&quot;</span>);</span><br><span class="line">    Lisr&lt;User&gt; users = mapper.getUsersByparams(map);</span><br><span class="line">    <span class="keyword">for</span>(User user: users)&#123;</span><br><span class="line">        System.out.println(user.getUsername());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多个参数"><a href="#多个参数" class="headerlink" title="多个参数"></a>多个参数</h2><p>对于单个参数的方法来说，mybatis将自动将参数对应到sql语句中，但若参数包含多个，可以使用如下方式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 通过字符串添加记录</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> password</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">saveAdmin</span><span class="params">(<span class="meta">@Param(&quot;username&quot;)</span> String username,<span class="meta">@Param(&quot;password&quot;)</span> String password)</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">insert into admin (username,password) values (#&#123;username&#125;,#&#123;password&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>使用多参数时，需要使用注释表明对应关系，其次还可以使用一个map传参，mybatis将通过key、value来处理关系</p><h2 id="别名"><a href="#别名" class="headerlink" title="别名"></a><a name="Alias">别名</a></h2><h3 id="内置别名"><a href="#内置别名" class="headerlink" title="内置别名"></a>内置别名</h3><hr><p>mybatis内置别名：</p><table><thead><tr><th>Alias</th><th>Mapped Type</th></tr></thead><tbody><tr><td>_byte</td><td>byte</td></tr><tr><td>_long</td><td>long</td></tr><tr><td>_short</td><td>short</td></tr><tr><td>_int</td><td>int</td></tr><tr><td>_integer</td><td>int</td></tr><tr><td>_double</td><td>double</td></tr><tr><td>_float</td><td>float</td></tr><tr><td>_boolean</td><td>boolean</td></tr><tr><td>string</td><td>String</td></tr><tr><td>byte</td><td>Byte</td></tr><tr><td>long</td><td>Long</td></tr><tr><td>short</td><td>Short</td></tr><tr><td>int</td><td>Integer</td></tr><tr><td>integer</td><td>Integer</td></tr><tr><td>double</td><td>Double</td></tr><tr><td>float</td><td>Float</td></tr><tr><td>boolean</td><td>Boolean</td></tr><tr><td>date</td><td>Date</td></tr><tr><td>decimal</td><td>BigDecimal</td></tr><tr><td>bigdecimal</td><td>BigDecimal</td></tr><tr><td>object</td><td>Obkect</td></tr><tr><td>map</td><td>Map</td></tr><tr><td>hashmap</td><td>HashMap</td></tr><tr><td>list</td><td>List</td></tr><tr><td>arraylist</td><td>ArrayList</td></tr><tr><td>collection</td><td>Collection</td></tr><tr><td>iterator</td><td>Iterator</td></tr></tbody></table><h3 id="自定义别名"><a href="#自定义别名" class="headerlink" title="自定义别名"></a>自定义别名</h3><hr><p>在核心配置文件中加入</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">&quot;com.ender.entity.User&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;user&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;typeAliases&gt;</code>标签需要在<code>&lt;enviroment&gt;</code>之前，基本顺序为：<code>&lt;properties&gt;</code>、<code>&lt;settings&gt;</code>、<code>typeAlias</code>、<code>typeHandlers</code>、、、、<code>&lt;environment&gt;</code></p><p><code>&lt;typeAlias&gt;</code>标签中有<code>type</code>和<code>alice</code>两个属性    </p><p><code>type</code>填写实体类的全类名，<code>alias</code>可以不填，不填默认为类名，不区分大小写，<code>alias</code>有值时以其中的值为准</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.ender.entity&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;package&gt;</code>标签为某个包下所有类起别名；<code>name</code>属性填写包名。包名默认是类名，不区分大小写</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Alias() 注解 加在实体类上，为某个类起别名：例如&#96;@Alias(&quot;User&quot;)&#96;</span><br></pre></td></tr></table></figure><h2 id="mybatis配置文件"><a href="#mybatis配置文件" class="headerlink" title="mybatis配置文件"></a>mybatis配置文件</h2><p>mybatis的配置文件分为：</p><ol><li>核心配置文件</li><li>mapper配置文件</li></ol><h3 id="核心配置文件"><a href="#核心配置文件" class="headerlink" title="核心配置文件"></a>核心配置文件</h3><hr><ul><li>mybatis-config.xml系统核心配置文件</li><li>核心配置文件主要配置mybatis一些基础组件和加载资源，核心配置文件中的元素常常能影响mybatis的整个运行过程</li><li>能配置的内容如下，顺序不能乱：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1. properties是一个配置属性的元素</span><br><span class="line">2. settings设置，mybatis最为复杂的配置也是最重要的，会改变mybatis运行时候的行为</span><br><span class="line">3. typeAliases别名（在Type AliasRegistry中可以看到mybatis提供了许多的系统别名）</span><br><span class="line">4. typeHandlers 类型处理器（比如在预处理语句中设置一个参数或者从结果集中获取一个参数的时候，都会用到类型处理器，在TypeHandlerRegistry中定义了很多的类型处理器）</span><br><span class="line">5. objectFactory 对象工厂 （mybatis在构建一个和结构或返回的时候，会使用一个objectFactory去构建pojo）</span><br><span class="line">6. plugins 插件</span><br><span class="line">7. environments 环境变量</span><br><span class="line">1. environment 环境变量</span><br><span class="line">1. transactionManager 事务管理器</span><br><span class="line">2. dataSource 数据源</span><br><span class="line">3. databaseIdProvider 数据库厂商标识</span><br><span class="line">8. mappers 映射器</span><br></pre></td></tr></table></figure><h3 id="environments元素"><a href="#environments元素" class="headerlink" title="environments元素"></a>environments元素</h3><hr><p>为mybatis配置多环境运行，将SQL映射到多个不同的数据库上，必须指定其中一个为默认运行环境（通过default指定），如果想切换环境修改default的值即可</p><p>最常见的就是，生产环境和开发环境，两个环境切换必将导致数据库的切换</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--事物管理器--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;...&quot;</span> <span class="attr">value</span>=<span class="string">&quot;...&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--数据源--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;product&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--事物管理器--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;...&quot;</span> <span class="attr">value</span>=<span class="string">&quot;...&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--数据源--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>dataSource 元素使用标准的JDBC数据源接口来配置JDBC连接对象的资源</p></li><li><p>数据源是必须配置的</p></li><li><p>有三种内建的数据源类型</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">type&#x3D;&quot;[UNPOOKED|POOKED|JNDI]&quot;</span><br><span class="line">- unpooked:这个数据源的实现只是每次被请求时打开和关闭连接</span><br><span class="line">- pooled:这种数据源的实现利用“池”的概念将JDBC连接对象组织起来，这是一种使得并发Web应用快速响应请求的流行处理方法</span><br><span class="line">- jndi:这个数据源实现时为了能在如spring或应用服务器中使用，容器可以集中或在外部配hi数据源，然后放置一个JNDI上下文引用</span><br></pre></td></tr></table></figure><ul><li><p>数据源也有很多第三方的实现，比如druid，dbcp，c3p0等等…</p></li><li><p>这两种事物管理器类型都不需要设置任何属性</p></li><li><p>具体的一套环境，通过设置id进行区别，id保证唯一</p></li><li><p>子元素节点：transactionManager - [事物管理器]</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 语法 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;[JDBC | MANAGED]&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><ul><li>子元素节点：数据源（dataSource）</li></ul><h3 id="mappers元素"><a href="#mappers元素" class="headerlink" title="mappers元素"></a>mappers元素</h3><hr><p>对写好的mapper和xml进行统一管理</p><p>引入方式</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 使用相对于类路径的资源引用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;com/ender/dao/userMapper.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 面向注解时使用全类名 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.ender.dao.AdminMapper&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--等等其他方式--&gt;</span></span><br></pre></td></tr></table></figure><p>Mapper文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.xinzhi.mapper.UserMapper&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>namespace：命名空间</li><li>namespace的命名必须跟某个接口同名</li></ul><h3 id="Properties元素"><a href="#Properties元素" class="headerlink" title="Properties元素"></a>Properties元素</h3><hr><p>数据库连接信息我们最好放在一个单独的文件中。 </p><ul><li>在资源目录下新建一个db.properties</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/ssm?</span></span><br><span class="line"><span class="attr">useSSL</span>=<span class="string">true&amp;useUnicode=true&amp;characterEncoding=utf8</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure><ul><li>导入properties配置文件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--导入properties文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;db.properties&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mapper/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="设定别名"><a href="#设定别名" class="headerlink" title="设定别名"></a>设定别名</h3><hr><p>详见<a href="#Alias">别名</a></p><h3 id="其他配置浏览"><a href="#其他配置浏览" class="headerlink" title="其他配置浏览"></a>其他配置浏览</h3><hr><p>settings能对我的一些核心功能进行配置，如懒加载、日志实现、缓存开启关闭等</p><p>简单参数说明：</p><details ><summary> 点击查看 </summary>              <div class='content'>              <table><thead><tr><th>设置参数</th><th>描述</th><th>有效值</th><th>默认值</th></tr></thead><tbody><tr><td>cacheEnabled</td><td>该配置影响的所有映射 器中配置的缓存的全局 开关。</td><td>true | false</td><td>true</td></tr><tr><td>lazyLoadingEnabled</td><td>延迟加载的全局开关。 当开启时，所有关联对 象都会延迟加载。特定 关联关系中可通过设置 fetchType属性来覆盖该 项的开关状态。</td><td>true | false</td><td>false</td></tr><tr><td>useColumnLabel</td><td>使用列标签代替列名。 不同的驱动在这方面会 有不同的表现，具体可 参考相关驱动文档或通 过测试这两种不同的模 式来观察所用驱动的结 果。</td><td>true | false</td><td>true</td></tr><tr><td>useGeneratedKeys</td><td>允许 JDBC 支持自动生 成主键，需要驱动兼 容。如果设置为 true 则 这个设置强制使用自动 生成主键，尽管一些驱 动不能兼容但仍可正常 工作（比如 Derby）。</td><td>true | false</td><td>False</td></tr><tr><td>defaultStatementTimeout</td><td>设置超时时间，它决定 驱动等待数据库响应的 秒数。</td><td>Any positive integer Not S</td><td>Not Set (null)</td></tr><tr><td>mapUnderscoreToCamelCase</td><td>是否开启自动驼峰命名 规则（camel case）映 射，即从经典数据库列 名 A_COLUMN 到经典 Java 属性名 aColumn 的类似映射。</td><td>true | false</td><td>False</td></tr><tr><td>logPrefix</td><td>指定 MyBatis 增加到日 志名称的前缀。</td><td>Any String</td><td>Not set</td></tr><tr><td>logImpl</td><td>指定 MyBatis 所用日志 的具体实现，未指定时 将自动查找。</td><td>SLF4J | LOG4J | LOG4J2 | JDK_LOGGING | COMMONS_LOGGING | STDOUT_LOGGING | NO_LOGGING</td><td>Not set</td></tr></tbody></table><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!----&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!----&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyLoadingEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!----&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;multipleResultSetsEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;useColumnLabel&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;useGeneratedKeys&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;autoMappingBehavior&quot;</span> <span class="attr">value</span>=<span class="string">&quot;PARTIAL&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;autoMappingUnknownColumnBehavior&quot;</span> <span class="attr">value</span>=<span class="string">&quot;WARNING&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;defaultExecutorType&quot;</span> <span class="attr">value</span>=<span class="string">&quot;SIMPLE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;defaultStatementTimeout&quot;</span> <span class="attr">value</span>=<span class="string">&quot;25&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;defaultFetchSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;100&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;safeRowBoundsEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;localCacheScope&quot;</span> <span class="attr">value</span>=<span class="string">&quot;SESSION&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;jdbcTypeForNull&quot;</span> <span class="attr">value</span>=<span class="string">&quot;OTHER&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyLoadTriggerMethods&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">value</span>=<span class="string">&quot;equals,clone,hashCode,toString&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="动态sql"><a href="#动态sql" class="headerlink" title="动态sql"></a>动态sql</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><hr><p>MyBatis提供了对SQL语句动态的组装能力，大量的判断都可以在 MyBatis的映射XML文件里面配置，以达到许多我们需要大量代码才能实现的功能，大大减少了我们编写代码的工作量。 动态SQL的元素</p><p>动态SQL中的元素</p><table><thead><tr><th>元素</th><th>作用</th><th>备注</th></tr></thead><tbody><tr><td>if</td><td>判断语句</td><td>但条件分支判断</td></tr><tr><td>choose、when、otherwise</td><td>相当于java中的case when语句</td><td>多条件分支判断</td></tr><tr><td>trim、where、set</td><td>辅助元素</td><td>用于处理一些SQL拼装问题</td></tr><tr><td>foreach</td><td>循环语句</td><td>在in语句等列举调价常用</td></tr></tbody></table><h3 id="if元素（常用）"><a href="#if元素（常用）" class="headerlink" title="if元素（常用）"></a>if元素（常用）</h3><hr><p>if元素相当于Java中的if语句，它常常与test属性联合使用。现在我们要根据username去查询用户，但是username是可选的，如下所示：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.ender.entity.User&quot;</span>&gt;</span></span><br><span class="line">    select id,username,password from user</span><br><span class="line">    where 1 =1</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;id != null and id != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">        AND id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;username != null and username != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">        AND username = #&#123;username&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;password != null and password != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">        AND password = #&#123;password&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="choose、when、otherwise元素"><a href="#choose、when、otherwise元素" class="headerlink" title="choose、when、otherwise元素"></a>choose、when、otherwise元素</h3><hr><p>有些时候我们还需要多种条件的选择，在Java中我们可以使用switch、case、default语句，而在映射器 的动态语句中可以使用choose、when、otherwise元素</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 有name的时候使用name搜索，没有的时候使用id搜索 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;select&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.ender.entity.User&quot;</span>&gt;</span></span><br><span class="line">    SELECT * FROM user</span><br><span class="line">    WHERE 1=1</span><br><span class="line">    <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;name != null and name != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            AND username LIKE concat(&#x27;%&#x27;, #&#123;username&#125;, &#x27;%&#x27;)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;id != null&quot;</span>&gt;</span></span><br><span class="line">            AND id = #&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="where元素"><a href="#where元素" class="headerlink" title="where元素"></a>where元素</h3><hr><p>上面的select语句我们加了一个 1=1 的绝对true的语句，目的是为了防止语句错误，变成 SELECT * FROM student WHERE 这样where后没有内容的错误语句。这样会有点奇怪，此时可以使用where元素。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.xinzhi.entity.User&quot;</span>&gt;</span></span><br><span class="line">    select id,username,password from user</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;id != null and id != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            AND id = #&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;username != null and username != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            AND username = #&#123;username&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;password != null and password != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            AND password = #&#123;password&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="trim元素"><a href="#trim元素" class="headerlink" title="trim元素"></a>trim元素</h3><hr><p>有时候我们要去掉一些特殊的SQL语法，比如常见的and、or，此时可以使用trim元素。trim元素意味着 我们需要去掉一些特殊的字符串，prefix代表的是语句的前缀，而prefixOverrides代表的是你需要去掉 的那种字符串，suffix表示语句的后缀，suffixOverrides代表去掉的后缀字符串。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;saveUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.ender.entity.User&quot;</span>&gt;</span></span><br><span class="line">    insert into user</span><br><span class="line">    (</span><br><span class="line">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">suffixOverrides</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;username != null and username != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            username,</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;password != null and password != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            password,</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">    )value(</span><br><span class="line">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">suffixOverrides</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;username != null and username != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            #&#123;username&#125;,</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;password != null and password != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            #&#123;password&#125;,</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">    )</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="set元素"><a href="#set元素" class="headerlink" title="set元素"></a>set元素</h3><hr><p>在update语句中，如果我们只想更新某几个字段的值，这个时候可以使用set元素配合if元素来完成。注 意：set元素遇到,会自动把,去掉。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.ender.entity.User&quot;</span>&gt;</span></span><br><span class="line">    update user</span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;username != null and username != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            username = #&#123;username&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;password != null and password != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            password = #&#123;password&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="foreach元素"><a href="#foreach元素" class="headerlink" title="foreach元素"></a>foreach元素</h3><hr><p>foreach元素是一个循环语句，它的作用是遍历集合，可以支持数组、List、Set接口。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;select&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.xinzhi.entity.User&quot;</span>&gt;</span></span><br><span class="line">    SELECT * FROM user</span><br><span class="line">    WHERE id IN</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;ids&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">item</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">        #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>collection配置的是传递进来的参数名称 </li><li>item配置的是循环中当前的元素。 </li><li>index配置的是当前元素在集合的位置下标。 </li><li>open和 close配置的是以什么符号将这些集合元素包装起来。 </li><li>separator是各个元素的间隔符。</li></ul><h3 id="SQL片段"><a href="#SQL片段" class="headerlink" title="SQL片段"></a>SQL片段</h3><hr><p>有时候可能某个 sql 语句我们用的特别多，为了增加代码的重用性，简化代码，我们需要将这些代码抽 取出来，然后使用时直接调用。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;user-all-content&quot;</span>&gt;</span></span><br><span class="line">    select id,username,password from user</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure><p>引用</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;user-all-content&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h2 id="结果映射resultMap"><a href="#结果映射resultMap" class="headerlink" title="结果映射resultMap"></a>结果映射resultMap</h2><p>数据库不可能永远是你所想或所需的那个样子 </p><p>属性名和字段名不一致，我们一般都会按照约定去设计数据的，但确实阻止不了沟通不充分等问题</p><ol><li>java中实体类的设计</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id; <span class="comment">//id</span></span><br><span class="line">    <span class="keyword">private</span> String name; <span class="comment">//姓名，数据库为username</span></span><br><span class="line">    <span class="keyword">private</span> String password; <span class="comment">//密码，一致</span></span><br><span class="line">    <span class="comment">//构造</span></span><br><span class="line">    <span class="comment">//set/get</span></span><br><span class="line">    <span class="comment">//toString()</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>mapper类</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据id查询用户</span></span><br><span class="line"><span class="function">User <span class="title">selectUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure><ol start="3"><li>mapper映射文件</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">    select * from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>测试</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectUserById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">    User user = mapper.selectUserById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h3><hr><ul><li>User{id=1,name=’null’,password=’123’}</li><li>查询出来发现name为空</li></ul><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><hr><ul><li>select * from user where id = #{id} 可以看做 select id,username,password from user where id = #{id}</li><li>mybatis会根据这些查询的列名(会将列名转化为小写,数据库不区分大小写) , 利用反射去对应的实体类中查找相应列名的set方法设值 ，当然找不到username<h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3></li></ul><hr><h4 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h4><hr><p>为列名指定别名，别名和java实体类的属性名一致</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    select id , username as name ,password from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h4><hr><p>使用结果集映射$\to$ResultMap(推荐)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;UserMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- id为主键 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- column是数据库表的列名 , property是对应实体类的属性名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;username&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- id表示表中的主键，需要独立设置，result表示其他字段--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;password&quot;</span> <span class="attr">property</span>=<span class="string">&quot;password&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserById&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;UserMap&quot;</span>&gt;</span></span><br><span class="line">    select id , username , password from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="常用映射"><a href="#常用映射" class="headerlink" title="常用映射"></a>常用映射</h3><hr><p>通常在数据库中我们会使用下划线的命名方式，而java中通常使用驼峰命名法，mybatis为我们提供了两者的自动转化</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--开启驼峰命名规则--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="日志配置"><a href="#日志配置" class="headerlink" title="日志配置"></a>日志配置</h2><p>配置日志的一个重要原因是想在调试的时候能观察到sql语句的输出，能查看中间过程</p><h3 id="标准日志实现"><a href="#标准日志实现" class="headerlink" title="标准日志实现"></a>标准日志实现</h3><hr><p>指定 MyBatis 应该使用哪个日志记录实现。如果此设置不存在，则会自动发现日志记录实现。 </p><p>STD：standard out：输出 </p><p>STDOUT_LOGGING：标准输出日志</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="组合log4j完成日志功能"><a href="#组合log4j完成日志功能" class="headerlink" title="组合log4j完成日志功能"></a>组合log4j完成日志功能</h3><hr><ol><li>导入log4j</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-nop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.30<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>配置文件编写log4j.properties</li></ol><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将等级为DEBUG的日志信息输出到console和file这两个目的地，console和file的定义在下面的代</span></span><br><span class="line"><span class="attr">码</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">DEBUG,console,file</span></span><br><span class="line"><span class="comment">#控制台输出的相关设置</span></span><br><span class="line"><span class="meta">log4j.appender.console</span> = <span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.console.Target</span> = <span class="string">System.out</span></span><br><span class="line"><span class="meta">log4j.appender.console.Threshold</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout.ConversionPattern</span>=<span class="string">[%c]-%m%n</span></span><br><span class="line"><span class="comment">#文件输出的相关设置</span></span><br><span class="line"><span class="meta">log4j.appender.file</span> = <span class="string">org.apache.log4j.RollingFileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.file.File</span>=<span class="string">./log/xinzhi.log</span></span><br><span class="line"><span class="meta">log4j.appender.file.MaxFileSize</span>=<span class="string">10mb</span></span><br><span class="line"><span class="meta">log4j.appender.file.Threshold</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout.ConversionPattern</span>=<span class="string">[%p][%d&#123;yy-MM-dd&#125;][%c]%m%n</span></span><br><span class="line"><span class="comment">#日志输出级别</span></span><br><span class="line"><span class="meta">log4j.logger.org.mybatis</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.Statement</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.ResultSet</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.PreparedStatement</span>=<span class="string">DEBUG</span></span><br></pre></td></tr></table></figure><ol start="3"><li>setting设置日志实现</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;LOG4J&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>在程序中使用Log4j进行输出</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findAllUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">    List&lt;User&gt; users = mapper.selectUser();</span><br><span class="line">    <span class="keyword">for</span> (User user: users)&#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><h3 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h3><hr><ul><li>部门和员工的关系为：一个部门多个员工，一个员工属于一个部门</li><li>依次我们可以实际一个一对多的数据库</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE &#96;dept&#96; (</span><br><span class="line">&#96;id&#96; INT(10) NOT NULL,</span><br><span class="line">&#96;name&#96; VARCHAR(30) DEFAULT NULL,</span><br><span class="line">PRIMARY KEY (&#96;id&#96;)</span><br><span class="line">);</span><br><span class="line">INSERT INTO dept VALUES (1, &#39;ender开发六部&#39;);</span><br><span class="line">CREATE TABLE &#96;employee&#96; (</span><br><span class="line">&#96;id&#96; INT(10) NOT NULL,</span><br><span class="line">&#96;name&#96; VARCHAR(30) DEFAULT NULL,</span><br><span class="line">&#96;did&#96; INT(10) DEFAULT NULL,</span><br><span class="line">PRIMARY KEY (&#96;id&#96;),</span><br><span class="line">CONSTRAINT &#96;fk_did&#96; FOREIGN KEY (&#96;did&#96;) REFERENCES &#96;dept&#96; (&#96;id&#96;)</span><br><span class="line">);</span><br><span class="line">INSERT INTO employee VALUES (1, &#39;小兰&#39;, 1);</span><br><span class="line">INSERT INTO employee VALUES (2, &#39;小红&#39;, 1);</span><br><span class="line">INSERT INTO employee VALUES (3, &#39;小白&#39;, 1);</span><br><span class="line">INSERT INTO employee VALUES (4, &#39;小黑&#39;, 1);</span><br><span class="line">INSERT INTO employee VALUES (5, &#39;小黄&#39;, 1);</span><br></pre></td></tr></table></figure><h3 id="在多的一方维护关系"><a href="#在多的一方维护关系" class="headerlink" title="在多的一方维护关系"></a>在多的一方维护关系</h3><hr><h4 id="方法一：结果集嵌套"><a href="#方法一：结果集嵌套" class="headerlink" title="方法一：结果集嵌套"></a>方法一：结果集嵌套</h4><hr><h5 id="编写实体类-1"><a href="#编写实体类-1" class="headerlink" title="编写实体类"></a>编写实体类</h5><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Ender-PC</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/2/6</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dept</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Ender-PC</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/2/6</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 外键Dept，维护关系</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Dept dept;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="编写实体类对应的Mapper接口"><a href="#编写实体类对应的Mapper接口" class="headerlink" title="编写实体类对应的Mapper接口"></a>编写实体类对应的Mapper接口</h5><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DeptMapper</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmployeeMapper</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="编写mapper-xml"><a href="#编写mapper-xml" class="headerlink" title="编写mapper.xml"></a>编写mapper.xml</h5><hr><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.ender.mapper.EmployeeMapper&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.ender.mapper.DeptMapper&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="编写方法"><a href="#编写方法" class="headerlink" title="编写方法"></a>编写方法</h5><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 按id获取指定员工信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> employee</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Employee <span class="title">findEmployeesById</span><span class="params">(Integer id)</span></span>;</span><br></pre></td></tr></table></figure><h5 id="mapper处理"><a href="#mapper处理" class="headerlink" title="mapper处理"></a>mapper处理</h5><hr><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.ender.mapper.EmployeeMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;EmployeeDept&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.ender.entity.Employee&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--起别名后需要设置映射关系--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;ename&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指定包含类的映射关系--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.ender.entity.Dept&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dname&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findEmployeesById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;EmployeeDept&quot;</span>&gt;</span></span><br><span class="line">        SELECT e.id eid, e.name ename,d.id did,d.name dname</span><br><span class="line">        FROM employee e</span><br><span class="line">        LEFT JOIN dept d</span><br><span class="line">        on e.did = d.id where e.id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="注册Mapper"><a href="#注册Mapper" class="headerlink" title="注册Mapper"></a>注册Mapper</h5><hr><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mappers/DeptMapper.xml&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mappers/employeeMapper.xml&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h5 id="测试-1"><a href="#测试-1" class="headerlink" title="测试"></a>测试</h5><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindEmployessById</span><span class="params">()</span></span>&#123;</span><br><span class="line">    EmployeeMapper mapper = session.getMapper(EmployeeMapper.class);</span><br><span class="line">    Employee employee = mapper.findEmployeesById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(employee);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="方法二：查询嵌套"><a href="#方法二：查询嵌套" class="headerlink" title="方法二：查询嵌套"></a>方法二：查询嵌套</h4><hr><h5 id="编写mapper-xml-1"><a href="#编写mapper-xml-1" class="headerlink" title="编写mapper.xml"></a>编写mapper.xml</h5><hr><p>employeeMapper.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.ender.mapper.EmployeeMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;EmployeeDept&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.ender.entity.Employee&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--使用select标签将第二步的查询委托给另外的mapper--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.ender.entity.Dept&quot;</span> <span class="attr">select</span>=<span class="string">&quot;com.ender.mapper.DeptMapper.findDeptById&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findEmployeesById&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;EmployeeDept&quot;</span>&gt;</span></span><br><span class="line">        SELECT id,name,did FROM employee WHERE id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><p>deptMapper.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.ender.mapper.DeptMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--起别名后记得定义映射关系--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;DeptResult&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.ender.entity.Dept&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findDeptById&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;DeptResult&quot;</span>&gt;</span></span><br><span class="line">        SELECT id did,name FROM dept WHERE id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="在一的一方维护关系"><a href="#在一的一方维护关系" class="headerlink" title="在一的一方维护关系"></a>在一的一方维护关系</h3><hr><p>即查找所有部门时，将该部门下的所有员工一并查找出来</p><h4 id="方法一：结果集嵌套-1"><a href="#方法一：结果集嵌套-1" class="headerlink" title="方法一：结果集嵌套"></a>方法一：结果集嵌套</h4><hr><h5 id="实体类"><a href="#实体类" class="headerlink" title="实体类"></a>实体类</h5><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Ender-PC</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/2/6</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dept</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 该部门下的所有员工</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;Employee&gt; employees;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h5><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Ender-PC</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/2/6</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DeptMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查找所有部门信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> deptList</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;Dept&gt; <span class="title">findDepts</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="Mapper配置"><a href="#Mapper配置" class="headerlink" title="Mapper配置"></a>Mapper配置</h5><hr><p>DeptMapper.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.ender.mapper.DeptMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;DeptEmployees&quot;</span> <span class="attr">type</span>=<span class="string">&quot;dept&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dname&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--一对多时使用collection标签，在映射数组类型时，需要使用ofType属性来指定类型，告知mybatis该List中的元素属于类，而JavaType用于告诉mybatis，映射参数的类型--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;employees&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;employee&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;ename&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findDepts&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;DeptEmployees&quot;</span>&gt;</span></span><br><span class="line">        SELECT d.id did,d.name dname,e.id eid,e.name ename</span><br><span class="line">        FROM dept d</span><br><span class="line">        LEFT JOIN employee e on d.id = e.did</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="方法二：查询嵌套-1"><a href="#方法二：查询嵌套-1" class="headerlink" title="方法二：查询嵌套"></a>方法二：查询嵌套</h4><hr><h5 id="Mapper配置-1"><a href="#Mapper配置-1" class="headerlink" title="Mapper配置"></a>Mapper配置</h5><hr><p>DeptMapper.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.ender.mapper.DeptMapper&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    查询嵌套--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;deptEmpResult&quot;</span> <span class="attr">type</span>=<span class="string">&quot;dept&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--代理给Employee下的查询语句查询--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;employees&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;employee&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">select</span>=<span class="string">&quot;com.ender.mapper.EmployeeMapper.findEmployeesByDid&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findDepts&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;deptEmpResult&quot;</span>&gt;</span></span><br><span class="line">        SELECT id,name FROM dept</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><p>EmployeeMapper.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.ender.mapper.EmployeeMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findEmployeesByDid&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;employee&quot;</span>&gt;</span></span><br><span class="line">        SELECT id,name,did FROM employee WHERE did = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Mybatis缓存"><a href="#Mybatis缓存" class="headerlink" title="Mybatis缓存"></a>Mybatis缓存</h2><h3 id="为什么需要缓存"><a href="#为什么需要缓存" class="headerlink" title="为什么需要缓存"></a>为什么需要缓存</h3><hr><ul><li>如果缓存中有数据，就不用从数据库获取，大大提高系统性能</li><li>mybatis提供一级缓存和二级缓存</li></ul><h3 id="一级缓存"><a href="#一级缓存" class="headerlink" title="一级缓存"></a>一级缓存</h3><hr><p>一级缓存是sqlsession级别的缓存</p><ul><li>操作数据库时，需要构造sqlsession对象，在对象中有一个数据结构（HashMap）用于存储缓存数据</li><li>不同的sqlsession之间的缓存区域时互不影响的</li></ul><h4 id="一级缓存工作原理"><a href="#一级缓存工作原理" class="headerlink" title="一级缓存工作原理"></a>一级缓存工作原理</h4><hr><p><img src="F:\Enderblog\source\img\一级缓存工作原理.png" class="lazyload placeholder" data-srcset="F:\Enderblog\source\img\一级缓存工作原理.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="image-20210207163050284"></p><ul><li>第一次发起查询sql查询用户id为1的用户，先去找缓存中是否有id为1的用户，如果没有，再去数据库查询用户信息。得到用户信息，将用户信息存储到一级缓存中。 </li><li>如果sqlsession执行了commit操作（插入，更新，删除），会清空sqlsession中的一级缓存，避免脏读 </li><li>第二次发起查询id为1的用户，缓存中如果找到了，直接从缓存中获取用户信息 mybatis默认支持并开启一级缓存。</li></ul><p>可以通过mybatis写入日志时是否调用了MySQL语句来判断缓存是否被调用</p><h4 id="测试-2"><a href="#测试-2" class="headerlink" title="测试"></a>测试</h4><hr><h5 id="编写接口方法"><a href="#编写接口方法" class="headerlink" title="编写接口方法"></a>编写接口方法</h5><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据id查询用户</span></span><br><span class="line"><span class="function">User <span class="title">findUserById</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure><h5 id="Mapper配置-2"><a href="#Mapper配置-2" class="headerlink" title="Mapper配置"></a>Mapper配置</h5><hr><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.ender.entity.User&quot;</span>&gt;</span></span><br><span class="line">select * from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="测试-3"><a href="#测试-3" class="headerlink" title="测试"></a>测试</h5><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindUserById</span><span class="params">()</span></span>&#123;</span><br><span class="line">UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">User user1 = mapper.findUserById(<span class="number">1</span>);</span><br><span class="line">System.out.println(user1);</span><br><span class="line">User user2 = mapper.findUserById(<span class="number">3</span>);</span><br><span class="line">System.out.println(user2);</span><br><span class="line">User user3 = mapper.findUserById(<span class="number">1</span>);</span><br><span class="line">System.out.println(user3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h5><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[com.xinzhi.dao.UserMapper.findUserById]-&#x3D;&#x3D;&gt; Preparing: select</span><br><span class="line">id,username,password from user where id &#x3D; ?</span><br><span class="line">[com.xinzhi.dao.UserMapper.findUserById]-&#x3D;&#x3D;&gt; Parameters: 1(Integer)</span><br><span class="line">[com.xinzhi.dao.UserMapper.findUserById]-&lt;&#x3D;&#x3D; Total: 1</span><br><span class="line">User&#123;id&#x3D;1, username&#x3D;&#39;楠哥&#39;, password&#x3D;&#39;123456&#39;&#125; ----&gt;ID为1，第一次有sql</span><br><span class="line">[com.xinzhi.dao.UserMapper.findUserById]-&#x3D;&#x3D;&gt; Preparing: select</span><br><span class="line">id,username,password from user where id &#x3D; ?</span><br><span class="line">[com.xinzhi.dao.UserMapper.findUserById]-&#x3D;&#x3D;&gt; Parameters: 3(Integer)</span><br><span class="line">[com.xinzhi.dao.UserMapper.findUserById]-&lt;&#x3D;&#x3D; Total: 1</span><br><span class="line">User&#123;id&#x3D;3, username&#x3D;&#39;磊哥&#39;, password&#x3D;&#39;987654&#39;&#125; ----&gt;ID为3，第一次有sql</span><br><span class="line">User&#123;id&#x3D;1, username&#x3D;&#39;楠哥&#39;, password&#x3D;&#39;123456&#39;&#125; ----&gt;ID为1，第二次无sql，</span><br><span class="line">走缓存</span><br></pre></td></tr></table></figure><h5 id="一级缓存失效"><a href="#一级缓存失效" class="headerlink" title="一级缓存失效"></a>一级缓存失效</h5><hr><ol><li>sqlSession不同 </li><li>当sqlSession对象相同的时候，查询的条件不同，原因是第一次查询时候一级缓存中没有第二次查询所需要的数据 </li><li>当sqlSession对象相同,两次查询之间进行了插入的操作</li><li>当sqlSession对象相同,手动清除了一级缓存中的数据</li></ol><h3 id="二级缓存"><a href="#二级缓存" class="headerlink" title="二级缓存"></a>二级缓存</h3><hr><p>二级缓存时mapper级别的缓存，默认关闭</p><ul><li>多个SQL session去操作同一个mapper的sql语句，多个sqlsession可以共用二级缓存，所得到的数据会存在二级缓存区域</li><li>二级缓存时跨sqlsession的</li><li>二级缓存相比一级缓存的范围更大（按namespace划分），多个sqlsession可以共享一个二级缓存</li></ul><p><img src="F:\Enderblog\source\img\二级缓存工作原理1.png" class="lazyload placeholder" data-srcset="F:\Enderblog\source\img\二级缓存工作原理1.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="image-20210208131638840"></p><p><img src="F:\Enderblog\source\img\二级缓存工作原理2.png" class="lazyload placeholder" data-srcset="F:\Enderblog\source\img\二级缓存工作原理2.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="image-20210208131728065"></p><h4 id="打开二级缓存"><a href="#打开二级缓存" class="headerlink" title="打开二级缓存"></a>打开二级缓存</h4><hr><p>首先要手动开启mybatis二级缓存。 在config.xml设置二级缓存开关 ， 还要在具体的mapper.xml开启二级缓存</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--开启二级缓存--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 需要将映射的javabean类实现序列化 --&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--开启本Mapper的namespace下的二级缓存--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">eviction</span>=<span class="string">&quot;LRU&quot;</span> <span class="attr">flushInterval</span>=<span class="string">&quot;100000&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h4 id="cache属性的简介"><a href="#cache属性的简介" class="headerlink" title="cache属性的简介"></a>cache属性的简介</h4><hr><h5 id="eviction"><a href="#eviction" class="headerlink" title="eviction"></a>eviction</h5><hr><p>回收策略（缓存满了的淘汰机制），目前MyBatis提供以下策略。</p><ol><li><p>LRU（Least Recently Used）,最近最少使用的，最长时间不用的对象 </p></li><li><p>FIFO（First In First Out）,先进先出，按对象进入缓存的顺序来移除他们 </p></li><li><p>SOFT,软引用，移除基于垃圾回收器状态和软引用规则的对象 </p></li><li><p>WEAK,弱引用，更积极的移除基于垃圾收集器状态和弱引用规则的对象。这里采用的是LRU， 移除最长时间不用的对形象 </p></li></ol><h5 id="flushInterval"><a href="#flushInterval" class="headerlink" title="flushInterval"></a>flushInterval</h5><hr><p>刷新间隔时间，单位为毫秒</p><ol><li>这里配置的是100秒刷新，如果你不配置它，那么当SQL被执行的时候才会去刷新缓存。 </li></ol><h5 id="size"><a href="#size" class="headerlink" title="size"></a>size</h5><hr><p>引用数目</p><ol><li>一个正整数，代表缓存最多可以存储多少个对象，不宜设置过大。设置过大会导致内存溢出。 这里配置的是1024个对象 </li></ol><h5 id="readOnly"><a href="#readOnly" class="headerlink" title="readOnly"></a>readOnly</h5><hr><p>只读</p><ol><li>意味着缓存数据只能读取而不能修改，这样设置的好处是我们可以快速读取缓存，缺点是我们没有办法修改缓存，他的默认值是false，不允许我们修改</li></ol><h4 id="操作过程"><a href="#操作过程" class="headerlink" title="操作过程"></a>操作过程</h4><hr><p>sqlsession1查询用户id为1的信息，查询到之后，会将查询数据存储到二级缓存中。 </p><p>如果sqlsession3去执行相同mapper下sql，执行commit提交，会清空该mapper下的二级缓存区域的数据 </p><p>sqlsession2查询用户id为1的信息，去缓存找是否存在缓存，如果存在直接从缓存中取数据</p><h5 id="禁用二级缓存"><a href="#禁用二级缓存" class="headerlink" title="禁用二级缓存"></a>禁用二级缓存</h5><hr><p>在statement中可以设置useCache=false，禁用当前select语句的二级缓存，默认情况为true</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.lang.Integer&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">resultType</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">useCache</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在实际开发中，针对每次查询都需要最新的数据sql，要设置为useCache=”false” ，禁用二级缓存</p><h5 id="flushCache标签"><a href="#flushCache标签" class="headerlink" title="flushCache标签"></a>flushCache标签</h5><hr><p>刷新缓存（清空缓存）</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudentById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.lang.Integer&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">resultType</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">flushCache</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>一般下执行完commit操作都需要刷新缓存，flushCache=”true 表示刷新缓存，可以避免脏读</p><blockquote><p>脏读：当数据保存在缓存中时，使用修改操作将数据库中的数据修改，此时，缓存中的数据和数据库中的不一样，于是下次读操作若从缓存中读取，则会出现读到的数据不是正确的数据的情况</p></blockquote><h5 id="二级缓存应用场景"><a href="#二级缓存应用场景" class="headerlink" title="二级缓存应用场景"></a>二级缓存应用场景</h5><hr><p>对于访问多的查询请求并且用户对查询结果实时性要求不高的情况下，可采用mybatis二级缓存，降低 数据库访问量，提高访问速度，如电话账单查询 根据需求设置相应的flushInterval:刷新间隔时间，比如三十分钟，24小时等。</p><h5 id="二级缓存局限性"><a href="#二级缓存局限性" class="headerlink" title="二级缓存局限性"></a>二级缓存局限性</h5><hr><p>mybatis二级缓存对细粒度的数据级别的缓存实现不好，比如如下需求:对商品信息进行缓存，由于商品 信息查询访问量大，但是要求用户每次都能查询最新的商品信息，此时如果使用mybatis的二级缓存就 无法实现当一个商品变化时只刷新该商品的缓存信息而不刷新其它商品的信息，因为mybaits的二级缓 存区域以mapper为单位划分，当一个商品信息变化会将所有商品信息的缓存数据全部清空。解决此类 问题需要在业务层根据需求对数据有针对性缓存。</p><h5 id="测试-4"><a href="#测试-4" class="headerlink" title="测试"></a>测试</h5><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindUserCache</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">//使用不同的mapper</span></span><br><span class="line">    UserMapper mapper1 = session.getMapper(UserMapper.class);</span><br><span class="line">    User user1 = mapper1.findUserById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(user1);</span><br><span class="line">    <span class="comment">//提交了就会刷到二级缓存，要不还在一级缓存，一定要注意</span></span><br><span class="line">    session.commit();</span><br><span class="line">    UserMapper mapper2 = session.getMapper(UserMapper.class);</span><br><span class="line">    User user2 = mapper2.findUserById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(user2);</span><br><span class="line">    System.out.println(user1 == user2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="结果-1"><a href="#结果-1" class="headerlink" title="结果"></a>结果</h5><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[com.ender.dao.UserMapper.findUserById]-&#x3D;&#x3D;&gt; Preparing: select</span><br><span class="line">id,username,password from user where id &#x3D; ?</span><br><span class="line">[com.ender.dao.UserMapper.findUserById]-&#x3D;&#x3D;&gt; Parameters: 1(Integer)</span><br><span class="line">[com.ender.dao.UserMapper.findUserById]-&lt;&#x3D;&#x3D; Total: 1</span><br><span class="line">User&#123;id&#x3D;1, username&#x3D;&#39;ender&#39;, password&#x3D;&#39;123456&#39;&#125;</span><br><span class="line">[com.ender.dao.UserMapper.findUserById]-&#x3D;&#x3D;&gt; Preparing: select</span><br><span class="line">id,username,password from user where id &#x3D; ?</span><br><span class="line">[com.ender.dao.UserMapper.findUserById]-&#x3D;&#x3D;&gt; Parameters: 1(Integer)</span><br><span class="line">[com.ender.dao.UserMapper.findUserById]-&lt;&#x3D;&#x3D; Total: 1</span><br><span class="line">User&#123;id&#x3D;1, username&#x3D;&#39;ender&#39;, password&#x3D;&#39;123456&#39;&#125;</span><br><span class="line">false ----&gt;两个对象不是一个，发了两个sql，说明缓存没有起作用</span><br></pre></td></tr></table></figure><p>可以看见两次同样的sql，却都进库进行了查询。说明二级缓存没开。</p><h5 id="开启二级缓存"><a href="#开启二级缓存" class="headerlink" title="开启二级缓存"></a>开启二级缓存</h5><hr><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h5 id="Mapper"><a href="#Mapper" class="headerlink" title="Mapper"></a>Mapper</h5><hr><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--开启本Mapper的namespace下的二级缓存--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">eviction</span>=<span class="string">&quot;LRU&quot;</span> <span class="attr">flushInterval</span>=<span class="string">&quot;100000&quot;</span> <span class="attr">size</span>=<span class="string">&quot;512&quot;</span> <span class="attr">readOnly</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">cache</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">创建了一个 LRU 最少使用清除缓存，每隔 100 秒刷新，最多可以存储 512 个对象，返回的对象是只</span></span><br><span class="line"><span class="comment">读的。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><h5 id="测试-5"><a href="#测试-5" class="headerlink" title="测试"></a>测试</h5><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[com.ender.dao.UserMapper.findUserById]-&#x3D;&#x3D;&gt; Preparing: select</span><br><span class="line">id,username,password from user where id &#x3D; ?</span><br><span class="line">[com.ender.dao.UserMapper.findUserById]-&#x3D;&#x3D;&gt; Parameters: 1(Integer)</span><br><span class="line">[com.ender.dao.UserMapper.findUserById]-&lt;&#x3D;&#x3D; Total: 1</span><br><span class="line">User&#123;id&#x3D;1, username&#x3D;&#39;ender&#39;, password&#x3D;&#39;123456&#39;&#125;</span><br><span class="line">[com.ender.dao.UserMapper]-Cache Hit Ratio [com.ender.dao.UserMapper]: 0.5</span><br><span class="line">User&#123;id&#x3D;1, username&#x3D;&#39;ender&#39;, password&#x3D;&#39;123456&#39;&#125;</span><br><span class="line">true ----&gt;两个对象一样了，就发了一个sql，说明缓存起了作用</span><br></pre></td></tr></table></figure><h3 id="第三方缓存——EhCache充当三级缓存"><a href="#第三方缓存——EhCache充当三级缓存" class="headerlink" title="第三方缓存——EhCache充当三级缓存"></a>第三方缓存——EhCache充当三级缓存</h3><hr><p>我们的三方缓存组件很对，最常用的比如ehcache，Memcached、redis等，我们以比较简单的 ehcache为例。</p><h4 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h4><hr><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis.caches/mybatis-ehcache --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.caches<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-ehcache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Mapper-1"><a href="#Mapper-1" class="headerlink" title="Mapper"></a>Mapper</h4><hr><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span> = <span class="string">&quot;com.ender.entity.User&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cache</span> <span class="attr">type</span>=<span class="string">&quot;org.mybatis.caches.ehcache.EhcacheCache&quot;</span> <span class="attr">eviction</span>=<span class="string">&quot;LRU&quot;</span></span></span><br><span class="line"><span class="tag">           <span class="attr">flushInterval</span>=<span class="string">&quot;10000&quot;</span> <span class="attr">size</span>=<span class="string">&quot;1024&quot;</span> <span class="attr">readOnly</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="ehcache配置"><a href="#ehcache配置" class="headerlink" title="ehcache配置"></a>ehcache配置</h4><hr><p>添加ehcache.xml文件，ehcache配置文件，具体配置自行百度</p><details yellow><summary> 点击查看配置文件 </summary>              <div class='content'>              <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ehcache</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:noNamespaceSchemaLocation</span>=<span class="string">&quot;http://ehcache.org/ehcache.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">updateCheck</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">diskStore：为缓存路径，ehcache分为内存和磁盘两级，此属性定义磁盘的缓存位置。参数</span></span><br><span class="line"><span class="comment">解释如下：</span></span><br><span class="line"><span class="comment">user.home – 用户主目录</span></span><br><span class="line"><span class="comment">user.dir – 用户当前工作目录</span></span><br><span class="line"><span class="comment">java.io.tmpdir – 默认临时文件路径</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">diskStore</span> <span class="attr">path</span>=<span class="string">&quot;./tmpdir/Tmp_EhCache&quot;</span>/&gt;</span></span><br><span class="line">    &lt;defaultCache</span><br><span class="line">                  eternal=&quot;false&quot;</span><br><span class="line">                  maxElementsInMemory=&quot;10000&quot;</span><br><span class="line">                  overflowToDisk=&quot;false&quot;</span><br><span class="line">                  diskPersistent=&quot;false&quot;</span><br><span class="line">                  timeToIdleSeconds=&quot;1800&quot;</span><br><span class="line">                  timeToLiveSeconds=&quot;259200&quot;</span><br><span class="line">                  memoryStoreEvictionPolicy=&quot;LRU&quot;/&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">ehcache</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">name:缓存名称。</span></span><br><span class="line"><span class="comment">maxElementsInMemory：缓存最大个数。</span></span><br><span class="line"><span class="comment">eternal:对象是否永久有效，一但设置了，timeout将不起作用。</span></span><br><span class="line"><span class="comment">timeToIdleSeconds：设置对象在失效前的允许闲置时间（单位：秒）。仅当</span></span><br><span class="line"><span class="comment">eternal=false对象不是永久有效时使用，可选属性，默认值是0，也就是可闲置时间无穷大。</span></span><br><span class="line"><span class="comment">timeToLiveSeconds：设置对象在失效前允许存活时间（单位：秒）。最大时间介于创建时</span></span><br><span class="line"><span class="comment">间和失效时间之间。仅当eternal=false对象不是永久有效时使用，默认是0.，也就是对象存活时间</span></span><br><span class="line"><span class="comment">无穷大。</span></span><br><span class="line"><span class="comment">overflowToDisk：当内存中对象数量达到maxElementsInMemory时，Ehcache将会对象</span></span><br><span class="line"><span class="comment">写到磁盘中。</span></span><br><span class="line"><span class="comment">diskSpoolBufferSizeMB：这个参数设置DiskStore（磁盘缓存）的缓存区大小。默认是</span></span><br><span class="line"><span class="comment">30MB。每个Cache都应该有自己的一个缓冲区。</span></span><br><span class="line"><span class="comment">maxElementsOnDisk：硬盘最大缓存个数。</span></span><br><span class="line"><span class="comment">diskPersistent：是否在磁盘上持久化。指重启jvm后，数据是否有效。默认为false。</span></span><br><span class="line"><span class="comment">memoryStoreEvictionPolicy：当达到maxElementsInMemory限制时，Ehcache将会根</span></span><br><span class="line"><span class="comment">据指定的策略去清理内存。默认策略是LRU（最近最少使用）。你可以设置为FIFO（先进先出）或是</span></span><br><span class="line"><span class="comment">LFU（较少使用）。</span></span><br><span class="line"><span class="comment">clearOnFlush：内存数量最大时是否清除。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details><h4 id="测试-6"><a href="#测试-6" class="headerlink" title="测试"></a>测试</h4><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[com.ender.dao.UserMapper.findUserById]-&#x3D;&#x3D;&gt; Preparing: select</span><br><span class="line">id,username,password from user where id &#x3D; ?</span><br><span class="line">[com.ender.dao.UserMapper.findUserById]-&#x3D;&#x3D;&gt; Parameters: 1(Integer)</span><br><span class="line">[com.ender.dao.UserMapper.findUserById]-&lt;&#x3D;&#x3D; Total: 1</span><br><span class="line">User&#123;id&#x3D;1, username&#x3D;&#39;ender&#39;, password&#x3D;&#39;123456&#39;&#125;</span><br><span class="line">[com.ender.dao.UserMapper]-Cache Hit Ratio [com.ender.dao.UserMapper]: 0.5</span><br><span class="line">User&#123;id&#x3D;1, username&#x3D;&#39;ender&#39;, password&#x3D;&#39;123456&#39;&#125;</span><br><span class="line">true</span><br></pre></td></tr></table></figure><p>其实我们更加常见的是使用第三方的缓存进行存储，并且自由控制</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.sf.ehcache<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ehcache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.10.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> CacheManager cacheManager = <span class="keyword">new</span></span><br><span class="line">CacheManager(<span class="keyword">this</span>.getClass().getClassLoader().getResourceAsStream(<span class="string">&quot;ehcache.x</span></span><br><span class="line"><span class="string">ml&quot;</span>));</span><br><span class="line"><span class="comment">// create the cache called &quot;hello-world&quot;</span></span><br><span class="line">String[] cacheNames = cacheManager.getCacheNames();</span><br><span class="line"><span class="keyword">for</span> (String cacheName : cacheNames) &#123;</span><br><span class="line">    System.out.println(cacheName);</span><br><span class="line">&#125;</span><br><span class="line">Cache userDao = cacheManager.getCache(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">Element element = <span class="keyword">new</span> Element(<span class="string">&quot;testFindUserById_1&quot;</span>,<span class="keyword">new</span> User(<span class="number">1</span>,<span class="string">&quot;q&quot;</span>,<span class="string">&quot;d&quot;</span>));</span><br><span class="line">userDao.put(element);</span><br><span class="line">Element element1 = userDao.get(<span class="string">&quot;testFindUserById_1&quot;</span>);</span><br><span class="line">User user = (User)element1.getObjectValue();</span><br><span class="line">System.out.println(user);</span><br></pre></td></tr></table></figure><h2 id="参考笔记"><a href="#参考笔记" class="headerlink" title="参考笔记"></a>参考笔记</h2><div class="tag link"><a class="link-card" title="IT楠老师" href="https://www.itnanls.cn/"><div class="left"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" class="lazyload placeholder" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text">IT楠老师</p><p class="url">https://www.itnanls.cn/</p></div></a></div>]]></content>
    
    
    <summary type="html">&lt;p&gt;java工具——持久层工具mybatis&lt;/p&gt;</summary>
    
    
    
    <category term="ssm" scheme="http://enderxiao.top/categories/ssm/"/>
    
    <category term="mybatis" scheme="http://enderxiao.top/categories/ssm/mybatis/"/>
    
    
    <category term="Java" scheme="http://enderxiao.top/tags/Java/"/>
    
    <category term="Spring" scheme="http://enderxiao.top/tags/Spring/"/>
    
    <category term="mybatis" scheme="http://enderxiao.top/tags/mybatis/"/>
    
  </entry>
  
  <entry>
    <title>javaMaven</title>
    <link href="http://enderxiao.top/Java/Maven/javamaven/"/>
    <id>http://enderxiao.top/Java/Maven/javamaven/</id>
    <published>2021-01-31T07:56:12.000Z</published>
    <updated>2021-08-05T23:40:03.687Z</updated>
    
    <content type="html"><![CDATA[<p>java工具——包管理工具Maven</p><a id="more"></a><h2 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h2><h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ol><li>统一管理jar包，自动导入jar及其以来依赖</li><li>项目移植之后甚至不需要安装并发工具，只需要maven加命令就能跑，降低学习成本</li><li>使得项目流水线成为可能，因为使用简单的命令我们就能完成项目的编译，打包，发布等工作，就让程序操作程序成为了可能，大名鼎鼎的jekins也能做到这一点</li></ol><h3 id="Maven下载安装"><a href="#Maven下载安装" class="headerlink" title="Maven下载安装"></a>Maven下载安装</h3><hr><div class="note download"><p><a href="http://maven.apache.org/">Maven官网</a></p></div><p>下载binary文件</p><h4 id="Maven安装"><a href="#Maven安装" class="headerlink" title="Maven安装"></a>Maven安装</h4><hr><ol><li>解压</li><li>配置MAVEN_HOME，为maven的解压</li><li>配置path，%MAVEN_HOME%\bin</li><li>使用如下命令验证是否配置成功</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -v</span><br></pre></td></tr></table></figure><h4 id="Maven核心全局配置文件"><a href="#Maven核心全局配置文件" class="headerlink" title="Maven核心全局配置文件"></a>Maven核心全局配置文件</h4><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\apache-maven-<span class="number">3.6</span><span class="number">.3</span>\conf\settings.xml</span><br></pre></td></tr></table></figure><h5 id="配置路径"><a href="#配置路径" class="headerlink" title="配置路径"></a>配置路径</h5><hr><p>选择一个位置新建文件夹repository，setting.xml中添加如下标记</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>D:\program\Maven\repository<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="配置国内镜像"><a href="#配置国内镜像" class="headerlink" title="配置国内镜像"></a>配置国内镜像</h5><hr><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="配置全局编译jdk版本"><a href="#配置全局编译jdk版本" class="headerlink" title="配置全局编译jdk版本"></a>配置全局编译jdk版本</h5><hr><p>当计算机中有多个版本的jdk时，以下配置是必须的</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>jdk-11.0.9<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdk</span>&gt;</span>11<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.compilerVersion</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.compilerVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Maven体验"><a href="#Maven体验" class="headerlink" title="Maven体验"></a>Maven体验</h4><hr><h4 id="Maven标准目录"><a href="#Maven标准目录" class="headerlink" title="Maven标准目录"></a>Maven标准目录</h4><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">src</span><br><span class="line">|--main</span><br><span class="line">|--java源代码目录</span><br><span class="line">|--resources资源目录</span><br><span class="line"> |--test</span><br><span class="line">|--java测试代码目录</span><br><span class="line">|--resources测试资源目录</span><br><span class="line"> |--target</span><br><span class="line">|--ckasses编译后的class文件目录</span><br><span class="line">|--test-classes编译后的测试class文件目录</span><br><span class="line">pom.xmlMaven工程配置文件</span><br></pre></td></tr></table></figure><h4 id="pom-xml基本内容"><a href="#pom-xml基本内容" class="headerlink" title="pom.xml基本内容"></a>pom.xml基本内容</h4><hr><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span> = <span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span> = <span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span> = <span class="string">&quot;http://maven.apache.org/POM/4.0.0</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- 模型版本 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 公司或者组织的唯一标志，并且配置时生成的路径也是由此生成， 如com.companyname.project-group，maven会将该项目打成的jar包放本地路径：/com/companyname/project-group --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.companyname.project-group<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- 项目的唯一ID，一个groupId下面可能多个项目，就是靠artifactId来区分的 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>project<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- 版本号 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在创建好上述项目结构并配置好maven以及项目pom后，在项目根目录使用如下命令就能利用maven，进行自动的依赖下载，以及项目编译:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn compile</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/01/31/KOq2WEoYfb6kAig.png" class="lazyload placeholder" data-srcset="https://i.loli.net/2021/01/31/KOq2WEoYfb6kAig.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="maven编译项目.png"></p><h3 id="Maven生命周期"><a href="#Maven生命周期" class="headerlink" title="Maven生命周期"></a>Maven生命周期</h3><hr><p>maven生命周期描述了一个项目从源代码到部署的整个周期</p><p>Maven有三个内置的生命周期：</p><ol><li>清理（clean）：为执行一下工作做必要的清理，如删除target文件夹</li><li>默认（default）：真正进行项目编译打包工作的阶段</li><li>站点（site）：生成项目报告，站点，发布站点</li></ol><p>默认生命周期包括以下阶段（该阶段经过简化，实际上更加复杂）：</p><ol><li>验证（validate）：验证项目是否正确，所有必要信息是否可用</li><li><strong>编译</strong>（compile）：编译项目的源代码</li><li>测试（test）：使用合适的单元测试框架测试编译的源代码。这些测试不应该要求代码被打包或部署</li><li><strong>打包</strong>（package）：采用编译的代码，并以其可分配格式（如JAR）进行打包</li><li>验证（verify）：对集成测试的结果执行任何检查，以确保满足质量标砖</li><li><strong>安装</strong>（install）：将软件包安装到本地存储中，用作本地其他项目的依赖项</li><li>部署（deploy）：在构建环境中完成，将最终的包复制到远程存储以与其他开发人员和项目共享（私服）</li></ol><h3 id="Maven的版本规范"><a href="#Maven的版本规范" class="headerlink" title="Maven的版本规范"></a>Maven的版本规范</h3><hr><p>所有软件都有版本</p><p>Maven使用如下几个要素来定位一个项目，因此它们又称为项目的坐标。</p><ol><li><code>groupId</code>：团体、组织的标识符。团体标识的约定量，它以创建这个项目的组织名称的<wavy>,逆向域</wavy>名开头。一般对应着JAVA的包的结构，例如org.apache。</li><li><code>artifactId</code>：单独项目的唯一标识符。比如tomcat，commons等。不要再其中使用<kbd>.</kbd></li><li><code>version</code>：项目版本</li><li><code>packaging</code>：项目的类型，默认是jar，描述了项目打包后的输出，类型为jar的项目产生一个JAR文件，类型为war的项目产生一个web应用。</li></ol><p>Maven在版本管理时可以使用几个特殊的字符串 <code>SNAPSHOT</code>，<code>LARESR</code>，<code>RELEASE</code>。比如“1.0-SNAPSHOT”。各个部分的含义和处理逻辑如下说明：</p><ul><li><code>SNAPSHOT</code> 这个版本一般用于开发过程中，表示不稳定版</li><li><code>LARESR</code> 指某个特定构件的最新发布，这个发布可能是一个发布版，也可能是一个snapshot版，具体看那个时间最后</li><li><code>RELEASE</code> 指最后一个发布版</li></ul><h3 id="Idea配置Maven"><a href="#Idea配置Maven" class="headerlink" title="Idea配置Maven"></a>Idea配置Maven</h3><hr><h4 id="为当前项目配置"><a href="#为当前项目配置" class="headerlink" title="为当前项目配置"></a>为当前项目配置</h4><hr><p>File $\to$ Settings $\to$ 搜索Maven $\to$ <code>Maven home path</code>、<code>User settings file</code>、<code>Local repository</code></p><p>三项分别设置为：</p><ol><li>Maven安装路径</li><li>conf/settings.xml的路径</li><li>repository文件夹的路径</li></ol><h4 id="为未来项目配置"><a href="#为未来项目配置" class="headerlink" title="为未来项目配置"></a>为未来项目配置</h4><hr><p>New Project Settings $\to$ Settings for New Projects… $\to$ 搜索Maven $\to$ <code>Maven home path</code>、<code>User settings file</code>、<code>Local repository</code></p><p>配置同上</p><h3 id="Maven依赖"><a href="#Maven依赖" class="headerlink" title="Maven依赖"></a>Maven依赖</h3><hr><blockquote><p>Maven管理依赖也就是jar包不用我们自己下载，会从一些地方自动下载</p></blockquote><div class="tag link"><a class="link-card" title="maven远程仓库" href="https://mvnrepository.com/"><div class="left"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" class="lazyload placeholder" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text">maven远程仓库</p><p class="url">https://mvnrepository.com/</p></div></a></div><div class="tag link"><a class="link-card" title="maven远程仓库" href="https://maven.aliyun.com/mvn/search"><div class="left"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" class="lazyload placeholder" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text">maven远程仓库</p><p class="url">https://maven.aliyun.com/mvn/search</p></div></a></div><blockquote><p>Maven 工程中我们依赖在pom.xml文件进行配置完成jar包管理工作（依赖）</p></blockquote><p>在工程中引入某个jar包，只需要在pom.xml中引入jar包的坐标，比如引入log4j的依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>Maven</code>通过<code>groupId</code>、<code>artifactId</code>与<code>version</code>三个向量来定位Maven仓库其jar包所在的位置，并把对应的jar包引入到工程中来</p><h4 id="依赖范围"><a href="#依赖范围" class="headerlink" title="依赖范围"></a>依赖范围</h4><hr><h5 id="classpath"><a href="#classpath" class="headerlink" title="classpath"></a>classpath</h5><hr><p>编译好的<code>class</code>文件所在的路径</p><p>事实上，类加载器（<code>classloader</code>）就是去对应的<code>classpath</code>中加载<code>class</code>二进制文件</p><h5 id="maven项目"><a href="#maven项目" class="headerlink" title="maven项目"></a>maven项目</h5><hr><p>maven工程会将<code>src/main/java</code>和<code>src/main/recources</code>文件夹下的文件全部打包在classpath中。运行时它们两个文件夹下的文件会被放在一个文件夹下。</p><p>maven项目不同的阶段引入到classpath中的依赖是不同的例如</p><ol><li><code>编译时</code>，maven会将与编译相关的依赖引入classpath中</li><li><code>测试时</code>，maven会将与测试相关的依赖引入classpath中</li><li><code>运行时</code>，maven会将与运行相关的依赖引入classpath中</li></ol><p>而依赖范围就是用来控制依赖于这三种classpath的关系</p><h5 id="scop标签"><a href="#scop标签" class="headerlink" title="scop标签"></a>scop标签</h5><hr><p>scop标签就是依赖范围的配置</p><p>该项默认配置为compile，可选配置还有test、provide、runtime、system、import</p><p>其中compile、test和provided使用较多</p><p>部分jar包指在某一特定时候需要被加载，例如：</p><ol><li><code>servlet-api</code>，运行时其实是不需要的，因为tomcat里有，但编译时需要，因为编译时没有tomcat环境</li><li><code>junit</code>，只有在测试的时候才能用到，运行时不需要</li><li><code>JDBC</code>，测试时必须要有，编译时不需要，编译时用的都是jdk中的接口，运行时我们才使用反射注册驱动</li></ol><h6 id="编译依赖范围（compile）"><a href="#编译依赖范围（compile）" class="headerlink" title="编译依赖范围（compile）"></a>编译依赖范围（compile）</h6><hr><p>该范围是默认范围，次依赖范围对于编译、测试、运行三种<code>classpath</code>都有效如</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.68<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h6 id="测试依赖范围（test）"><a href="#测试依赖范围（test）" class="headerlink" title="测试依赖范围（test）"></a>测试依赖范围（test）</h6><hr><p>指对测试classpath有效，编译运行时都无法使用依赖，如junit</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scop</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scop</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h6 id="已提供依赖范围（provided）"><a href="#已提供依赖范围（provided）" class="headerlink" title="已提供依赖范围（provided）"></a>已提供依赖范围（provided）</h6><hr><p>支队编译和测试的classpath有效，对运行的classpath无效，如<code>servlet-api</code>，如果不设置依赖范围，当容器依赖的版本和maven依赖的版本不一致时会引起冲突</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scop</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scop</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h6 id="运行时依赖范围（runtime）"><a href="#运行时依赖范围（runtime）" class="headerlink" title="运行时依赖范围（runtime）"></a>运行时依赖范围（runtime）</h6><hr><p>只对测试和运行的classpath有效，对编译的classpath无效，如<code>JDBC</code>驱动</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connection-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scop</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scop</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="依赖传递"><a href="#依赖传递" class="headerlink" title="依赖传递"></a>依赖传递</h4><hr><p>jar包也是别人写的工程项目，她们也会依赖其他的jar包，传递性让我们可以不用关心我们所依赖的jar包依赖了哪些jar，只要我们添加了依赖，他会自动将所依赖的jar统统依赖进来</p><h5 id="依赖传递原则"><a href="#依赖传递原则" class="headerlink" title="依赖传递原则"></a>依赖传递原则</h5><hr><ul><li><strong>最短路径优先原则</strong>：如果A依赖了B，B依赖了C，在B和C    中同时依赖了log4j的依赖，并且这两个版本不一致，那么A会根据最短路径原则，在A中会传递过来B的log4j版本</li></ul><p><img src="https://i.loli.net/2021/01/31/guFL2vx59BshnpQ.png" class="lazyload placeholder" data-srcset="https://i.loli.net/2021/01/31/guFL2vx59BshnpQ.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="最短路依赖.png"></p><ul><li><strong>路径相同先声明原则</strong>：如果我们的工程同时依赖于B和A，B和C没有依赖关系，并且都有D的依赖，且版本不一致，那么会引入在pom.xml中先声明依赖的log4j版本。</li></ul><p><img src="https://i.loli.net/2021/01/31/uwW7VnLve8J3ZlI.png" class="lazyload placeholder" data-srcset="https://i.loli.net/2021/01/31/uwW7VnLve8J3ZlI.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="路径相同先声明.png"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.ender<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>B<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.ender<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>A<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>因为D的1.2.3版本的依赖关系优先得到确定，所以依赖D的1.2.3，因此如果A包中使用了D1.3.2的某些新特性，可能造成A包无法使用的问题，于是就需要把低版本排除，一般高版本会兼容低版本</p><h4 id="依赖的排除"><a href="#依赖的排除" class="headerlink" title="依赖的排除"></a>依赖的排除</h4><hr><p>对于上例中，我们如果想把低版本的D包排除，就可以做如下设置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.ender<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>B<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>com.ender<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>D<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.ender<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>A<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="聚合和继承"><a href="#聚合和继承" class="headerlink" title="聚合和继承"></a>聚合和继承</h3><hr><p>分布式项目必须使用到该功能</p><p><strong>聚合模块（父模块）</strong>的打包方式必须时pom，否则无法完成构建</p><p>在聚合多个项目时，如果这些聚合的项目中需要引入相同的jar，那么可以将这些jar写入父pom中，各个子项目集成该pom即可。父模块的打包方式必须为pom，否则无法构建项目</p><p>通过修改pom.xml来表明继承关系：</p><p>父模块pom：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!--    子模块--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>child-one<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    打包方式--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-lang<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-lang<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>子模块POM：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    依赖关系--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>child-one<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可被继承的POM元素如下：</p><ol><li>groupId:项目子ID，项目坐标的核心元素</li><li>version:项目版本，项目坐标的核心元素</li><li>properties：自定义的Maven属性，一般用于统一制定各个依赖的版本好</li><li>dependencies</li><li>dependencyManagement：项目依赖管理配置</li><li>repositories</li><li>build：包括项目的源码目录配置、输出目录配置、插件配置、插件管理配置等</li></ol><h4 id="实现父子工程统一版本管理"><a href="#实现父子工程统一版本管理" class="headerlink" title="实现父子工程统一版本管理"></a>实现父子工程统一版本管理</h4><hr><p>对于一个父子嵌套的工程，当我们要对所有子工程进行统一管理时，常常需要所有子工程使用统一的插件版本，我们可能会使用</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-lang<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-lang<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这样的方式在父工程的pom中配置，但是这样在打包时，子工程无论用没用到这个插件，都会将其打包进该工程中，因此我们需要使用别的方法进行版本管理：</p><p>首先在父工程的pom中配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 定义常量进行统一版本管理 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fastjson-version</span>&gt;</span>1.2.68<span class="tag">&lt;/<span class="name">fastjson-version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 此处引用的插件在子工程中服务立马生效，只有当子工程声明使用该插件时才能生效 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependenciesManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;fastjson-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependenciesManagement</span>&gt;</span></span><br></pre></td></tr></table></figure><p>子工程pom中配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子工程中声明时不需要声明版本号，将自动从父工程中的插件里得到版本号 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="POM文件"><a href="#POM文件" class="headerlink" title="POM文件"></a>POM文件</h3><hr><h4 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h4><hr><p>一个典型的pom.xml文件配置如下：</p><details ><summary> 点击查看配置 </summary>              <div class='content'>              <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span> = <span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span> = <span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span> = <span class="string">&quot;http://maven.apache.org/POM/4.0.0</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- 模型版本 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 公司或者组织的唯一标志，并且配置时生成的路径也是由此生成， 如com.companyname.project-group，maven会将该项目打成的jar包放本地路径：/com/companyname/project-group --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.companyname.project-group<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- 项目的唯一ID，一个groupId下面可能多个项目，就是靠artifactId来区分的 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>project<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- 版本号 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 打包机制,如pom、jar、war，默认为jar--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 为pom定义一些商量，在pom中的其他地方可以直接引用 使用方式如下：$&#123;file.encoding&#125; --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 常用来整体控制一些依赖的版本号 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file.encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">file.encoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.source.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.source.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.target.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.target.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 定义本项目的依赖关系，就是依赖的jar包 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 每个dependency都对应一个jar包 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 一般情况下，maven是通过groupId、artifactId、version三个元素指（俗称坐标）来检索该构件，然后引入你的工程。如果别人想引用你现在开发的这个目录（前提是已开发完毕并发布到了远程仓库） --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 就需要在她的pom文件中新建一个dependency节点，将本项目的groupId、artifactId、version写入，maven就会把你上传的jar包下载到她的本地 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">&lt;!-- 依赖范围 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scop</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scop</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 设置 依赖是否可选，默认为false，即子项目默认都继承，如果为true，则子项目必须显式的引入 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>false<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 排除依赖 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-lang<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-lang<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details><p>一般来说，上面的几个配置项对任何项目都是必不可少的，定义了项目的基本属性</p><h4 id="构建配置"><a href="#构建配置" class="headerlink" title="构建配置"></a>构建配置</h4><hr><details ><summary> 点击查看配置 </summary>              <div class='content'>              <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 产生的构建的文件名，默认值为$&#123;artifactId&#125;-$&#123;version&#125; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>myProjectName<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 构建产生的所有文件存放发目录，默认为$&#123;basedir&#125;/target,即项目根目录下的target --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;basedir&#125;/target<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 项目相关的所有资源路径列表，例如和项目相关的配置文件、属性文件，这些资源被包含在最终的打包文件里 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 项目源码目录，当构建项目的时候，构建系统会编译目录里的源码，该路径是相对于pom.xml的相对路径 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sourceDirectory</span>&gt;</span>$&#123;basedir&#125;\src\main\java<span class="tag">&lt;/<span class="name">sourceDirectory</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 项目单元测试使用的源码目录，当测试项目的时候，构建系统会编译目录里的源码，该路径是相对于pom.xml的相对路径 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">testSourceDirectory</span>&gt;</span>$&#123;basedir&#125;\src\test\java<span class="tag">&lt;/<span class="name">testSourceDirectory</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 被编译过的应用程序class文件存放的目录 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>$&#123;basedir&#125;\target\classes<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 被编译过的测试class文件存放的目录 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">testOutputDirectory</span>&gt;</span>$&#123;basedir&#125;\target\test-classes<span class="tag">&lt;/<span class="name">testOutputDirectory</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 以上配置遵循约定大于配置原则，一般使用默认配置 --&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 自行定义资源目录 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">inlcudes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">inlcudes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">inlcudes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">inlcudes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 单元测试相关的所有资源路径，配置方法于resources类似 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">testResources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">testResource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">targetPath</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">excludes</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">testResource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">testResources</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 使用的插件列表 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            ...具体在插件使用中了解</span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 主要定义插件的共同元素、拓展元素集合，类似于dependencyManagement --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 所有继承于次项目的子项目都能使用。该插件配置项直到被引用时才会被解析或绑定到生命周期。 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 给定插件的任何本地配置都会覆盖这里的配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pluginManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span>...<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">pluginManagement</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details><h6 id="常用的几个配置"><a href="#常用的几个配置" class="headerlink" title="常用的几个配置"></a>常用的几个配置</h6><hr><p>处理资源被过滤的问题</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">inlcudes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">inlcudes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">inlcudes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">inlcudes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>添加本地jar包</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- geelynote maven的核心插件-compiler插件默认只支持编译Java1.4，因此需要加上支持高版本jre的配置，在 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">compilerArguments</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 本地jar，支付宝jar包放到 src/main/webapp/WEB-INF/lib 文件夹下，如果没有配置，本地不会有问题，但线上会找不到sdk类，为什么要引入，因为支付宝jar包在中央仓库中没有，再比如oracle连接驱动的jar --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">extdirs</span>&gt;</span>$&#123;project.basedir&#125;/src/main/webapp/WEB-INF/lib<span class="tag">&lt;/<span class="name">extdirs</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">compilerArguments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="仓库配置"><a href="#仓库配置" class="headerlink" title="仓库配置"></a>仓库配置</h4><hr><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repossitory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">releases</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">releases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">snaphosts</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">snaphosts</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repossitory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br></pre></td></tr></table></figure><p>pom.xml中的仓库和setting.xml里的仓库功能一样，区别在于pom里配置的仓库时个性化的，比如，公司里的settings文件时公用的，若有项目都用一个settings文件，但各个子项目却会引用不同的第三方库，所以需要正在pom.xml里设置自己需要的仓库地址。</p><h4 id="项目信息配置（了解）"><a href="#项目信息配置（了解）" class="headerlink" title="项目信息配置（了解）"></a>项目信息配置（了解）</h4><hr><details ><summary> 点击查看配置 </summary>              <div class='content'>              <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--项目的名称, Maven产生的文档用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>banseon-maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--项目主页的URL, Maven产生的文档用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://www.baidu.com/banseon<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 项目的详细描述, Maven 产生的文档用。 当这个元素能够用HTML格式描述时（例如，CDATA中的文本会被解析器忽略，就可以包含HTML标 </span></span><br><span class="line"><span class="comment">        签）， 不鼓励使用纯文本描述。如果你需要修改产生的web站点的索引页面，你应该修改你自己的索引页文件，而不是调整这里的文档。 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span>A maven project to study maven.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--描述了这个项目构建环境中的前提条件。 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">prerequisites</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--构建该项目或使用该插件所需要的Maven的最低版本 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">prerequisites</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--项目的问题管理系统(Bugzilla, Jira, Scarab,或任何你喜欢的问题管理系统)的名称和URL，本例为 jira --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">issueManagement</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--问题管理系统（例如jira）的名字， --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system</span>&gt;</span>jira<span class="tag">&lt;/<span class="name">system</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--该项目使用的问题管理系统的URL --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://jira.baidu.com/banseon<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">issueManagement</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--项目持续集成信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ciManagement</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--持续集成系统的名字，例如continuum --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--该项目使用的持续集成系统的URL（如果持续集成系统有web接口的话）。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--构建完成时，需要通知的开发者/用户的配置项。包括被通知者信息和通知条件（错误，失败，成功，警告） --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">notifiers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置一种方式，当构建中断时，以该方式通知用户/开发者 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">notifier</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--传送通知的途径 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--发生错误时是否通知 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">sendOnError</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--构建失败时是否通知 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">sendOnFailure</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--构建成功时是否通知 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">sendOnSuccess</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--发生警告时是否通知 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">sendOnWarning</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--不赞成使用。通知发送到哪里 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">address</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--扩展配置项 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">notifier</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">notifiers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ciManagement</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--项目创建年份，4位数字。当产生版权信息时需要使用这个值。 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inceptionYear</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--项目相关邮件列表信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mailingLists</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--该元素描述了项目相关的所有邮件列表。自动产生的网站引用这些信息。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mailingList</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--邮件的名称 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--发送邮件的地址或链接，如果是邮件地址，创建文档时，mailto: 链接会被自动创建 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">post</span>&gt;</span>banseon@126.com<span class="tag">&lt;/<span class="name">post</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--订阅邮件的地址或链接，如果是邮件地址，创建文档时，mailto: 链接会被自动创建 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">subscribe</span>&gt;</span>banseon@126.com<span class="tag">&lt;/<span class="name">subscribe</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--取消订阅邮件的地址或链接，如果是邮件地址，创建文档时，mailto: 链接会被自动创建 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">unsubscribe</span>&gt;</span>banseon@126.com<span class="tag">&lt;/<span class="name">unsubscribe</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--你可以浏览邮件信息的URL --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">archive</span>&gt;</span>http:/hi.baidu.com/banseon/demo/dev/<span class="tag">&lt;/<span class="name">archive</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mailingList</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mailingLists</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--项目开发者列表 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">developers</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--某个项目开发者的信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">developer</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--SCM里项目开发者的唯一标识符 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>HELLO WORLD<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--项目开发者的全名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>banseon<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--项目开发者的email --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">email</span>&gt;</span>banseon@126.com<span class="tag">&lt;/<span class="name">email</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--项目开发者的主页的URL --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--项目开发者在项目中扮演的角色，角色元素描述了各种角色 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">roles</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">role</span>&gt;</span>Project Manager<span class="tag">&lt;/<span class="name">role</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">role</span>&gt;</span>Architect<span class="tag">&lt;/<span class="name">role</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">roles</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--项目开发者所属组织 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">organization</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">organization</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--项目开发者所属组织的URL --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">organizationUrl</span>&gt;</span>http://hi.baidu.com/banseon<span class="tag">&lt;/<span class="name">organizationUrl</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--项目开发者属性，如即时消息如何处理等 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dept</span>&gt;</span>No<span class="tag">&lt;/<span class="name">dept</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--项目开发者所在时区， -11到12范围内的整数。 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">timezone</span>&gt;</span>-5<span class="tag">&lt;/<span class="name">timezone</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">developer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">developers</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--项目的其他贡献者列表 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">contributors</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--项目的其他贡献者。参见developers/developer元素 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">contributor</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">email</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">organization</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">organizationUrl</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">roles</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">timezone</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">properties</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">contributor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">contributors</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--该元素描述了项目所有License列表。 应该只列出该项目的license列表，不要列出依赖项目的 license列表。如果列出多个license，用户可以选择它们中的一个而不是接受所有license。 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">licenses</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--描述了项目的license，用于生成项目的web站点的license页面，其他一些报表和validation也会用到该元素。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">license</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--license用于法律上的名称 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>Apache 2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--官方的license正文页面的URL --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://www.baidu.com/banseon/LICENSE-2.0.txt<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--项目分发的主要方式： repo，可以从Maven库下载 manual， 用户必须手动下载和安装依赖 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">distribution</span>&gt;</span>repo<span class="tag">&lt;/<span class="name">distribution</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--关于license的补充信息 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">comments</span>&gt;</span>A business-friendly OSS license<span class="tag">&lt;/<span class="name">comments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">license</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">licenses</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--SCM(Source Control Management)标签允许你配置你的代码库，供Maven web站点和其它插件使用。 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scm</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--SCM的URL,该URL描述了版本库和如何连接到版本库。欲知详情，请看SCMs提供的URL格式和列表。该连接只读。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">connection</span>&gt;</span></span><br><span class="line">        scm:svn:http://svn.baidu.com/banseon/maven/banseon/banseon-maven2-trunk(dao-trunk)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">connection</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--给开发者使用的，类似connection元素。即该连接不仅仅只读 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">developerConnection</span>&gt;</span></span><br><span class="line">        scm:svn:http://svn.baidu.com/banseon/maven/banseon/dao-trunk</span><br><span class="line">    <span class="tag">&lt;/<span class="name">developerConnection</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--当前代码的标签，在开发阶段默认为HEAD --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tag</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--指向项目的可浏览SCM库（例如ViewVC或者Fisheye）的URL。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://svn.baidu.com/banseon<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">scm</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--描述项目所属组织的各种属性。Maven产生的文档用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">organization</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--组织的全名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--组织主页的URL --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://www.baidu.com/banseon<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">organization</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--构建项目需要的信息 --&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details><p>其他配置信息参照：</p><div class="tag link"><a class="link-card" title="Maven POM教程" href="https://www.runoob.com/maven/maven-pom.html"><div class="left"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" class="lazyload placeholder" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text">Maven POM教程</p><p class="url">https://www.runoob.com/maven/maven-pom.html</p></div></a></div><h3 id="Maven仓库"><a href="#Maven仓库" class="headerlink" title="Maven仓库"></a>Maven仓库</h3><hr><p>任何一个构件都有唯一坐标，Maven根据这个坐标定位了构件在仓库中的唯一存储路径</p><p>Maven仓库分类两类：</p><ol><li>本地仓库</li><li>远程仓库，远程仓库分为三种：<ol><li>中央仓库</li><li>私服</li><li>其他公共仓库 </li></ol></li></ol><h4 id="本地仓库"><a href="#本地仓库" class="headerlink" title="本地仓库"></a>本地仓库</h4><hr><p>本地仓库时Maven在本地存储构建的地方，在安装Maven时不会被创建，在第一次执行Maven命令时才被创建</p><p>Maven本地仓库的默认位置：用户目录下的.m2/repository/</p><p>还可在conf/settings.xml中修改本地库的位置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 本地仓库的路径，默认值为 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>D:/myworkspace/Maven/repository<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="远程仓库"><a href="#远程仓库" class="headerlink" title="远程仓库"></a>远程仓库</h4><hr><p>用于获取其他人的Maven构件</p><h5 id="中央仓库"><a href="#中央仓库" class="headerlink" title="中央仓库"></a>中央仓库</h5><hr><p>默认的远程仓库，Maven在安装时，自带的就是中央仓库的配置</p><p>所有的Maven都议会继承超级POM，超级POM中包含如下配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>central<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>Cntral Repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://repo.maven.apache.org<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">enabled</span>&gt;</span>false<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br></pre></td></tr></table></figure><p>中央仓库包含了绝大多数流行的开源Java构件，以及源码，作者信息，SCM，信息，许可信息等</p><p>还可以在里面配置优先使用的镜像，比如在国内直接连接中央仓库较慢，一般使用阿里的镜像</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 镜像列表 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 被镜像的服务器ID --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="私服"><a href="#私服" class="headerlink" title="私服"></a>私服</h5><hr><p>私服时一种特殊的远程仓库，它时架设在局域网的仓库服务，私服代理广域网上的远程仓库，供局域网的Maven用户使用。当Maven需要下载构件的时候，它从私服请求，如果私服上不存在该构件，则从外部的远程仓库中下载，缓存在私服上之后，再为Maven的下载请求提供服务</p><h6 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h6><hr><ol><li>加速构建</li><li>节约带宽</li><li>节约中央Maven仓库的带宽</li><li>稳定（应对一旦中央服务器出问题的情况）</li><li>可以建立本地内部仓库</li><li>可以建立公共仓库</li></ol><p>如果没有特殊需求，一般只需要将私服地址配置为镜像，同时配置其代理所有的仓库就可以实现通过私服下载依赖的功能。镜像配置如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>Nexus Mirror<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>Nexus Mirror<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://localhost:8081/nexus/content/groups/public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可以使用Docker搭建Nexus私服，私服可以有用户名和密码，可以在settings.xml中配置</p><h3 id="Maven项目模板（了解）"><a href="#Maven项目模板（了解）" class="headerlink" title="Maven项目模板（了解）"></a>Maven项目模板（了解）</h3><hr><p>Archetype时一个Maven插件，其任务是按照其模板来创建一个项目结构。</p><p>执行如下命令即可创建Maven项目模板</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn archetype:generate</span><br></pre></td></tr></table></figure><p>常用archetype有两种：</p><ol><li>maven-archetype-quickstart默认的Archetype</li><li>maven-archetype-webapp</li></ol><p>创建webapp可以使用如下命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn archetype:generate -DgroupId=com.ender -DartifactId=seckill -DarchetypeArtifactId=maven-archetype-webapp</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;java工具——包管理工具Maven&lt;/p&gt;</summary>
    
    
    
    <category term="Java" scheme="http://enderxiao.top/categories/Java/"/>
    
    <category term="Maven" scheme="http://enderxiao.top/categories/Java/Maven/"/>
    
    
    <category term="Java" scheme="http://enderxiao.top/tags/Java/"/>
    
    <category term="Maven" scheme="http://enderxiao.top/tags/Maven/"/>
    
  </entry>
  
  <entry>
    <title>java反射</title>
    <link href="http://enderxiao.top/Java/%E5%8F%8D%E5%B0%84/java%E5%8F%8D%E5%B0%84/"/>
    <id>http://enderxiao.top/Java/%E5%8F%8D%E5%B0%84/java%E5%8F%8D%E5%B0%84/</id>
    <published>2021-01-28T02:53:11.000Z</published>
    <updated>2021-08-05T23:38:44.769Z</updated>
    
    <content type="html"><![CDATA[<p>java学习笔记，反射及其引用</p><a id="more"></a><h2 id="Java高级——反射"><a href="#Java高级——反射" class="headerlink" title="Java高级——反射"></a>Java高级——反射</h2><h3 id="反射入门"><a href="#反射入门" class="headerlink" title="反射入门"></a>反射入门</h3><hr><p>java反射机制是在<wavy>运行状态中</wavy>，对于任意一个类，都能知道这个类的所有属性和方法，对于任意一个对象，都能调用它的一个方法和属性；这种动态获取的信息以及动态调用对象的方法的功能称为java语言的反射机制</p><p>java反射机制主要提供了一下功能：</p><ol><li>在运行时判断任意一个对象所属的类</li><li>在运行时构造任意一个类的对象</li><li>在运行时判断一个类所具有的成员变量和方法；</li><li>在运行时调用任意一个对象的方法；</li><li>生成动态代理；</li></ol><h3 id="反射API"><a href="#反射API" class="headerlink" title="反射API"></a>反射API</h3><hr><p>我们写的所有类，都会被<code>appclassloader</code>加载到内存的方法区，生成一个Class类型的对象（万物皆对象(～￣▽￣)～），他们是我们写的class，同时也涉及<code>Class</code>实列。也叫说明书的说明书</p><p>Class叫说明书的说明书，告诉了我们怎么写说明书，比如可以有方法、属性等等</p><p>我们的class都是说明书，说明了某类对象所具有的方法和属性</p><p>Java反射需要的类主要有：</p><ol><li><code>java.lang.Class</code></li><li><code>java.lang.reflect</code>包中的<ol><li><code>Field</code></li><li><code>Constructor</code></li><li><code>Method</code></li><li><code>Annotation</code></li></ol></li></ol><div class="note warning yellow"><p>Class类是Java反射的起源，针对任何一个你想探测的类，只有先产生它的一个<code>Class</code>类对象，接下来才能通过Class对象获取其他想要的信息</p></div><h4 id="获取对象的方法"><a href="#获取对象的方法" class="headerlink" title="获取对象的方法"></a>获取对象的方法</h4><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用类</span></span><br><span class="line">Class cla = Dog.class;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用全类名</span></span><br><span class="line">Class aClass = Class.forName(<span class="string">&quot;com.ender.Day&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用对象</span></span><br><span class="line">Cat cat = <span class="keyword">new</span> cat();</span><br><span class="line">Class cla = cat.getClass();</span><br></pre></td></tr></table></figure><h4 id="操作字段"><a href="#操作字段" class="headerlink" title="操作字段"></a>操作字段</h4><hr><h5 id="获取字段"><a href="#获取字段" class="headerlink" title="获取字段"></a>获取字段</h5><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//只能获取到用public修饰的字段</span></span><br><span class="line">Field[] fields = animalClass.getFields();</span><br><span class="line"><span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">System.out.println(field.getName());</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line"><span class="comment">//能获取到所有被声明了的字段</span></span><br><span class="line">Field[] fields1 = animalClass.getDeclaredFields();</span><br><span class="line"><span class="keyword">for</span> (Field field : fields1) &#123;</span><br><span class="line">System.out.println(field.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="字段赋值"><a href="#字段赋值" class="headerlink" title="字段赋值"></a>字段赋值</h4><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">field.set(animal, <span class="string">&quot;张三&quot;</span>);</span><br><span class="line">System.out.println(field.get(animal));</span><br><span class="line">&#125; <span class="keyword">catch</span> (IllegalAccessException e)&#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">Field field = animalClass.getDeclaredField(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">field.setAccessible(<span class="keyword">true</span>);<span class="comment">//当在要操作类的文件夹之外的地方对私有字段注入值时，需要开启权限</span></span><br><span class="line">field.set(animal,<span class="number">12</span>);</span><br><span class="line">System.out.println(field.get(animal));</span><br><span class="line">&#125; <span class="keyword">catch</span> (NoSuchFieldException | IllegalAccessException e)&#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><hr><h4 id="获取方法"><a href="#获取方法" class="headerlink" title="获取方法"></a>获取方法</h4><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Method eat1 = animalClass.getMethod(<span class="string">&quot;eat&quot;</span>);</span><br><span class="line">Method eat2 = animalClass.getDeclaredMethod(<span class="string">&quot;eat&quot;</span>);</span><br><span class="line">Method eat = animalClass.getMethod(<span class="string">&quot;eat&quot;</span>,String.class,<span class="keyword">int</span>.class);<span class="comment">//对于有参数的方法，需要如此获取，每个参数需要传入类型</span></span><br><span class="line"></span><br><span class="line">Method methods[] = animalClass.getDeclaredMethods();</span><br></pre></td></tr></table></figure><h5 id="对方法的操作"><a href="#对方法的操作" class="headerlink" title="对方法的操作"></a>对方法的操作</h5><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Animal animal = <span class="keyword">new</span> Animal();</span><br><span class="line">animal.setName(<span class="string">&quot;ZhangSan&quot;</span>);</span><br><span class="line">animal.setAge(<span class="number">20</span>);</span><br><span class="line">Class&lt;Animal&gt; animalClass = Animal.class;</span><br><span class="line"><span class="comment">//获取某个方法，名字，后边是参数类型</span></span><br><span class="line">Method method = animalClass.getMethod(<span class="string">&quot;eat&quot;</span>,String.class,<span class="keyword">int</span>.class);</span><br><span class="line"><span class="comment">//拿到参数的个数</span></span><br><span class="line"><span class="keyword">int</span> parameterCount = method.getParameterCount();</span><br><span class="line"><span class="comment">//拿到方法名字</span></span><br><span class="line">String name = method.getName();</span><br><span class="line"><span class="comment">//拿到参数的类型数组</span></span><br><span class="line">Class&lt;?&gt;[] parameterTypes = method.getParameterTypes();</span><br><span class="line"><span class="comment">//拿到返回值类型</span></span><br><span class="line">Class&lt;?&gt; returnType = method.getReturnType();</span><br><span class="line"><span class="comment">//重点。反射调用方法，传一个实列，和参数</span></span><br><span class="line">method.invoke(animal,<span class="string">&quot;LiSi&quot;</span>,<span class="number">20</span>);</span><br></pre></td></tr></table></figure><h4 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h4><hr><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Class animalClass = Class.forName(<span class="string">&quot;com.ender.Animal&quot;</span>);</span><br><span class="line">Constructor&lt;Animal&gt; constructor = animalClass.getConstructor();</span><br><span class="line">Animal animal = constructor.newInstance();</span><br><span class="line">animal.eat();</span><br></pre></td></tr></table></figure><h5 id="反射与注释"><a href="#反射与注释" class="headerlink" title="反射与注释"></a>反射与注释</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Animal animal = <span class="keyword">new</span> Animal();</span><br><span class="line">Class&lt;Animal&gt; animalClass = Animal.class;</span><br><span class="line">A aannotation = animalClass.getAnnotation(A.class);<span class="comment">//通过类获取该类的注释</span></span><br><span class="line">Field name = animalClass.getDeclaredField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">name.setAccessible(<span class="keyword">true</span>);<span class="comment">//若该字段为私有，则需要以此设置访问权限，使得能够访问该字段的值</span></span><br><span class="line">Name nameAnnotion = name.getAnnotation(Name.class);<span class="comment">//通过某个字段获取该字段的注释</span></span><br><span class="line">String fullName = nameAnnotion.name();<span class="comment">//获取注释中的元素值</span></span><br><span class="line">name.set(animal,fullName);</span><br><span class="line">System.out.println(name.get(animal));</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;java学习笔记，反射及其引用&lt;/p&gt;</summary>
    
    
    
    <category term="Java" scheme="http://enderxiao.top/categories/Java/"/>
    
    <category term="反射" scheme="http://enderxiao.top/categories/Java/%E5%8F%8D%E5%B0%84/"/>
    
    
    <category term="Java" scheme="http://enderxiao.top/tags/Java/"/>
    
    <category term="Java反射" scheme="http://enderxiao.top/tags/Java%E5%8F%8D%E5%B0%84/"/>
    
  </entry>
  
  <entry>
    <title>java注解</title>
    <link href="http://enderxiao.top/Java/%E6%B3%A8%E8%A7%A3/java%E6%B3%A8%E8%A7%A3/"/>
    <id>http://enderxiao.top/Java/%E6%B3%A8%E8%A7%A3/java%E6%B3%A8%E8%A7%A3/</id>
    <published>2021-01-27T02:49:27.000Z</published>
    <updated>2021-08-05T23:41:33.649Z</updated>
    
    <content type="html"><![CDATA[<p>java学习笔记，注解及其应用</p><a id="more"></a><h2 id="Java注解"><a href="#Java注解" class="headerlink" title="Java注解"></a>Java注解</h2><h3 id="注解定义"><a href="#注解定义" class="headerlink" title="注解定义"></a>注解定义</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.FIELD)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Name &#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">length</span><span class="params">()</span> <span class="keyword">default</span> 5</span>;</span><br><span class="line">    <span class="function">String <span class="title">name</span><span class="params">()</span> <span class="keyword">default</span> &quot;&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> 5</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用时可以是</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Name</span>(length = 12)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Name</span>(5)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Name</span>(value = 5, length = 12)</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h4 id="注解中的元素"><a href="#注解中的元素" class="headerlink" title="注解中的元素"></a>注解中的元素</h4><p>注解中的元素只支持：</p><ol><li>基础数据类型</li><li>String</li><li>Class</li><li>enum</li><li>Annotation</li><li>上述类型的数组</li></ol><h4 id="编译器对默认值的限制"><a href="#编译器对默认值的限制" class="headerlink" title="编译器对默认值的限制"></a>编译器对默认值的限制</h4><ol><li>元素不能有不确定的值，即要么具有默认值，要么在使用时提供元素的值</li><li>对于非基本类型的元素，无论正在源码中还是在注解接口中定义默认值，都不能为null</li></ol><h4 id="注解不支持继承"><a href="#注解不支持继承" class="headerlink" title="注解不支持继承"></a>注解不支持继承</h4><p>注解不能继承，但注解在编译后，编译器会自动继承<code>java.lang.annotation.Annotation</code>接口，使用反编译可以看到</p><h4 id="快捷方式"><a href="#快捷方式" class="headerlink" title="快捷方式"></a>快捷方式</h4><p>注释中定义了以<code>value</code>为名的元素，并且在使用该注解时，如果该元素是唯一需要赋值的元素，那么无需使用<code>value = key</code>的语法，只需在括号中给出<code>value</code>元素值即可，这可以应用于任何合法类型的元素，但限制了元素名必须为<code>value</code></p><h3 id="Deprecated"><a href="#Deprecated" class="headerlink" title="Deprecated"></a>Deprecated</h3><p>使用@Deprecated注解的方法代表已过时，不推荐使用的方法，再idea的提示种会以删除线的形式展现，但是仍能正常使用</p><h3 id="Override"><a href="#Override" class="headerlink" title="Override"></a>Override</h3><p>使用@Override注解的方法代表是重写了父类的某个方法，当我们方法的名字出错时，编译器就会报错</p><h3 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h3><p>使用@Tes注解饰的方法，可以进行单元测试</p><h3 id="SuppressWarnings"><a href="#SuppressWarnings" class="headerlink" title="SuppressWarnings"></a>SuppressWarnings</h3><p>使用@SuppressWarnings注解的方法，再idea中将不再给出该方法内的警告，不推荐使用</p><p>@SuppressWarnings中的方法有：</p><p>all，抑制所有警告</p><p>boxing，抑制与封装/拆装作业相关的警告</p><p>ccast，抑制与强制类型转换相关的警告</p><p>…</p><h3 id="元注解"><a href="#元注解" class="headerlink" title="元注解"></a>元注解</h3><p>用来注解定义注解时的注解</p><h4 id="Documented"><a href="#Documented" class="headerlink" title="Documented"></a>Documented</h4><p>使用@Documented注解的注解在生成API文档时将不会被忽略</p><h4 id="Retention"><a href="#Retention" class="headerlink" title="Retention"></a>Retention</h4><p>注解可见度，定义了注解的生命周期</p><p>@Retention包含一个RetentionPolicy类型的属性value，Enum RetentionPolicy是一个枚举类型，</p><p>分为三个等级：</p><ol><li>RetentionPolicy.Source 源码级别，注解只被保留在源码，编译成class后，注解被遗弃</li><li>RetentionPolicy.CLASS 类文件级别， 注解被保留到class文件，但jvm加载class文件后将被遗弃，这是默认的生命周期</li><li>RetentionPolicy.RUNTIME 运行时，注解不仅被保留到class文件中，jvm加载后仍然存在</li></ol><h4 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h4><p>@Target用来约束注解可以应用的地方（如方法、类或字段），其中ElementType是枚举类型，表示可能的取值范围，取值如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">ElementType</span></span>&#123;</span><br><span class="line">    <span class="comment">//可用于类、接口（包含注解类型）、或enum</span></span><br><span class="line">    TYPE,</span><br><span class="line">    <span class="comment">//可用于字段（域）声明，包括enum实列</span></span><br><span class="line">    FIELD,</span><br><span class="line">    <span class="comment">//可用于方法声明</span></span><br><span class="line">    METHOD,</span><br><span class="line">    <span class="comment">//可用于参数声明</span></span><br><span class="line">    PARAMETER,</span><br><span class="line">    <span class="comment">//可用于构造函数声明</span></span><br><span class="line">    CONSTRUCTOR,</span><br><span class="line">    <span class="comment">//可用于局部变量声明</span></span><br><span class="line">    LOCAL_VARIABLE,</span><br><span class="line">    <span class="comment">//可用于注解声明（应用于另一注解上）</span></span><br><span class="line">    ANNOTATION_TYPE,</span><br><span class="line">    <span class="comment">//可用于包声明</span></span><br><span class="line">    PACKAGE,</span><br><span class="line">    <span class="comment">//可用于类型参数声明（1.8新增）</span></span><br><span class="line">    TYPE_PARAMATER,</span><br><span class="line">    <span class="comment">//类型使用声明（1.8新增）</span></span><br><span class="line">    TYPE_USE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;java学习笔记，注解及其应用&lt;/p&gt;</summary>
    
    
    
    <category term="Java" scheme="http://enderxiao.top/categories/Java/"/>
    
    <category term="反射" scheme="http://enderxiao.top/categories/Java/%E5%8F%8D%E5%B0%84/"/>
    
    <category term="注解" scheme="http://enderxiao.top/categories/Java/%E6%B3%A8%E8%A7%A3/"/>
    
    
    <category term="Java" scheme="http://enderxiao.top/tags/Java/"/>
    
    <category term="Java反射" scheme="http://enderxiao.top/tags/Java%E5%8F%8D%E5%B0%84/"/>
    
    <category term="Java注解" scheme="http://enderxiao.top/tags/Java%E6%B3%A8%E8%A7%A3/"/>
    
  </entry>
  
  <entry>
    <title>Java基础知识点汇总</title>
    <link href="http://enderxiao.top/Java/%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9%E6%B1%87%E6%80%BB/"/>
    <id>http://enderxiao.top/Java/%E5%9F%BA%E7%A1%80/java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9%E6%B1%87%E6%80%BB/</id>
    <published>2021-01-26T10:44:10.000Z</published>
    <updated>2021-08-05T23:39:28.673Z</updated>
    
    <content type="html"><![CDATA[<p>java 基础知识整合</p><a id="more"></a><h2 id="Javase-基础"><a href="#Javase-基础" class="headerlink" title="Javase 基础"></a>Javase 基础</h2><h3 id="基础数据类型"><a href="#基础数据类型" class="headerlink" title="基础数据类型"></a>基础数据类型</h3><h4 id="四类八种"><a href="#四类八种" class="headerlink" title="四类八种"></a>四类八种</h4><ol><li><p>整型</p><ol><li>Byte</li><li>int</li><li>short</li><li>long</li></ol></li><li><p>浮点</p><ol><li>float</li><li>double</li></ol></li><li><p>布尔</p><ol><li>boolean</li></ol></li><li><p>字符型</p><ol><li>char</li></ol></li></ol><h4 id="取值范围"><a href="#取值范围" class="headerlink" title="取值范围"></a>取值范围</h4><ol><li>整型：byte $-2^7 \to 2^7 -1$(10000000 表示-128)</li><li>浮点型：符号位 + 阶码（指数）+尾数</li><li>字符：一个字符两个字节（unicode）</li></ol><h4 id="字符发展"><a href="#字符发展" class="headerlink" title="字符发展"></a>字符发展</h4><p>$ASCII \to ISO8856-7(1字节) \to unicode(2字节) \to utf-8(可变长字符集，英文1字节，中文2)$</p><p>GBK GB2312 中国国标字符集</p><h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><p>在内存中开辟一片空间，可以存数据</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//变量类型 变量名 = 具体值</span></span><br></pre></td></tr></table></figure><h5 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h5><ol><li>可以反复使用</li><li>对于引用类型来说，变量就是一个引用，指向内存的一块区域，我们想操作一个对象只需要使用它的引用即可</li></ol><h4 id="标识符命名规则"><a href="#标识符命名规则" class="headerlink" title="标识符命名规则"></a>标识符命名规则</h4><ol><li>可以用_或$</li><li>可以是字母数字，数字不能开头</li><li>所有名字必须驼峰式命名</li><li>变量、方法首字母小写，类名首字母大写，静态常量全部大写多个单词用下划线分割</li><li>不能使用关键字</li><li>少用或不用拼英，如果使用就整体全用拼英</li></ol><h4 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h4><p>整型和整型：整型种小转大自动转，大转小需要强转，因为可能会丢失精度</p><p>整型和浮点型：浮点型转整型需要强转，反之不需要，但以科学计数法表示可能会丢失精度</p><p>char和整型：相互转换都为自动转换。</p><p>任何short、byte、int、char无论是逻辑运算还是数学运算的结果都是int</p><h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><h4 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h4><table><thead><tr><th align="left">与</th><th>或</th><th>非</th><th>双与</th><th>双或</th><th>异或</th></tr></thead><tbody><tr><td align="left">&amp;</td><td>|</td><td>！</td><td>&amp;&amp;</td><td>||</td><td>^</td></tr></tbody></table><ol><li>与：全真为真</li><li>或：全假为假</li><li>非：非真就是假、非假就是真</li><li>异或：相同为真不同为假</li><li>双与：短路元素运算符，前为假直接返回假，后面的不计算</li><li>双或：短路元素运算符，前为真直接返回真，后面的不计算</li></ol><h4 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h4><p>$+ - \times \div % $</p><h4 id="赋值运算符"><a href="#赋值运算符" class="headerlink" title="赋值运算符"></a>赋值运算符</h4><ul><li>=</li><li>++：++在前，先+再赋值，++在后先赋值再+</li></ul><hr><ul><li>+=</li><li>-=</li></ul><h5 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h5><ul><li>&gt;&gt;：有符号右移</li><li>&lt;&lt;：有符号左移</li><li>&gt;&gt;&gt;：无符号右移</li></ul><h4 id="三目运算符"><a href="#三目运算符" class="headerlink" title="三目运算符"></a>三目运算符</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//条件?结果一:结果二;</span></span><br></pre></td></tr></table></figure><h3 id="控制语句"><a href="#控制语句" class="headerlink" title="控制语句"></a>控制语句</h3><h4 id="选择结构"><a href="#选择结构" class="headerlink" title="选择结构"></a>选择结构</h4><ul><li>if语句</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="comment">/*条件*/</span>)&#123;</span><br><span class="line">    </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>switch</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//i可以是 byte short int String enum</span></span><br><span class="line"><span class="keyword">switch</span>(i)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        System.out.printin();<span class="comment">//操作</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        System.out.printin();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        System.out.printin();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="循环结构"><a href="#循环结构" class="headerlink" title="循环结构"></a>循环结构</h4><ul><li>while</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="comment">/*条件*/</span>)&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> &#123;&#125; <span class="keyword">while</span> (<span class="comment">/*条件*/</span>)<span class="comment">//无论如何都会执行一次</span></span><br></pre></td></tr></table></figure><ul><li>for</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//不同for</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类型 名字[] = new 类型[长度];</span></span><br><span class="line"><span class="comment">//类型 名字[] = (1,2,3);</span></span><br><span class="line"><span class="comment">//类型 名字[]; new 类型[](1,2,3,4);</span></span><br></pre></td></tr></table></figure><h4 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h4><ol><li>一旦创建，类型、长度都无法更改</li><li>length代表她长度</li><li>下标从0开始，最后一个位length - 1</li><li>使用 <wavy>名字[下标]</wavy> 访问</li><li>越界抛出：<u>ArrayIndexOutOfBoundsException</u></li></ol><h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><h4 id="1-权限修饰符"><a href="#1-权限修饰符" class="headerlink" title="1. 权限修饰符"></a>1. 权限修饰符</h4><table><thead><tr><th>作用域</th><th>当前类</th><th>同package</th><th>子孙类</th><th>其他package</th></tr></thead><tbody><tr><td>public</td><td>√</td><td>√</td><td>√</td><td>√</td></tr><tr><td>protected</td><td>√</td><td>√</td><td>√</td><td>×</td></tr><tr><td>friendly(default)</td><td>√</td><td>√</td><td>同包子类可以</td><td>×</td></tr><tr><td>private</td><td>√</td><td>×</td><td>×</td><td>×</td></tr></tbody></table><h4 id="2-返回值类型"><a href="#2-返回值类型" class="headerlink" title="2. 返回值类型"></a>2. 返回值类型</h4><h4 id="3-static"><a href="#3-static" class="headerlink" title="3. static"></a>3. static</h4><p>静态方法和属性是属于类对象的，使用时不需要new对象，直接使用<code>类名.方法名()</code>，<code>类名.属性</code></p><h4 id="4-名字"><a href="#4-名字" class="headerlink" title="4. 名字"></a>4. 名字</h4><p>驼峰式，首字母小写</p><h4 id="5-参数"><a href="#5-参数" class="headerlink" title="5. 参数"></a>5. 参数</h4><p>参数可以有多个，方法定义的地方叫<code>形参</code>，方法调用的地方叫<code>实参</code></p><p>可变参数：</p><ol><li>只能出现一次</li><li>必须放在最后</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">f1</span><span class="params">(<span class="keyword">int</span> ... nums)</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure><h4 id="方法重载"><a href="#方法重载" class="headerlink" title="方法重载"></a>方法重载</h4><ol><li>方法名一样</li><li>参数列表不一样</li><li>每个方法都有一个签名，就是用名字和参数签名的</li></ol><h4 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h4><ol><li>方法自己调用自己的过程</li><li>一定要有出口，没有出口将会栈内存溢出</li><li>斐波那契数列</li></ol><h3 id="6-面向对象"><a href="#6-面向对象" class="headerlink" title="6. 面向对象"></a>6. 面向对象</h3><h4 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h4><p>需要什么对象，就创建一个什么类，万物皆对象</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="comment">//使用public修饰时，文件名必须与类名相同</span></span><br><span class="line">    <span class="comment">//一个文件中只能有一个被public修饰的类</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//私有属性(属性推荐私有)</span></span><br><span class="line">    <span class="comment">//构造器 （可有0-多个）</span></span><br><span class="line">    <span class="comment">//实例方法</span></span><br><span class="line">    <span class="comment">//getter and setter</span></span><br><span class="line">    <span class="comment">//toString(如果需要)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="工具类和常量类"><a href="#工具类和常量类" class="headerlink" title="工具类和常量类"></a>工具类和常量类</h5><p>工具类中一般多为静态方法，常量类中大多时静态常量</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ORDER_SRARUS = <span class="string">&quot;已发货&quot;</span>;</span><br></pre></td></tr></table></figure><h5 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h5><p>属性全部私有，使用getter取值，setter赋值，能做安全控制</p><h5 id="方法-1"><a href="#方法-1" class="headerlink" title="方法"></a>方法</h5><h5 id="构造器"><a href="#构造器" class="headerlink" title="构造器"></a>构造器</h5><ol><li>new一个对象时会主动调用他的构造器</li><li>构造器可有多个</li><li>可以有不同参数的构造器</li><li>不自己写，就默认给一个无参构造器，一旦写了有参构造器，无参构造器就需要自己手写</li></ol><h4 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h4><ol><li>extends关键字，子类拥有父类（超类）的一切（除了被private修饰的）</li><li>构造子类时一定会先构造一个父类</li><li>子类可以重写父类的方法，重写的方法需要加一个注释<code>@override</code></li><li><code>Object</code> 时所有类的顶级父类</li></ol><h5 id="类的构造顺序"><a href="#类的构造顺序" class="headerlink" title="类的构造顺序"></a>类的构造顺序</h5><ol><li>父类的静态属性</li><li>父类的静态代码块</li><li>子类的静态属性</li><li>子类的静态代码块</li><li>父类的非静态属性</li><li>父类的非静态代码块</li><li>父类的构造器</li><li>子类的非静态属性</li><li>子类的非静态代码块</li><li>子类的构造器</li></ol><h5 id="this-amp-super"><a href="#this-amp-super" class="headerlink" title="this&amp;super"></a>this&amp;super</h5><ol><li>this 指向本实列</li><li>super指向父类的实例</li><li>this和super可当构造器使用，但如果想使用super()必须放在第一行</li></ol><h4 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h4><ol><li>继承</li><li>重写</li><li>父类引用指向子类对象</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">List.add(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><h5 id="Object的几个方法"><a href="#Object的几个方法" class="headerlink" title="Object的几个方法"></a>Object的几个方法</h5><ol><li>equals</li><li>hashcode</li><li>重写equals必须重写hashcode，主要是因为有hashmap，hashset这类的集合</li><li>toString</li></ol><h4 id="抽象类和接口"><a href="#抽象类和接口" class="headerlink" title="抽象类和接口"></a>抽象类和接口</h4><p>抽象类：拥有抽象方法的类，必须使用<code>abstract</code>修饰，可以没有抽象方法，继承时必须重写她的抽象方法</p><p>接口：全部都是抽象方法的类（没有方法体的方法），<code>interface</code></p><p>实现接口<code>implements</code>,必须实现所有的抽象方法</p><h4 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h4><ol><li>父类引用 $\to$ 子类对象 不需要强转 向下转型</li><li>子类引用 $\to$ 父类的对象  需要强转 向上转型</li></ol><h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><p>集合是存东西的，能存很多同一种类型（包含他的子类）的对象</p><h4 id="collection"><a href="#collection" class="headerlink" title="collection"></a>collection</h4><h4 id="list（列表）"><a href="#list（列表）" class="headerlink" title="list（列表）"></a>list（列表）</h4><p>ArrayList</p><p>LinkList</p><h4 id="set"><a href="#set" class="headerlink" title="set"></a>set</h4><p>set和list的区别：</p><p>list是有序（指插入顺序和实际位置相关）、可重复的</p><p>set是无序（hash算法来确定位置）、不可重复的</p><blockquote><p>hashset如何判断一个对象是否重复：</p><p>如果两个对象不是用同一地址，但是equals且hashcode一样，就说明一样</p></blockquote><h4 id="map（映射）"><a href="#map（映射）" class="headerlink" title="map（映射）"></a>map（映射）</h4><p>存一对key与value的映射</p><p>hashmap原理：数据结构是：<code>数组</code>+<code>链表</code>+<code>红黑树</code></p><p>hashmap是无序的</p><h4 id="集合遍历方式"><a href="#集合遍历方式" class="headerlink" title="集合遍历方式"></a>集合遍历方式</h4><p>list：普通for，增强for，迭代器（iterator）</p><p>set：增强for，迭代器</p><p>set两种遍历方式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//增强for</span></span><br><span class="line"><span class="keyword">for</span> (Integer integer : set)&#123;</span><br><span class="line">    System.out.printlen(integer);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//迭代器</span></span><br><span class="line">Iterator&lt;Integer&gt; iterator = set.iterator();</span><br><span class="line"><span class="keyword">while</span>(iterator.hasNext())&#123;</span><br><span class="line">    System.out.printlen(iterator.next());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>hashmap：entryset，迭代器</p><p>hashmap三种遍历方式：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一种</span></span><br><span class="line"><span class="keyword">for</span> (Map.Entry entry : map.entrySet() )&#123;</span><br><span class="line">    System.out.printlen(entry.getKey());</span><br><span class="line">    System.out.printlen(entry.getValue());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//第二种</span></span><br><span class="line">Set&lt;String&gt; keys = map.keySet();</span><br><span class="line"><span class="keyword">for</span> (String key : keys)&#123;</span><br><span class="line">    System.out.printlen(key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//第三种</span></span><br><span class="line">Iterator&lt;map.Entry, User&gt; &gt; iterator = map.entrySet().iterator();</span><br><span class="line"><span class="keyword">while</span>(iterator.hasNext())&#123;</span><br><span class="line">    Map.Entry&lt;String, User&gt; next = iterator.next();</span><br><span class="line">    System.out.printlen(next.getKey());</span><br><span class="line">    System.out.printlen(next.getValue());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="TreeMap"><a href="#TreeMap" class="headerlink" title="TreeMap"></a>TreeMap</h4><p>自动排序的map，数据结构是<code>红黑树</code></p><p>TreeSet：底层就是一个TreeMap</p><h3 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h3><p>引用自</p><div class="tag link"><a class="link-card" title="Java泛型" href="https://segmentfault.com/a/1190000019606768"><div class="left"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" class="lazyload placeholder" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text">Java泛型</p><p class="url">https://segmentfault.com/a/1190000019606768</p></div></a></div><h4 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h4><p>什么是泛型，看表面的意思，泛型就是指广泛的、普通的类型。在java中是指<em>把类型明确的工作推迟到创建对象或调用方法的时候才去明确的特殊的类型</em>。</p><p>例子：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">strings.add(<span class="string">&quot;a String&quot;</span>);</span><br><span class="line">String aString = strings.get(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>通过<kbd><></kbd>可以将List内元素的类型限定为String类型，其中只能是<code>引用类型</code>，对于基本类型，可以使用对应的<code>包装类型</code></p><h4 id="泛型类"><a href="#泛型类" class="headerlink" title="泛型类"></a>泛型类</h4><p>泛型类也就是把泛型定义在类上，这样用户在使用类的时候才把类型给确定下来。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectTool</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> T obj;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getObj</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setObj</span><span class="params">(T obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.obj = obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到上面这个程序，在使用时如果定义了类型，那么在使用时就可以不用进行强制类型转换，直接就可以得到一个T类型的对象。</p><h4 id="泛型方法"><a href="#泛型方法" class="headerlink" title="泛型方法"></a>泛型方法</h4><p>有时候只关心某个方法，那么使用泛型时可以不定义泛型类，而是只定义一个泛型方法，如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(T t)</span> </span>&#123;</span><br><span class="line">       System.out.println(t);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>需要注意一下定义的格式，泛型必须得先定义才能够使用。</p><h4 id="继承关系"><a href="#继承关系" class="headerlink" title="继承关系"></a>继承关系</h4><p>泛型类在继承时，可以明确父类（泛型类）的参数类型，也可以不明确。<br>现在我们有如下的泛型类<br>//泛型类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Inter</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(T t)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="明确类型"><a href="#明确类型" class="headerlink" title="明确类型"></a>明确类型</h5><p>//在实现泛型类时明确父类的类型</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InterImpl</span> <span class="keyword">implements</span> <span class="title">Inter</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="不明确类型"><a href="#不明确类型" class="headerlink" title="不明确类型"></a>不明确类型</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InterImpl</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">Inter</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(T t)</span> </span>&#123;</span><br><span class="line">        System.out.println(t);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="类型通配符"><a href="#类型通配符" class="headerlink" title="类型通配符"></a>类型通配符</h4><h5 id="无界"><a href="#无界" class="headerlink" title="无界"></a>无界</h5><p>类型通配符我感觉上和泛型方法差不多，只是不用在使用前进行定义，例子如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">processElements</span><span class="params">(List&lt;?&gt; elements)</span></span>&#123;</span><br><span class="line">   <span class="keyword">for</span>(Object o : elements)&#123;</span><br><span class="line">      System.out.println(o);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>“?”可以接收任何类型。</p><h5 id="上界"><a href="#上界" class="headerlink" title="上界"></a>上界</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">processElements</span><span class="params">(List&lt;? extends A&gt; elements)</span></span>&#123;</span><br><span class="line">   <span class="keyword">for</span>(A a : elements)&#123;</span><br><span class="line">      System.out.println(a.getValue());</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这种情况下能够接收A类或者A类的子类。</p><h5 id="下界"><a href="#下界" class="headerlink" title="下界"></a>下界</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertElements</span><span class="params">(List&lt;? <span class="keyword">super</span> A&gt; list)</span></span>&#123;</span><br><span class="line">    list.add(<span class="keyword">new</span> A());</span><br><span class="line">    list.add(<span class="keyword">new</span> B());</span><br><span class="line">    list.add(<span class="keyword">new</span> C());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这种情况下能够接收A类或者A类的父类</p><h5 id="类型通配符和泛型方法"><a href="#类型通配符和泛型方法" class="headerlink" title="类型通配符和泛型方法"></a>类型通配符和泛型方法</h5><p>我认为这两种方式是差不多的，不过在使用时，如果参数之间是有依赖关系的，那么可以使用泛型方法，否则就使用类型通配符。<em>（如果一个方法的返回值、某些参数的类型依赖另一个参数的类型就应该使用泛型方法，因为被依赖的类型如果是不确定的?，那么其他元素就无法依赖它）</em>。</p><h4 id="泛型擦除"><a href="#泛型擦除" class="headerlink" title="泛型擦除"></a>泛型擦除</h4><p>泛型是<strong>提供给javac编译器使用的</strong>，它用于限定集合的输入类型，让编译器在源代码级别上，即挡住向集合中插入非法数据。但编译器编译完带有泛形的java程序后，<strong>生成的class文件中将不再带有泛形信息</strong>，以此使程序运行效率不受到影响，这个过程称之为“擦除”。</p><h3 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h3><ol><li>继承<code>Thread</code>类，实现<code>run</code>方法</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        MyThread t1 = <span class="keyword">new</span> MyThread(<span class="string">&quot;t1&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyThread</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyThread</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;我是：&quot;</span> + Thread.currentThread().getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>实现<code>runnable</code>接口，实现<code>run</code>方法</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRun</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Thread t1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyRun());</span><br><span class="line">        t1.start();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)&#123;</span><br><span class="line">            ThreadTest.SB.append(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note quote"><p>启动线程必须调用start方法，不能调用run，调用run只是方法调用，start是个native的本地方法，会调度cpu的资源，开辟线程</p></div><h3 id="常用类"><a href="#常用类" class="headerlink" title="常用类"></a>常用类</h3><h4 id="String"><a href="#String" class="headerlink" title="String"></a>String</h4><p>String是引用数据类型，是final修饰的，一旦创建无法改变</p><p>String、StringBuffer、StringBuilder的区别</p><ol><li>String不可变，线程安全的</li><li>StringBuffer是可变字符串，线程安全的</li><li>StringBuilder是可变字符串，前程不安全</li><li>当有大量字符串拼接的代码时，没有线程安全的要求就用StringBuilder（一般情况），有要求就用StringBuffer</li></ol><h4 id="工具类"><a href="#工具类" class="headerlink" title="工具类"></a>工具类</h4><p>Date、Math、Collections、Arrys、Canlader</p><p>Date格式化：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Date date = <span class="keyword">new</span> Date();</span><br><span class="line">SimpleDateFormate s = <span class="keyword">new</span> SimpleDateFormate(<span class="string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>);</span><br><span class="line">String DateString = s.parse(date);</span><br></pre></td></tr></table></figure><h3 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h3><p>引用自</p><div class="tag link"><a class="link-card" title="JAVA之枚举" href="https://www.jianshu.com/p/7d3e3f6695a5"><div class="left"><img src="https://upload.jianshu.io/users/upload_avatars/2082074/89405df061ae?imageMogr2/auto-orient/strip|imageView2/1/w/96/h/96/format/webp" class="lazyload placeholder" data-srcset="https://upload.jianshu.io/users/upload_avatars/2082074/89405df061ae?imageMogr2/auto-orient/strip|imageView2/1/w/96/h/96/format/webp" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text">JAVA之枚举</p><p class="url">https://www.jianshu.com/p/7d3e3f6695a5</p></div></a></div><h4 id="什么是枚举？"><a href="#什么是枚举？" class="headerlink" title="什么是枚举？"></a>什么是枚举？</h4><p>我们学习过单例模式，即一个类只有一个实例。而枚举其实就是多例，一个类有多个实例，但实例的个数不是无穷的，是有限个数的。例如word文档的对齐方式有几种：左对齐、居中对齐、右对齐。开车的方向有几种：前、后、左、右！<br>我们称呼枚举类中实例为枚举项！一般一个枚举类的枚举项的个数不应该太多，如果一个枚举类有30个枚举项就太多了！</p><h4 id="定义枚举类型"><a href="#定义枚举类型" class="headerlink" title="定义枚举类型"></a>定义枚举类型</h4><p> 定义枚举类型需要使用enum关键字，例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">Direction</span> </span>&#123;</span><br><span class="line">    FRONT, BEHIND, LEFT, RIGHT;</span><br><span class="line">&#125;</span><br><span class="line">Direction d = Direction.FRONT;</span><br></pre></td></tr></table></figure><p>枚举可以用<code>equals</code>以及<code>==</code>来比较</p><h4 id="枚举与switch"><a href="#枚举与switch" class="headerlink" title="枚举与switch"></a>枚举与switch</h4><p> 枚举类型可以在switch中使用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Direction d = Direction.FRONT;</span><br><span class="line">  <span class="keyword">switch</span>(d) &#123;</span><br><span class="line">    <span class="keyword">case</span> FRONT: System.out.println(<span class="string">&quot;前面&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> BEHIND:System.out.println(<span class="string">&quot;后面&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LEFT:  System.out.println(<span class="string">&quot;左面&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> RIGHT: System.out.println(<span class="string">&quot;右面&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:System.out.println(<span class="string">&quot;错误的方向&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">Direction d1 = d;</span><br><span class="line">System.out.println(d1);</span><br></pre></td></tr></table></figure><div class="note warning"><p>在switch中，不能使用枚举类名称，例如：“case Direction.FRONT：”这是错误的，因为编译器会根据switch中d的类型来判定每个枚举类型，在case中必须直接给出与d相同类型的枚举选项，而不能再有类型。</p></div><h4 id="Enum类及方法"><a href="#Enum类及方法" class="headerlink" title="Enum类及方法"></a>Enum类及方法</h4><p>所有枚举类都是Enum的子类<br> 所有枚举类都默认是Enum类的子类，无需我们使用extends来继承。这说明Enum中的方法所有枚举类都拥有。</p><ul><li>int compareTo(E e)：比较两个枚举常量谁大谁小，其实比较的就是枚举常量在枚举类中声明的顺序，例如FRONT的下标为0，BEHIND下标为1，那么FRONT小于BEHIND；</li><li>boolean equals(Object o)：比较两个枚举常量是否相等；</li><li>int hashCode()：返回枚举常量的hashCode；</li><li>String name()：返回枚举常量的名字；</li><li>int ordinal()：返回枚举常量在枚举类中声明的序号，第一个枚举常量序号为0；</li><li>String toString()：把枚举常量转换成字符串；</li><li>static T valueOf(Class enumType, String name)：把字符串转换成枚举常量。</li></ul><h4 id="枚举类构造器"><a href="#枚举类构造器" class="headerlink" title="枚举类构造器"></a>枚举类构造器</h4><p> 枚举类也可以有构造器，构造器默认都是private修饰，而且只能是private。因为枚举类的实例不能让外界来创建！</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Direction</span> </span>&#123;</span><br><span class="line">    FRONT, BEHIND, LEFT, RIGHT;<span class="comment">//[在枚举常量后面必须添加分号，因为在枚举常量后面还有其他成员时，分号是必须的。枚举常量必须在枚举类中所有成员的上方声明。]</span></span><br><span class="line">    </span><br><span class="line">    Direction()<span class="comment">//[枚举类的构造器不可以添加访问修饰符，枚举类的构造器默认是private的。但你自己不能添加private来修饰构造器。] &#123;</span></span><br><span class="line">        System.out.println(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其实创建枚举项就等同于调用本类的无参构造器，所以FRONT、BEHIND、LEFT、RIGHT四个枚举项等同于调用了四次无参构造器，所以你会看到四个hello输出。</p><h4 id="枚举类成员"><a href="#枚举类成员" class="headerlink" title="枚举类成员"></a>枚举类成员</h4><p>其实枚举类和正常的类一样，可以有实例变量，实例方法，静态方法等等，只不过它的实例个数是有限的，不能再创建实例而已。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Direction</span> </span>&#123;</span><br><span class="line">    FRONT(<span class="string">&quot;front&quot;</span>), BEHIND(<span class="string">&quot;behind&quot;</span>), LEFT(<span class="string">&quot;left&quot;</span>), RIGHT(<span class="string">&quot;right&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    Direction(String name) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Direction d = Direction.FRONT;</span><br><span class="line">System.out.println(d.getName());</span><br></pre></td></tr></table></figure><p>因为Direction类只有唯一的构造器，并且是有参的构造器，所以在创建枚举项时，必须为构造器赋值：FRONT(“front”)，其中”front”就是传递给构造器的参数。你不要鄙视这种语法，你应该做的是接受这种语法！<br> Direction类中还有一个实例域：String name，我们在构造器中为其赋值，而且本类还提供了getName()这个实例方法，它会返回name的值。</p><h4 id="枚举类抽象方法"><a href="#枚举类抽象方法" class="headerlink" title="枚举类抽象方法"></a>枚举类抽象方法</h4><p>还可以在枚举类中给出抽象方法，然后在创建每个枚举项时使用“特殊”的语法来重复抽象方法。所谓“特殊”语法就是匿名内部类！也就是说每个枚举项都是一个匿名类的子类对象！</p><p>通常fun()方法应该定义为抽象的方法，因为每个枚举常量都会去重写它。<br> 你无法把Direction声明为抽象类，但需要声明fun()方法为抽象方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Direction</span> </span>&#123;</span><br><span class="line">    FRONT() &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fun</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;FROND：重写了fun()方法&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, </span><br><span class="line">    BEHIND() &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fun</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;BEHIND：重写了fun()方法&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, </span><br><span class="line">    LEFT() &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fun</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;LEFT：重写了fun()方法&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    RIGHT() &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fun</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;RIGHT：重写了fun()方法&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">fun</span><span class="params">()</span>[只需要把<span class="title">fun</span><span class="params">()</span>方法修改为抽象方法，但不可以把Direction类声明为抽象类。]</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="每个枚举类两个特殊方法"><a href="#每个枚举类两个特殊方法" class="headerlink" title="每个枚举类两个特殊方法"></a>每个枚举类两个特殊方法</h4><p>每个枚举类都有两个不用声明就可以调用的static方法，而且这两个方法不是父类中的方法。这又是枚举类特殊的地方，下面是Direction类的特殊方法。</p><ul><li>static Direction[] values()：返回本类所有枚举常量；</li><li>static Direction valueOf(String name)：通过枚举常量的名字返回Direction常量，注意，这个方法与Enum类中的valueOf()方法的参数个数不同。</li></ul><h3 id="流"><a href="#流" class="headerlink" title="流"></a>流</h3><h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><ol><li>字节流</li><li>字符流</li><li>输入流</li><li>输出流</li></ol><p>按输入输出分：输入流、输出流</p><p>按字符字节分：字符流、字节流</p><p>按直接使用还是增强分：节点流和处理流：</p><h4 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h4><p>input输入</p><p>output输出</p><p>stream流</p><p>writer字符输入流</p><p>reader字符输入流</p><p>File文件</p><h3 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h3><h4 id="checked-检测性异常"><a href="#checked-检测性异常" class="headerlink" title="checked 检测性异常"></a>checked 检测性异常</h4><p>再编译时就使用try、catch来预先捕获、提供解决方案</p><p>FileNotFoundException IOException InterruptedException</p><p>继承自Exception，必须捕获并处理</p><h4 id="运行时异常"><a href="#运行时异常" class="headerlink" title="运行时异常"></a>运行时异常</h4><p>自己的原因，通过检查一下解决</p><p>ArryIndexOutOfBoundsException ClassCastException 数学类异常（除0）</p><p>这种异常继承RuntimeException，不需要捕获，需要通过检查来预防</p><h4 id="错误-error"><a href="#错误-error" class="headerlink" title="错误 error"></a>错误 error</h4><p>StackOutOfMemoryError：如递归出不去</p><h4 id="自定义异常"><a href="#自定义异常" class="headerlink" title="自定义异常"></a>自定义异常</h4><p>有时需要通过自定义异常来帮助处理一些业务</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;java 基础知识整合&lt;/p&gt;</summary>
    
    
    
    <category term="Java" scheme="http://enderxiao.top/categories/Java/"/>
    
    <category term="基础" scheme="http://enderxiao.top/categories/Java/%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="Java" scheme="http://enderxiao.top/tags/Java/"/>
    
    <category term="Java基础语法" scheme="http://enderxiao.top/tags/Java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>离散数学:集合</title>
    <link href="http://enderxiao.top/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/%E5%A4%8D%E8%AF%95/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6-%E9%9B%86%E5%90%88/"/>
    <id>http://enderxiao.top/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/%E5%A4%8D%E8%AF%95/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6-%E9%9B%86%E5%90%88/</id>
    <published>2021-01-23T02:24:52.000Z</published>
    <updated>2021-03-14T08:32:48.589Z</updated>
    
    <content type="html"><![CDATA[<h2 id="集合基本概念"><a href="#集合基本概念" class="headerlink" title="集合基本概念"></a>集合基本概念</h2><h3 id="集合的表示法"><a href="#集合的表示法" class="headerlink" title="集合的表示法"></a>集合的表示法</h3><ol><li>列举法</li><li>特征法</li></ol><h3 id="子集"><a href="#子集" class="headerlink" title="子集"></a>子集</h3><div class="note guide cyan"><p>定理1.1：集合A和集合B相等的充要条件是：$A \subseteq B \bigwedge B \subseteq A$</p></div><p>空集$ \emptyset $是任何集合的子集</p><h3 id="全集和补集"><a href="#全集和补集" class="headerlink" title="全集和补集"></a>全集和补集</h3><blockquote><p>补集：设集合A，属于全集E，对于任意元素x</p><ol><li>$x \in E$</li><li>$x \notin A$</li></ol><p>则有x促成的集合称为A的补集合，记为：~A或$\bar{A}$</p></blockquote><h3 id="幂集"><a href="#幂集" class="headerlink" title="幂集"></a>幂集</h3><blockquote><p>幂集：设A是集合，有A的所有子集作为元素构成的集合称为A的幂集，记为P(A)</p></blockquote><div class="note guide cyan"><p>定理1.2：设A是具有n个元素的有限集，即|A| = n ，其幂集的基$|P(A)| = 2^n$</p></div><h4 id="定理1-1-2-证明"><a href="#定理1-1-2-证明" class="headerlink" title="定理1.1.2 证明"></a>定理1.1.2 证明</h4><p>$$<br>证明：<br>根据排列组合规律，幂集的基为：|P(A)| = C_n^0+C_n^1+C_n^2+…+C_n^n<br>$$<br>$$<br>由二项式定理得：(a+b)^n = C_n^0 \times a^n + C_n^1 \times a^{(n-1)} \times b^1 + … + C_n^{n-1} \times a^1 \times b^{n-1} + C_n^n \times b^n<br>$$<br>$$<br>令a=b=1，得：2^n = C_n^0+C_n^1+C_n^2+…+C_n^n<br>$$<br>$$<br>\therefore |P(A)| = 2^n<br>$$</p><p>由此我们可以知道，一个集合A的所有子集的个数，一定是2的幂次，那么如何遍历一个集合的所有子集呢？</p><h4 id="子集的遍历（生成幂集）"><a href="#子集的遍历（生成幂集）" class="headerlink" title="子集的遍历（生成幂集）"></a>子集的遍历（生成幂集）</h4><p>遍历一个集合的子集，也就是要生成该集合对应的幂集，由于幂集的元素个数总为2的次方，而对于集合中的每一个元素，讨论他是否在某个子集中时，他只有两种状态，在于不在，于是可以用0，1两种表示，则我们可以用n位二进制来表示幂集中的所有元素，而由定理1.1.2的证明我们可以知道n位二进制数是足够的，下面我们来实现一下：</p><details cyan><summary> 查看代码 </summary>              <div class='content'>              <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BinarySearch</span><span class="params">(<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; &amp;mySet)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> length = mySet.size();</span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">1</span> &lt;&lt; length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)<span class="comment">//外层循环遍历序号</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)<span class="comment">//内层循环遍历该序号二进制表示的每一位</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; (<span class="number">1</span> &lt;&lt; j))<span class="comment">//判断当前位是否为1</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; j &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="集合基本运算"><a href="#集合基本运算" class="headerlink" title="集合基本运算"></a>集合基本运算</h2><h3 id="交和并"><a href="#交和并" class="headerlink" title="交和并"></a>交和并</h3><ol><li>$A \cap B = B \cap A$，$A \cup B = B \cup A$</li><li>$(A \cap B) \cap C = A \cap (B \cap C)$，$(A \cup B) \cup C = A \cup (B \cup C)$——结合律</li><li>$A \cap A = A$，$A \cup A = A$</li><li>$A \cap \emptyset = \emptyset$，$A \cup \emptyset = A$</li><li>$A \cap E = A$，$A \cup E = E$</li></ol><h4 id="分配律"><a href="#分配律" class="headerlink" title="分配律"></a>分配律</h4><div class="note guide cyan"><p>定理1.3：$A \cap (B \cup C) = (A \cap B) \cup (A \cap C)$</p></div><div class="note guide cyan"><p>定理1.3：$A \cup (B \cap C) = (A \cup B) \cap (A \cup C)$</p></div><h4 id="德·摩根率"><a href="#德·摩根率" class="headerlink" title="德·摩根率"></a>德·摩根率</h4><div class="note guide cyan"><p>定理1.4：$\bar{ A \cup B } = \bar{A} \cap \bar{B}$</p></div><div class="note guide cyan"><p>定理1.4：$\bar{ A \cap B } = \bar{A} \cup \bar{B}$</p></div><h5 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h5><details cyan><summary> 点击查看证明 </summary>              <div class='content'>              <p>$$<br>证明：设\bar{ A \cup B } = P,\bar{A} \cap \bar{B} = Q, x \in P,<br>$$<br>$$<br>则 x \notin A \bigwedge  x \notin B<br>$$<br>$$<br>即 x \in \bar{A} \bigwedge  x \in \bar{B}<br>$$<br>$$<br>\therefore x \in \bar{A} \cap \bar{B}<br>$$<br>$$<br>\therefore P \subseteq Q<br>$$<br>$$<br>设y \in Q<br>$$<br>$$<br>则y \in \bar{A} \bigwedge  y \in \bar{B}<br>$$<br>$$<br>\therefore y \notin A \bigwedge  y \notin B<br>$$<br>$$<br>\therefore y \in P<br>$$<br>$$<br>\therefore Q \subseteq P<br>$$<br>$$<br>由定理1.1得P = Q<br>$$</p>              </div>            </details><p>定理1.3也可由类似方法证明</p><h4 id="吸收律"><a href="#吸收律" class="headerlink" title="吸收律"></a>吸收律</h4><div class="note guide cyan"><p>定理1.5：$A \cup (A \cap B) = A$</p></div><div class="note guide cyan"><p>定理1.5：$A \cap (A \cup B) = A$</p></div><h4 id="不知名公式"><a href="#不知名公式" class="headerlink" title="不知名公式"></a>不知名公式</h4><div class="note guide cyan"><p>定理1.6：$A \cup (\bar{A} \cap B) = A \cup B$</p></div><h3 id="差和对称差-异或"><a href="#差和对称差-异或" class="headerlink" title="差和对称差(异或)"></a>差和对称差(异或)</h3><blockquote><p>差：设A、B为集合，x为元素</p><ol><li>$x \in A$</li><li>$x \notin B$</li></ol><p>由x组成的集合称为A与B的差集，记为A-B</p></blockquote><ol><li>$A-A = \emptyset$</li><li>$ A - \emptyset = A$</li><li>$A - E = \emptyset$</li><li>$E - A = \bar{A}$</li></ol><div class="note guide cyan"><p>定理1.7：$A - B = A \cap \bar{B}$</p></div><div class="note guide cyan"><p>定理1.7：$A - (B\cup C) = (A - B) \cap (A-C)$</p></div><div class="note guide cyan"><p>定理1.7：$A - (B\cap C) = (A - B) \cup (A-C)$</p></div><blockquote><p>对称差：设集合A、B，x为元素</p><ol><li>$x \in A \bigwedge x \notin B \bigvee$</li><li>$x \in B \bigwedge x \notin A$</li></ol><p>由x组成的集合称为A与B的对称差，记为$A \oplus B$</p></blockquote><div class="note guide cyan"><p>定理1.8：$A \oplus B = (A - B) \cup (B - A)$</p></div><div class="note guide cyan"><p>定理1.8：$A \oplus B = (A \cup B) \cap (\bar{B} \cup \bar{A} ) = (A \cup B) - (A \cap B)$</p></div><div class="note guide cyan"><p>定理1.8：$A \cap (B \oplus C) = (A \cap B) \oplus (A \cap C)$</p></div><h2 id="集合运算总结"><a href="#集合运算总结" class="headerlink" title="集合运算总结"></a>集合运算总结</h2><h3 id="等幂率"><a href="#等幂率" class="headerlink" title="等幂率"></a>等幂率</h3><ol><li>$A \cap A = A$</li><li>$A \cup A = A$</li></ol><h3 id="交换率"><a href="#交换率" class="headerlink" title="交换率"></a>交换率</h3><ol><li>$A \cap B = B \cap A$</li><li>$A \cup B = B \cup A$</li><li>$A \oplus B = B \oplus A$</li></ol><h3 id="结合律"><a href="#结合律" class="headerlink" title="结合律"></a>结合律</h3><ol><li>$(A \cap B) \cap C = A \cap (B \cap C)$</li><li>$(A \cup B) \cup C = A \cup (B \cup C)$</li><li>$(A \oplus B) \oplus C = A \oplus (B \oplus C)$</li></ol><h3 id="分配律-1"><a href="#分配律-1" class="headerlink" title="分配律"></a>分配律</h3><ol><li>$A \cap (B \cup C) = (A \cap B) \cup (A \cap C)$</li><li>$A \cup (B \cap C) = (A \cup B) \cap (A \cup C)$</li><li>$A \cap (B \oplus C) = (A \cap B) \oplus (A \cap C)$</li></ol><h3 id="摩根率"><a href="#摩根率" class="headerlink" title="摩根率"></a>摩根率</h3><ol><li>$\bar{A \cap B} = \bar{A} \cup \bar{B}$</li><li>$\bar{A \cup B} = \bar{A} \cap \bar{B}$</li></ol><h3 id="吸收率"><a href="#吸收率" class="headerlink" title="吸收率"></a>吸收率</h3><ol><li>$A \cap (A \cup B) = A$</li><li>$A \cup (A \cap B) = A$</li></ol><h3 id="补余率"><a href="#补余率" class="headerlink" title="补余率"></a>补余率</h3><ol><li>$A \cap \bar{A} = \emptyset$</li><li>$A \cup \bar{A} = E$</li></ol><h3 id="同一率"><a href="#同一率" class="headerlink" title="同一率"></a>同一率</h3><ol><li>$A \cap E = A$</li><li>$A \cup \emptyset = A$</li></ol><h3 id="零一率"><a href="#零一率" class="headerlink" title="零一率"></a>零一率</h3><ol><li>$A \cup E = E$</li><li>$A \cap \emptyset  =\emptyset$</li></ol><h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><ol><li>$\bar{\bar{A}} = A$</li><li>$A - B = A \cap \bar{B}$</li><li>$A \oplus B = (A - B) \cup (B - A) = (A \cap \bar{B} \cup (\bar{A} \cap B) = (A \cup B) - (A \cap B) = (A \cup B) \cap (\bar{A} \cup \bar{B})$</li><li>$A \oplus A  = \emptyset$</li><li>$\bar{\emptyset} = E$</li><li>$ \bar{E} = \emptyset$</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;集合基本概念&quot;&gt;&lt;a href=&quot;#集合基本概念&quot; class=&quot;headerlink&quot; title=&quot;集合基本概念&quot;&gt;&lt;/a&gt;集合基本概念&lt;/h2&gt;&lt;h3 id=&quot;集合的表示法&quot;&gt;&lt;a href=&quot;#集合的表示法&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    <category term="离散数学" scheme="http://enderxiao.top/categories/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/"/>
    
    <category term="研究生入学考试" scheme="http://enderxiao.top/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/"/>
    
    <category term="复试" scheme="http://enderxiao.top/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E5%85%A5%E5%AD%A6%E8%80%83%E8%AF%95/%E5%A4%8D%E8%AF%95/"/>
    
    
    <category term="离散数学" scheme="http://enderxiao.top/tags/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/"/>
    
    <category term="集合" scheme="http://enderxiao.top/tags/%E9%9B%86%E5%90%88/"/>
    
    <category term="算法" scheme="http://enderxiao.top/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="二进制枚举" scheme="http://enderxiao.top/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9E%9A%E4%B8%BE/"/>
    
  </entry>
  
  <entry>
    <title>使用hexo搭建个人博客</title>
    <link href="http://enderxiao.top/Life/%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    <id>http://enderxiao.top/Life/%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</id>
    <published>2021-01-19T11:52:50.000Z</published>
    <updated>2021-02-26T09:06:03.041Z</updated>
    
    <content type="html"><![CDATA[<h2 id="搭建博客的理由"><a href="#搭建博客的理由" class="headerlink" title="搭建博客的理由"></a>搭建博客的理由</h2><p>记得刚上大学，进入到ACM，遇到想了半天没思路的的题，习惯性的上百度看别人的解析，于是发现很多人都会去维护一个自己的“网站”（当时觉得这种由自己网站的大佬好酷2333），当时并不知道是什么，于是各种查资料，并自学了 一些前端的技术，于是使用Hexo着手搭建了自己的第一个博客，当时搭建博客的主要目的是写一些做题笔记，好让自己赛前复习用，之后由于要给新加入ACM的新生们上课，于是就用作发布课程讲义了，再后来，大三跟队友做了些项目，外加考研复习，第一个博客就基本上没怎么更新了，渐渐被我遗忘在了角落，直到疫情期间在家倒腾笔记本的时候把南侨芯片烧了。。。。，电脑修好拿回来，脑子一热重做了系统，于是原来的博客由于没有做备份于是就这么没了。</p><p>现在已经是大四下学期了，刚考完研究生的我正焦急的等待着成绩，我想着也不能让自己闲着，于是就决定重新弄一弄自己的博客。</p><p>在制作第一个博客的时候，我对前端“三大金刚”的学习还是入门阶段，对hexo的使用也紧紧停留于看看别人的快速入门指南这种程度。于是从头再来，认真阅读官方文档（其实内容确实不多，主要是因为之前懒2333）</p><p>那么，回到标题，我为什么想要搭建一个个人博客呢，在我进入ACM之后，我认识到了一个问题，那就是对我来说，掌握一门知识，输出比输入要难，如果一门知识我可以很好的把他输出给别人看，那么说明我对这门知识的掌握程度上升了一个高度。撰写博客时，我对学过的知识进行回顾、归纳、总结、并用自己的话说出来，这样对我来说大概是一个很好的复习、巩固的过程。所以就有了这篇教学文档，我喜欢把我认为好的东西分享给身边的朋友以及学弟学妹。</p><h2 id="第一部分：Hexo、Github，域名"><a href="#第一部分：Hexo、Github，域名" class="headerlink" title="第一部分：Hexo、Github，域名"></a>第一部分：Hexo、Github，域名</h2><p>这一部分大家的教程都大同小异，但我身边的朋友们其实在项目中Git接触的较少，所以我会更多的去讲解一些Git的知识，并且可能涉及到一些计算机网络方面的知识。</p><h3 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h3><h4 id="Hexo简介"><a href="#Hexo简介" class="headerlink" title="Hexo简介"></a>Hexo简介</h4><div class="note quote"><p>是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p></div><p>这是<a href="https://hexo.io/zh-cn/">Hexo官网</a>对hexo的介绍，Hexo，基于Node.js，依赖少，便于安装，且可托管到GitHub等网站，许多人喜欢使用这个框架搭建自己的个人网站，Hexo的创建者来自台湾，对中文支持友好。</p><h4 id="Hexo搭建"><a href="#Hexo搭建" class="headerlink" title="Hexo搭建"></a>Hexo搭建</h4><p>由于Hexo时基于Node.js的，所以在安装Hexo之前，我们得安装Node.js，下载地址：</p><div class="note download"><p><a href="https://nodejs.org/en/download/">Node.js官网</a></p></div><h5 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h5><p>Node.js是什么呢，下面引用一段百度百科</p><div class="note quote"><p>Node.js发布于2009年5月，由Ryan Dahl开发，是一个基于Chrome V8引擎的JavaScript运行环境，使用了一个事件驱动、非阻塞式I/O模型， [1] 让JavaScript 运行在服务端的开发平台，它让JavaScript成为与PHP、Python、Perl、Ruby等服务端语言平起平坐的脚本语言。</p></div><p>我对Node.js的理解是什么呢：</p><ol><li>我理解的前端”三大金刚”包括：HTML、CSS、Javascript</li><li>其中Javascript是一门脚本语言，用来定义一个网页的行为，比如定义点击某个按钮会发生什么样的事情</li><li>那么Javascript能不能像C++、Java、Python那样来写服务端逻辑呢，本来是不能的，直到Node.js的出现</li><li>Node.js是一个基于Chrome V8引擎的JS运行环境，可以让JS运行在服务端的开发平台。也就是说，可以用JS写后端逻辑了</li></ol><h5 id="NPM"><a href="#NPM" class="headerlink" title="NPM"></a>NPM</h5><p>接下来的安装我们需要用到npm，npm啥呢</p><p>NPM:</p><div class="note quote"><p>npm is the world’s largest software registry.</p></div><p>这段话来自npm官网，来自世界各地的开发者使用npm来分享他们的开源项目，npm被包含在了node.js中，==也就是说，当我们安装上node.js的时候，npm就一起被我们安装了==，因为npm其实是node.js的包管理工具，在前端开发中，许多需要反复使用的代码大家会做成模块发布到npm上，这是只要通过npm下载使用即可，而且npm会将该模块有以来关系的模块全部下载管理。</p><p>以上两个软件被安装以后，可以打开windows下的cmd，或者powershell，使用如下命令验证是否安装成功：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure><p>另外，linux下的安装比windwos下要方便很多，只需要如下两行命令即可：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nodejs</span><br><span class="line">sudo apt-get install npm</span><br></pre></td></tr></table></figure><h4 id="安装Git"><a href="#安装Git" class="headerlink" title="安装Git"></a>安装Git</h4><h5 id="Git简介"><a href="#Git简介" class="headerlink" title="Git简介"></a>Git简介</h5><p>每次介绍git时，就不得不提起linux，在程序员数量越来越多的今天，Linux相信已经不是什么十分陌生的的名词了，Linus在1991年创建了开源的Linux，据说这位哥在维护Linux时，由于开源项目的特性，有世界各地的程序员向他提出改进方案，Linus为了管理这些修改而产生的不同版本，开发了git这么一种项目管理工具，当时CVS、SVN这些免费的管理工具速度较慢，且需要联网，而另一些商用版本管理工具需要收费，与开源精神相悖，于是这位哥就自己造轮子，花了两周的时间用C写了一个分布式版本控制系统，就是Git。</p><p>那么什么是版本管理工具呢，这里引用一下料廖雪峰老师的例子：</p><div class="tag link"><a class="link-card" title="廖雪峰Git教程" href="https://www.liaoxuefeng.com/wiki/896043488029600/896067008724000"><div class="left"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" class="lazyload placeholder" data-srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/256/safari.png" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text">廖雪峰Git教程</p><p class="url">https://www.liaoxuefeng.com/wiki/896043488029600/896067008724000</p></div></a></div><div class="note "><p><strong>什么是Git</strong></p><p>Git是目前世界上最先进的分布式版本控制系统（没有之一）。</p><p>Git有什么特点？简单来说就是：高端大气上档次！</p><p>那什么是版本控制系统？</p><p>如果你用Microsoft Word写过长篇大论，那你一定有这样的经历：</p><p>想删除一个段落，又怕将来想恢复找不回来怎么办？有办法，先把当前文件“另存为……”一个新的Word文件，再接着改，改到一定程度，再“另存为……”一个新文件，这样一直改下去，最后你的Word文档变成了这样：</p><img src="https://i.postimg.cc/qBPh9K8h/0.jpg" class="lazyload placeholder" data-srcset="https://i.postimg.cc/qBPh9K8h/0.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" alt="就很烦" style="zoom: 200%;" /><p>过了一周，你想找回被删除的文字，但是已经记不清删除前保存在哪个文件里了，只好一个一个文件去找，真麻烦。</p><p>看着一堆乱七八糟的文件，想保留最新的一个，然后把其他的删掉，又怕哪天会用上，还不敢删，真郁闷。</p><p>更要命的是，有些部分需要你的财务同事帮助填写，于是你把文件Copy到U盘里给她（也可能通过Email发送一份给她），然后，你继续修改Word文件。一天后，同事再把Word文件传给你，此时，你必须想想，发给她之后到你收到她的文件期间，你作了哪些改动，得把你的改动和她的部分合并，真困难。</p><p>于是你想，如果有一个软件，不但能自动帮我记录每次文件的改动，还可以让同事协作编辑，这样就不用自己管理一堆类似的文件了，也不需要把文件传来传去。如果想查看某次改动，只需要在软件里瞄一眼就可以，岂不是很方便？</p><p>这个软件用起来就应该像这个样子，能记录每次文件的改动：</p><table><thead><tr><th>版本</th><th>文件名</th><th>用户</th><th>说明</th><th>日期</th></tr></thead><tbody><tr><td>1</td><td>service.doc</td><td>张三</td><td>删除了软件服务条款5</td><td>7/12 10:38</td></tr><tr><td>2</td><td>service.doc</td><td>张三</td><td>增加了License人数限制</td><td>7/12 18:09</td></tr><tr><td>3</td><td>service.doc</td><td>李四</td><td>财务部门调整了合同金额</td><td>7/13 9:51</td></tr><tr><td>4</td><td>service.doc</td><td>张三</td><td>延长了免费升级周期</td><td>7/14 15:17</td></tr></tbody></table><p>这样，你就结束了手动管理多个“版本”的史前时代，进入到版本控制的20世纪。</p></div><p>有了Git的帮助，我们就可以很方便的管理我们的hexo本博客文章了，此外使用Git，还能将你的博客长传到Github，部署到Github，成为你的个人主页，Git的操作是基于命令行的，各种命令的用法可以前往廖雪峰老师的博客进行查看，学习。</p><h5 id="Git-安装"><a href="#Git-安装" class="headerlink" title="Git 安装"></a>Git 安装</h5><div class="tabs" id="tab-id"><ul class="nav-tabs"><li class="tab active"><a class="#tab-id-1">Windows</a></li><li class="tab"><a class="#tab-id-2">Linux</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-id-1"><div class="note download"><p><a href="https://gitforwindows.org/">git官网</a></p></div></div><div class="tab-pane" id="tab-id-2"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git</span><br></pre></td></tr></table></figure></div></div></div><p>安装完成以后，使用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git --version</span><br></pre></td></tr></table></figure><p>查看版本号，进行验证</p><h4 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h4><p>以上工具安装完成后，就能开始搭建Hexo静态博客了，首先在本地创建一个文件夹，给它一个响亮的名字，比如EnderBlog，然后使用==cd==命令进入这个文件夹，或者在这个文件夹下右键git bash打开。</p><p>使用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>命令安装hexo，使用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo -v</span><br></pre></td></tr></table></figure><p>查看版本验证安装。</p><p>接下来初始化一下hexo</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init myBlog</span><br></pre></td></tr></table></figure><p>此处myBlog可以任意起名，会在你的当前目录下创建一个以该字符串命名的目录，hexo会为你创建一个博客框架，接下里使用命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd myBlog #此处用cd到你之前起名的文件夹</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><p>安装hexo的所有依赖包，该命令会在我们的当前目录下生成一个node_modules目录，用来存放这些依赖包</p><p>到目前为止，我们的博客目录应该包含如下文件:</p><ul><li>node_modules: 存放依赖包</li><li>public: 存放有markdown生成的页面</li><li>scaffolds: 存放用于生成文章的模板</li><li>source: 存放文章的本体</li><li>themes: 存放主题</li><li>config.yml: 博客的配置文件</li></ul><p>接下来一个博客的大致框架就已经搭建好了，使用如下命令，就能直接看到我们的第一个版本的博客了：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g #hexo的生成命令，完整形式为hexo generate，用于根据markdown生成一个html页面</span><br><span class="line">hexo s #启动hexo服务，完整形式为hexo serve，用于启动hexo服务，</span><br></pre></td></tr></table></figure><p>此时，在浏览器中输入localhost:4000就可以看到你生成的博客了。</p><blockquote><p>localhost-即127.0.0.1，是回送地址，一般代表本机地址<br>4000带表端口号，传输层用于分流/合流</p></blockquote><h3 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h3><p>这里引用知乎提问：Github 是怎样的一个存在，的一个回答，该回答来自知乎ID：<a href="https://www.zhihu.com/people/gotolab">古土雷柏</a></p><div class="tag link"><a class="link-card" title="Github 是怎样的一个存在" href="https://www.zhihu.com/question/28976652?sort=created"><div class="left"><img src="https://pic3.zhimg.com/v2-b375258135ec537d868d0e0f78bd98a5_xl.jpg" class="lazyload placeholder" data-srcset="https://pic3.zhimg.com/v2-b375258135ec537d868d0e0f78bd98a5_xl.jpg" srcset="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@3/img/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg"/></div><div class="right"><p class="text">Github 是怎样的一个存在</p><p class="url">https://www.zhihu.com/question/28976652?sort=created</p></div></a></div><div class="note quote"><p>github是共产主义在软件开发领域的具体实现样板之一，即以生产资料社会公有制为基础（代码开源），以社会化合作（离散化的个人、组织等社会颗粒）为生产方式，主要采用合作社组织形式（项目组）的技术支撑平台。</p></div><p>虽然可能说的比较夸张，但是确实把Github的模式很好的概况了，而且也方便理解。</p><p>github可以通过git，将你的代码托管到这一平台上，平台社区里的用户可以共享到你的项目。通过issue的方式向你提出建议。</p><p>那么第一步就是上Github申请一个账号：<a href="https://github.com/">Github</a></p><p>我们利用Github提供的Github Pages功能搭建一个个人博客。</p><p>登录github之后选择新建一个仓库</p><blockquote><p>未完待续…..</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;搭建博客的理由&quot;&gt;&lt;a href=&quot;#搭建博客的理由&quot; class=&quot;headerlink&quot; title=&quot;搭建博客的理由&quot;&gt;&lt;/a&gt;搭建博客的理由&lt;/h2&gt;&lt;p&gt;记得刚上大学，进入到ACM，遇到想了半天没思路的的题，习惯性的上百度看别人的解析，于是发现很多人都会</summary>
      
    
    
    
    <category term="Life" scheme="http://enderxiao.top/categories/Life/"/>
    
    
    <category term="life" scheme="http://enderxiao.top/tags/life/"/>
    
    <category term="blog" scheme="http://enderxiao.top/tags/blog/"/>
    
  </entry>
  
  <entry>
    <title>数论番外:错排问题</title>
    <link href="http://enderxiao.top/ACM/%E6%95%B0%E8%AE%BA%E7%95%AA%E5%A4%96/%E6%95%B0%E8%AE%BA%E7%95%AA%E5%A4%96-%E9%94%99%E6%8E%92%E9%97%AE%E9%A2%98/"/>
    <id>http://enderxiao.top/ACM/%E6%95%B0%E8%AE%BA%E7%95%AA%E5%A4%96/%E6%95%B0%E8%AE%BA%E7%95%AA%E5%A4%96-%E9%94%99%E6%8E%92%E9%97%AE%E9%A2%98/</id>
    <published>2021-01-18T12:54:17.000Z</published>
    <updated>2021-01-18T13:33:33.927Z</updated>
    
    <content type="html"><![CDATA[<h2 id="错排问题"><a href="#错排问题" class="headerlink" title="错排问题"></a>错排问题</h2><h3 id="什么是错排问题"><a href="#什么是错排问题" class="headerlink" title="什么是错排问题"></a>什么是错排问题</h3><p>若有n个人，都想给其他n-1个人中的任意一个送信（当然不能送给自己），请问一共有多少种送法？</p><h3 id="建模"><a href="#建模" class="headerlink" title="建模"></a>建模</h3><p>对于一个具体的题目，数学上喜欢抽象，于是可以把这样的问题抽象为一个数学模型，下面给出定义</p><p>对于n个元素，若一个排列中所有的元素都不在自己原来的位置上，那么这样的排列就叫原排列的一个错排，n个元素的错排数记为D(n)。研究一个排列的错排个数的问题，就叫做错排问题或称为更列问题</p><h3 id="归纳"><a href="#归纳" class="headerlink" title="归纳"></a>归纳</h3><p>下面给出一些较小的错排数：</p><p>对于只包含1个元素的序列，全排列为1！=1，即没有错排，则错排数D(1)=0，<br>对于2个元素的序列，全排列为2！=2，假设是1，2；则错排数只有一组：2，1。则错排数D(2)=1;</p><p>以此类推</p><p>0，1，2，9，44，265，14833…….</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>上述推导就是使用枚举法将错排数一一找出，聪明的犊子应该已经发现了其中的规律，下面给出一个递归的推导式：</p><p>$ D(n)=(n-1)*(D(n-1)+D(n-2)) $</p><p>感兴趣的同学可以使用数学归纳法证明一下这个推导式的正确性，这里不予讨论。</p><h3 id="推导"><a href="#推导" class="headerlink" title="推导"></a>推导</h3><p>观察发现，此递推式是一个递归方法（指有限步骤内，根据特定的法则或公式对一个或多个前面的元素进行运算，以确定一系列元素的方法）。于是思考，能否使用递归的思想来推导这个递归方法。</p><p>对于n个元素，显然D(1)=0,D(2)=1,则思考当$ n \geq 3 $时的情况</p><p>若此时第n个数，恰好放在k的位置，且$ k！=n $，则对于n的位置上，就出现了两种情况：</p><p>Ⅰ.n的位置上恰好为k时</p><p>Ⅱ.n的位置上不为k时</p><p>下面对两种情况分类讨论：</p><p>Ⅰ.此时情况较为简单，即n和k调换位置，其他$n-2$个数恰好构成了新的错排问题，错排数为D(n-2)。</p><p>Ⅱ.此时因为k在n的位置上的情况已经讨论过了，所以在此情况下，无法在n的位置上，此时可以将n的位置视为元素k原本的位置（仔细思考）。那么k与剩下$n-2$个数又构成了新的错排问题，错排数为D(n-1)；</p><p>综上，在n确认放在k的位置（$ k!=n $）上时，有$ D(n-1)+D(n-2) $个错排，而考虑k有$ n-1 $种可能，所以最后得到递推式：$ D(n)=(n-1)\times (D(n-1)+D(n-2)) $</p><h3 id="递归证明"><a href="#递归证明" class="headerlink" title="递归证明"></a>递归证明</h3><p>因为错排数中存在某种规律，于是我们尝试推导错排数所组成的数列的通项公式。</p><p>通过之前的推导我们知道，</p><p>$ D(n)=(n-1) \times (D(n-1)+D(n-2)) $</p><p>此处为了方便起见，我们设 $ D(n)=n! \times M(n) $(为什么之后用其他的方法证明),其中 </p><p>$ M(1)=0,M(2)=1/2……M(n)=1/n $<br>于是原推导式变为了：</p><p>$ D(n)=n! \times M(n)=(n-1)\times ((n-1)! \times M(n-1)+(n-2)! \times M(n-2)) $</p><p>展开得: </p><p>$ n! \times M(n)=(n-1) \times (n-1)! \times M(n-1)+(n-1) \times (n-2)! \times M(n-2) $</p><p>化简得: </p><p>$ n! \times M(n)=n! \times M(n-1)-(n-1)! \times M(n-1)+(n-1)! \times M(n-2) $</p><p>同除(n-1)!: </p><p>$ n \times M(n)=n \times M(n-1)-M(n-1)+M(n-2) $</p><p>移项得: </p><p>$ M(n)-M(n-1)=(-1/n) \times (M(n-1)-M(n-2)) $</p><p>于是展开 </p><p>$ (M(n-1)-M(n-2)) $</p><p>得:</p><p>$ M(n)-M(n-1)=(-1/n) \times (-1/(n-1)) \times (M(n-2)-M(n-3))) $</p><p>依次类推得：</p><p>$ M(n)-M(n-1)=(-1/n) \times (-1/(n-1))……(-1/3) \times (M(2)-M(1)) \times (-1) \times (-1) $(多乘两个-1为了方便合并)</p><p>化简得: </p><p>$ M(n)-M(n-1)=(-1)^n \times 1/n! $</p><p>于是使用累加法：</p><p>$ M(n)-M(n-1)=(-1)^n \times 1/n! $</p><p>$ M(n-1)-M(n-2)=(-1)^{n-1} \times 1/(n-1)! $</p><p>$ M(n-2)-M(n-3)=(-1)^{n-2} \times 1/(n-2)! $</p><p>……</p><p>$ M(2)-M(1)=(-1)^2 \times 1/2! $</p><p>累加得: </p><p>$ M(n)-M(1)=(-1)^2 \times 1/2!+…+(-1)^{n-2} \times 1/(n-2)!+(-1)^{n-1} \times 1/(n-1)!+(-1)^n \times 1/n! $</p><p>则 $ D(n)=n! \times (1/2!-1/3!+1/4!-…+(-1)^n \times 1/n!) $</p><h3 id="容斥原理证明"><a href="#容斥原理证明" class="headerlink" title="容斥原理证明"></a>容斥原理证明</h3><p>于是我们得到了错排数的通项公式，聪明的犊子可能已经发现了，在使用递归法证明的时候里面蕴藏了一点容斥原理的知识，下面我们使用容斥原理来证明这个通项公式</p><p>对于n个元素，如果k的位置刚好放的是k，那么这样的排列一共有(n-1)!个，考虑到k可以取n个不同的值，所以一共有 $ n_(n-1)! $ 种情况，至少放对了一个，但是我们需要求的是一个都没放对的排列个数，所以我们需要使用总的排列数减去这些，即 $ n!-n_(n-1)! $ ,但是至少放对了一个的情况下又包含了放对2个的情况，我们多减了一次，于是我们需要加回来，但是至少放对2个的情况种又包含了至少放对3个的情况，于是又要加上,……,依次类推，我们得到式子：</p><p>$ D(n)=n!-C_n^1\times (n-1)! + C^2_n \times (n-2)! - C^3_n \times (n-3)!+…+(-1)^n \times C^n_n \times 0! $</p><p>即 $ D(n)=n!(1-1/1!+1/2!+…+(-1)^n\times 1/n!) $</p><p>即 $ D(n)=n!(1/2!+…+(-1)^n\times 1/n!) $</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;错排问题&quot;&gt;&lt;a href=&quot;#错排问题&quot; class=&quot;headerlink&quot; title=&quot;错排问题&quot;&gt;&lt;/a&gt;错排问题&lt;/h2&gt;&lt;h3 id=&quot;什么是错排问题&quot;&gt;&lt;a href=&quot;#什么是错排问题&quot; class=&quot;headerlink&quot; title=&quot;什么是</summary>
      
    
    
    
    <category term="ACM" scheme="http://enderxiao.top/categories/ACM/"/>
    
    <category term="算法" scheme="http://enderxiao.top/categories/ACM/%E7%AE%97%E6%B3%95/"/>
    
    <category term="数论番外" scheme="http://enderxiao.top/categories/ACM/%E6%95%B0%E8%AE%BA%E7%95%AA%E5%A4%96/"/>
    
    
    <category term="数论" scheme="http://enderxiao.top/tags/%E6%95%B0%E8%AE%BA/"/>
    
    <category term="算法竞赛" scheme="http://enderxiao.top/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>数论进阶:Lucas定理</title>
    <link href="http://enderxiao.top/ACM/%E6%95%B0%E8%AE%BA%E8%BF%9B%E9%98%B6/%E6%95%B0%E8%AE%BA%E8%BF%9B%E9%98%B6-lucas%E5%AE%9A%E7%90%86/"/>
    <id>http://enderxiao.top/ACM/%E6%95%B0%E8%AE%BA%E8%BF%9B%E9%98%B6/%E6%95%B0%E8%AE%BA%E8%BF%9B%E9%98%B6-lucas%E5%AE%9A%E7%90%86/</id>
    <published>2021-01-18T12:43:11.000Z</published>
    <updated>2021-01-18T12:46:16.107Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Lucas定理"><a href="#Lucas定理" class="headerlink" title="Lucas定理"></a>Lucas定理</h2><p><a href="https://baike.baidu.com/item/lucas/4326261?fr=aladdin">Lucas定理详述</a></p><h3 id="内容"><a href="#内容" class="headerlink" title="内容"></a>内容</h3><p>对于一个组合数$C_m^n$，取模一个素数$p$的值，假设$n=a\times p+b$,$m=c\times p+d$有：</p><p>$C_n^m≡C_a^c\times C_b^d(\mod p)$</p><h3 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h3><p>先证明一个一会儿要用到的定理：</p><p>$(1+x)^p≡1+x^p(\mod p)$</p><p>这里可以用费马小定理加以证明:</p><p>由于$(1+x)^p≡(1+x)(\mod p)$</p><p>且$x^p≡x(\mod p)$即$1+x^p≡1+x(\mod p)$</p><p>于是得证：$(1+x)^p≡1+x^p(\mod p)$</p><p>然后设$n=a\times p+b$,$m=c\times p+d$</p><p>于是：$(1+x)^n≡(1+x)^{a\times p+b}(\mod p)$</p><p>即：</p><p>$(1+x)^n≡(1+x)^{a\times p}\times (1+x)^b(\mod p)$</p><p>由之前证明的定理得：</p><p>$(1+x)^{a\times p}≡(1+x^p)^a(\mod p)$</p><p>即：</p><p>$(1+x)^{a\times p+b}≡(1+x^p)^a\times (1+x)^ b(\mod p)$</p><p>由二项式定理得：</p><p>$(1+x)^{a\times p+b}≡\displaystyle \sum^{i\to a}_{i=0}(C_a^i\times x^{p\times i})\times \displaystyle \sum^{j\to b}_{j=0}(C_b^j\times x^j)(\mod p)$</p><p>考虑等号两边$x^m$的系数：</p><p>由二项式定理得左边$x^m$的系数为：$C_n^m$</p><p>将右边的式子展开，显然当i,j满足$p\times i+j==m$时为$x^m$的系数,也就是$i==c,j==d$时，也就是：</p><p>$C_a^c\times C_b^d$</p><p>则能得到等式$C_n^m≡C_a^b\times C_b^d(\mod p)$</p><p>于是定理得到了证明。</p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//计算n！%mod</span></span><br><span class="line"><span class="function">ll <span class="title">fact</span><span class="params">(ll n,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        res=(res*i)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y,ll &amp;d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)</span><br><span class="line">    &#123;</span><br><span class="line">        d=a;</span><br><span class="line">        x=<span class="number">1</span>;</span><br><span class="line">        y=<span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        exgcd(b,a%b,y,x,d);</span><br><span class="line">        y-=x*(a/b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//用exgcd计算t模mod的逆元</span></span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll t,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll d,x,y;</span><br><span class="line">    exgcd(t,mod,x,y,d);</span><br><span class="line">    <span class="keyword">return</span> d==<span class="number">1</span>?(x%mod+mod)%mod:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//计算C(n,m)%mod:C(n,m)%mod=(n!/[m!*(n-m)!])%mod=n!%mod*inv(m!,mod)%mod*inv((n-m)!,mod)%mod</span></span><br><span class="line"><span class="function">ll <span class="title">comb</span><span class="params">(ll n,ll m,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(m&lt;<span class="number">0</span>||m&gt;n)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> fact(n,mod)*inv(fact(m,mod),mod)%mod*inv(fact(n-m,mod),mod)%mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//lucas定理:C(n,m)%mod=C(n/mod,m/mod)*C(n%mod,m%mod)%mod</span></span><br><span class="line"><span class="function">ll <span class="title">lucas</span><span class="params">(ll n,ll m,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> m?lucas(n/mod,m/mod,mod)*comb(n%mod,m%mod,mod)%mod:<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="拓展Lucas定理"><a href="#拓展Lucas定理" class="headerlink" title="拓展Lucas定理"></a>拓展Lucas定理</h2><p>考虑如果p不是素数的情况，我们考虑利用唯一分解定理将p分解为若干素数的乘积，于是可以将式子分解为一组方程组，即：</p><p>$C_n^m≡r_1(\mod p_1)$</p><p>$C_n^m≡r_2(\mod p_2)$</p><p>$C_n^m≡r_3(\mod p_3)$</p><p>.</p><p>.</p><p>.</p><p>$C_n^m≡r_k(\mod p_k)$</p><p>于是这个方程组又让我们想到了中国剩余定理（CRT），于是我们就可以使用Lucas定理把$r_1…r_k$求出来，再用中国剩余定理求解$C_n^m$。</p><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 15</span></span><br><span class="line">ll t;</span><br><span class="line">ll n,m;</span><br><span class="line">ll k;</span><br><span class="line">ll a[MAXN];</span><br><span class="line">ll r[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="comment">//唯一分解定理将mod分解为素数</span></span><br><span class="line"><span class="function">ll <span class="title">fj</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> c=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(n%i==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            a[c++]=i;</span><br><span class="line">            n/=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//快速乘取模</span></span><br><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll a,ll b,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>)res=(res+a)%mod;</span><br><span class="line">        a=(a+a)%mod;</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//计算n！%mod</span></span><br><span class="line"><span class="function">ll <span class="title">fact</span><span class="params">(ll n,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        res=(res*i)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y,ll &amp;d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)</span><br><span class="line">    &#123;</span><br><span class="line">        d=a;</span><br><span class="line">        x=<span class="number">1</span>;</span><br><span class="line">        y=<span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        exgcd(b,a%b,y,x,d);</span><br><span class="line">        y-=x*(a/b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//用exgcd计算t模mod的逆元</span></span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll t,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll d,x,y;</span><br><span class="line">    exgcd(t,mod,x,y,d);</span><br><span class="line">    <span class="keyword">return</span> d==<span class="number">1</span>?(x%mod+mod)%mod:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//计算C(n,m)%mod:C(n,m)%mod=(n!/[m!*(n-m)!])%mod=n!%mod*inv(m!,mod)%mod*inv((n-m)!,mod)%mod</span></span><br><span class="line"><span class="function">ll <span class="title">comb</span><span class="params">(ll n,ll m,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(m&lt;<span class="number">0</span>||m&gt;n)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> fact(n,mod)*inv(fact(m,mod),mod)%mod*inv(fact(n-m,mod),mod)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//lucas定理:C(n,m)%mod=C(n/mod,m/mod)*C(n%mod,m%mod)%mod</span></span><br><span class="line"><span class="function">ll <span class="title">lucas</span><span class="params">(ll n,ll m,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> m?lucas(n/mod,m/mod,mod)*comb(n%mod,m%mod,mod)%mod:<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//中国剩余定理求解C(n,m)%mod=C(n,m)%(a1*a2*a3...)(ai为素数)</span></span><br><span class="line"><span class="function">ll <span class="title">china</span><span class="params">(ll n,ll *d,ll *m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll M = <span class="number">1</span>, ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++) M *= m[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        ll w = M / m[i];</span><br><span class="line">        ret = (ret + mul(w * inv(w, m[i]), d[i], M)) % M;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (ret + M) % M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;t;</span><br><span class="line">    <span class="keyword">while</span>(t--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m&gt;&gt;k;</span><br><span class="line">        ll num=fj(k);<span class="comment">//分解模k</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;num; ++i) &#123;</span><br><span class="line">            r[i]=lucas(n,m,a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;china(num,r,a)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Lucas定理&quot;&gt;&lt;a href=&quot;#Lucas定理&quot; class=&quot;headerlink&quot; title=&quot;Lucas定理&quot;&gt;&lt;/a&gt;Lucas定理&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://baike.baidu.com/item/lucas/432626</summary>
      
    
    
    
    <category term="ACM" scheme="http://enderxiao.top/categories/ACM/"/>
    
    <category term="算法" scheme="http://enderxiao.top/categories/ACM/%E7%AE%97%E6%B3%95/"/>
    
    <category term="数论进阶" scheme="http://enderxiao.top/categories/ACM/%E6%95%B0%E8%AE%BA%E8%BF%9B%E9%98%B6/"/>
    
    
    <category term="数论" scheme="http://enderxiao.top/tags/%E6%95%B0%E8%AE%BA/"/>
    
    <category term="算法竞赛" scheme="http://enderxiao.top/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"/>
    
  </entry>
  
</feed>
