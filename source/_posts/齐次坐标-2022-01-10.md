---
title: 齐次坐标
date: 2022-01-10 15:38:31
categories:
tag:
---

图形学变换笔记

<!-- more -->

## 变换

### 齐次坐标（Homogeneous Coordinates）

齐次坐标的引入：平移坐标变换的特殊性

若需要将平移变换表示为矩阵形式，那么只能使用如下发给发进行
$$
\left(
\begin{matrix}
x' \\
y'
\end{matrix}
\right) = 
\left(
\begin{matrix}
a & b \\
c & d
\end{matrix}
\right)
\left(
\begin{matrix}
x \\
y
\end{matrix}
\right) + 
\left(
\begin{matrix}
t_x \\
t_y
\end{matrix}
\right)
$$
说明平移变换不再属于线性变换。

但我们希望用一个更鲁棒的方式来表示这些变换。

于是我们在原有的维度上增加一个维度，以二维为例：

- 表示一个二维的点：$point = (x,y,1)^T$
- 表示一个二维的向量：$vector = (x,y,0)^T$

为什么要用0和1去区分点和向量呢（怎么有点脆皮鸭内味）

原因是向量具有平移不变性，我们希望对向量进行平移操作时不会导致向量的改变。

更进一步，我们希望在齐次坐标系下，点和向量之间应依然存在如下关系：
$$
vector + vector = vector \\
point - point = point \\
point + vector = point \\
point + point = ??
$$
对于其次坐标系下的的点的加法的定义我们仍然需要进行扩充，考虑相加之后得到的数据：
$$
\left(
\begin{matrix}
x_1 \\
y_1 \\
w_1
\end{matrix}
\right) +
\left(
\begin{matrix}
x_2 \\
y_2 \\
w_2
\end{matrix}
\right) =
\left(
\begin{matrix}
(x_1+x_2)/(w_1+w_2) \\
(y_1 + y_2)/(w_1 + w_2) \\
1
\end{matrix}
\right)
$$
若两个数据均为其次坐标系下的点，那么$w_1 = w_2 = 1$，于是该加法就能用于表示两个点的中点。

最后在其次坐标下使用矩阵表示变换就能使用如下形式：
$$
\left(
\begin{matrix}
x' \\
y' \\
w'
\end{matrix}
\right) = 
\left(
\begin{matrix}
1 & 0 & t_x \\
0 & 1 & t_y \\
0 & 0 & 1
\end{matrix}
\right)
\left(
\begin{matrix}
x \\
y \\
1
\end{matrix}
\right) + 
\left(
\begin{matrix}
x + t_x \\
y + t_y \\
1
\end{matrix}
\right)
$$

#### 仿射变换（Affine Transformations）

既然有了齐次坐标系这么好的东西，那么我们就能思考如何将线性变换和平移变换进行表示，现在它们有了一个新的名字，我们称线性变换+平移变化 = 仿射变换。

需要注意的是，使用齐次坐标表示的变换矩阵是先进行线性变换再进行平移变换。
$$
\left(
\begin{matrix}
x' \\
y'
\end{matrix}
\right) = 
\left(
\begin{matrix}
a & b \\
c & d
\end{matrix}
\right)
\left(
\begin{matrix}
x \\
y
\end{matrix}
\right) + 
\left(
\begin{matrix}
t_x \\
t_y
\end{matrix}
\right) \\
\left(
\begin{matrix}
x' \\
y' \\
1
\end{matrix}
\right) = 
\left(
\begin{matrix}
a & b & t_x \\
c & d & t_y \\
0 & 0 & 1
\end{matrix}
\right)
\left(
\begin{matrix}
x \\
y \\
1
\end{matrix}
\right)
$$

### 变换的组合（Composite Transform）

对于默认为列向量，变换通常通过左乘变换矩阵实现，然后以从右到左的计算顺序计算变换的结果，由于矩阵的乘法没有交换率，因此变换的先后顺序变得极为重要。

但由于矩阵满足结合率，因此可以先将变换矩阵相乘后在应用到目标向量上。
$$
A_n(...A_2(A_1(x))) = (A_n ... A_2...A_1)
\left(
\begin{matrix}
x \\
y \\
1
\end{matrix}
\right)
$$

#### 逆变换（Inverse Transform）

逆变换即与某个变换效果相反的变换，在数学上，如果一个变换是通过左乘一个变换矩阵$M$完成的，那么它的逆变换就是变换后的向量左乘一个$M^{-1}$

#### 变换的分解（Decomposing Complex Transforms)

考虑这样一个问题：

1. 现在存在一个左下角c不在原点的矩形
2. 我们希望以矩形的左下角为基准将其旋转一个角度a

我们可以通过如下几个步骤完成这个操作：

1. 将c点平移到原点
2. 绕原点旋转角度a
3. 将c点移动回原位

![image-20220110162336178](E:\EnderBlogSource\EnderXiao.github.io\source\images\image-20220110162336178.png)

### 三维空间的变换

三维空间中我们同样希望使用齐次坐标系表示三维坐标中的点和向量，于是得到一个与二维空间类似的结果：

- 表示一个二维的点：$point = (x,y,z,1)^T$
- 表示一个二维的向量：$vector = (x,y,z,0)^T$

当w不为1且不为0时，齐次坐标系下的点$(x,y,z,w)$所表示的三维空间中的点为：$(x/w,y/w,z/w)$

同样三维空间中的仿射变换可以表示为如下形式：
$$
\left(
\begin{matrix}
x' \\
y' \\
z' \\
1
\end{matrix}
\right) = 
\left(
\begin{matrix}
a & b & c & t_x \\
d & e & f & t_y \\
g & h & i & t_z \\
0 & 0 & 0 & 1
\end{matrix}
\right)
\left(
\begin{matrix}
x \\
y \\
z \\
1
\end{matrix}
\right)
$$

> 二位变换补充：
>
> 在不考虑齐次坐标的情况下，旋转变换使用的矩阵是一个正交矩阵（Orthogonal Matrix），实际上他还是一个单位正交阵

#### 三维空间中的线性变换与平移变换

##### 缩放

$$
S(s_x, s_y, s_z) =
\left(
\begin{matrix}
s_x & 0 & 0 & 0 \\
0 & s_y & 0 & 0 \\
0 & 0 & s_z & 0 \\
0 & 0 & 0 & 1
\end{matrix}
\right)
$$

##### 平移

$$
T(t_x, t_y, t_z) =
\left(
\begin{matrix}
1 & 0 & 0 & t_x \\
0 & 1 & 0 & t_y \\
0 & 0 & 1 & t_z \\
0 & 0 & 0 & 1
\end{matrix}
\right)
$$

##### 旋转

###### x轴

$$
R_x(\alpha) =
\left(
\begin{matrix}
1 & 0 & 0 & 0 \\
0 & cos\alpha & -sin\alpha & 0 \\
0 & sin\alpha & cos\alpha & 0 \\
0 & 0 & 0 & 1
\end{matrix}
\right)
$$

###### y轴

$$
R_y(\alpha) =
\left(
\begin{matrix}
cos\alpha & 0 & sin\alpha & 0 \\
0 & 1 & 0 & 0 \\
-sin\alpha & 0 & cos\alpha & 0 \\
0 & 0 & 0 & 1
\end{matrix}
\right)
$$

###### z轴

$$
R_z(\alpha) =
\left(
\begin{matrix}
cos\alpha & -sin\alpha & 0 & 0 \\
sin\alpha & cos\alpha & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{matrix}
\right)
$$

对于如上公式，我们观察到，在对y轴进行旋转的矩阵中，如果将非0，1的数值提取出来组成2维变换矩阵，得到的变换矩阵与其余两个轴形成的变换矩阵刚好互为逆，这是为什么呢？
